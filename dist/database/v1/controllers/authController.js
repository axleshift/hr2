const z=f;(function(g,h){const K={g:'1Qe*',h:0x21e,i:0x201,j:0x1f0,k:'OB%L',l:0x1a8,m:'a9H0'},s=f,i=g();while(!![]){try{const j=parseInt(s(0x21d,'1Qe*'))/0x1*(parseInt(s(0x242,K.g))/0x2)+parseInt(s(K.h,'2VWz'))/0x3+-parseInt(s(K.i,']wWy'))/0x4*(-parseInt(s(0x22a,'^LHb'))/0x5)+parseInt(s(K.j,'I7sz'))/0x6+-parseInt(s(0x1ee,K.k))/0x7+-parseInt(s(K.l,'@gZ!'))/0x8+parseInt(s(0x20b,K.m))/0x9;if(j===h)break;else i['push'](i['shift']());}catch(k){i['push'](i['shift']());}}}(e,0x7418d));const d=(function(){let g=!![];return function(h,i){const j=g?function(){const t=f;if(i){const k=i[t(0x1c6,'^LHb')](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}());(function(){const T={g:'cO]g',h:0x1c0},S={g:'a9H0',h:'OB%L',i:0x1d7,j:'cO]g',k:0x1f8,l:'1Qe*',m:0x1ce,n:'41Zp',o:0x1b6,p:'85uX'},u=f,g={'MgOrG':'function\x20*\x5c(\x20*\x5c)','hEpvR':u(0x1be,T.g),'TSefA':function(h,i){return h(i);},'KsSfD':function(h,i){return h+i;},'KiTwx':function(h,i,j){return h(i,j);}};g[u(T.h,'iHQa')](d,this,function(){const v=u,h=new RegExp(g[v(0x20e,S.g)]),i=new RegExp(g[v(0x1cb,S.h)],'i'),j=g[v(S.i,S.j)](c,v(0x1e5,'41Zp'));!h[v(S.k,S.l)](g[v(0x231,'ohMy')](j,v(S.m,'0c83')))||!i['test'](j+v(0x1e9,S.n))?g[v(S.o,S.p)](j,'0'):c();})();}());const b=(function(){const U={g:'0Z4e'};let g=!![];return function(h,i){const j=g?function(){const w=f;if(i){const k=i[w(0x1df,U.g)](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}()),a=b(this,function(){const a3={g:'0c83',h:'rW]U',i:'V2V(',j:'R]0#',k:'iWGf',l:0x211,m:0x23d,n:'@gZ!',o:0x1ca,p:'XCol',q:0x202,r:'kGQI',a4:0x226,a5:0x228,a6:0x1d3,a7:'iWGf'},a2={g:'bO#A',h:0x236},x=f,g={'bdRcx':function(l,m){return l(m);},'kaYGC':function(l,m){return l+m;},'QzbxS':x(0x1da,a3.g),'hBSCB':x(0x216,a3.h),'xPJHN':function(l){return l();},'bRtWw':'log','GWlWV':x(0x1fe,a3.i),'WnZiy':x(0x1f4,'Wwli'),'bvPMB':x(0x1f7,a3.j),'nbhHx':function(l,m){return l<m;}},h=function(){const y=x;let l;try{l=g[y(0x1ed,a2.g)](Function,g[y(a2.h,'k6%o')](g[y(0x238,'41Zp')]+g[y(0x1af,'k8Z9')],');'))();}catch(m){l=window;}return l;},i=g[x(0x221,'iHQa')](h),j=i[x(0x240,a3.k)]=i[x(a3.l,']N%e')]||{},k=[g[x(0x1d5,'*ire')],g[x(a3.m,a3.n)],'info',g[x(a3.o,a3.p)],g[x(a3.q,'2VWz')],'table',x(0x1c1,a3.r)];for(let l=0x0;g[x(a3.a4,'0Z4e')](l,k['length']);l++){const m=b['constructor']['prototype'][x(a3.a5,'XCol')](b),n=k[l],o=j[n]||m;m[x(a3.a6,a3.a7)]=b[x(0x21a,'79C$')](b),m['toString']=o['toString'][x(0x1d9,'s2ri')](o),j[n]=m;}});a();'use strict';var __importDefault=this&&this[z(0x243,'Wwli')]||function(g){return g&&g['__esModule']?g:{'default':g};};Object[z(0x205,'@gZ!')](exports,z(0x229,'iHQa'),{'value':!![]}),exports[z(0x23c,'iWGf')]=exports[z(0x1cf,'OB%L')]=exports[z(0x1d8,'Sg#e')]=exports['createUser']=void 0x0;const hasher_1=require('../../../utils/hasher'),userModel_1=__importDefault(require('../models/userModel')),bcryptjs_1=__importDefault(require(z(0x1f6,']N%e'))),jsonwebtoken_1=__importDefault(require(z(0x23a,'cO]g'))),config_1=require('../../../config'),dotenv_1=__importDefault(require(z(0x1b2,'iHQa'))),logger_1=__importDefault(require(z(0x1c7,'4u87')));function e(){const au=['WOxdHbHOw8oyW5/dGY7cPsrtW5G','hZuzdCo7W78','FSk8wG','W7NcMMaIkW','W4BcUeS','mfy7W7LOWOldH8kfzGf+','WP1LW6/dRCoGgSoV','hvOrW4X9','W6aZy8ouW5NdOmkFWO/dU8kfWQDRW5PZExVdL3D1WRuzWPS9rSkWW6O','WR7dOKtdMGZdLG','d8kLffVcMCoO','W5pcIKRcRx4qWRRdSxZcH8kcBSotnCkRmrr9W7C9W7byfWJdGulcNwjMr8kupa','WPGgWRiLsa','WONcNs3dLJW','W61OFCoZ','W5yhp0q','WO9Lbmk1jSkjW4S','xfiqW7tcHW','W4iZW6CVtWRcGZ5CWO7cKYu','W75Cdr0AWRrCwCoCc8kezG','CHJcQeK','yCkNxglcPb8','WOJcPCkdmCkD','WPyDWQhdMeC','WQ7dUuVdNq3dL0RdKCodbde','gZSn','WQLIWO7cVq','AmoXW6xcL8o7','W5pcMKOI','WQ0CW7jf','WQ/cQSkScSkECrWPWQTm','vr5XWPm0jmoXW4W','W4tcNfWJg8keWPZdJG','lWuGhmoz','W54ZWPFdQ8ojWQu','i1BcQmo+rW','Dmk6u3lcNGlcVa','kvXSWPeQtSoSW77dRSoyaSkCW5FcLN/dRdfzbb8','C8oOWQldOdK','W4C0WPNdSq','WPfJWOJcICkG','r0CKhmkQgG','kM3cGmo/wG','W5tcKCoHghC','W5xcICkuW5ZcUG','W7tcQIpdIdm','WOpdJHXGvmkNWPJdMthcMqy','WPzZgmkOomkdW4FdOCkTDmoSW78','WQLZeSk0B8kfW5FdSmkJA8oSW7uVW5vUWOfzWRbpWOXgk8o8BSoW','WOtcGJRdLtddVW','xCoPjr5v','WRhdJmoOWP8','cSkNFI/dJq','WOVcGJpdIsRdP8oA','zMvGWP89kSk/WPmDW6m5WQO','W4iZWRbBpN3cVcm','nmkizY7dHf89WP8HW4pdQqHQW5aO','WP0UASoIWQW','W58CW70nW5jRWQ9TzSkgsG','W6FcVmo8pwq','W4LgW77dPCkPWRuxWPCUW6e+xIaqsXpdNmomWQi','EbBcV1JdVcG','W5KVyCojWOZdOG','tLSLfa','DSk2w3FcPadcRq','WQGfuvTdW7j8q8ooemkS','W4xdNhH3g8kKW6ZdNCkXWQZcVIKVWPK','kmkmFh01WRiNWRf6Cmo5W6JcSa','WRnsWOZcP8oO','WQNdS0pdJWZdIuS','WPOgW7LtWRLvWPTWW6a5WQzWifi','ASo8W6RcTSoT','W4/cRLnE','W5aDFWO','W69zqCoEWRm','W4WIzmoJWRa','WOvAzHBdLCohhSkdW4LJWPjwWP8','WPtcMSk9hmk9Aa','WRPdyCoewq','W6JcUCk4W7q','psJcKSowosVdPNFcGtnZW7O2WQVcLHLRCqZcK8kjWQZcTCk8uSoTW69tqSoa','W6ety8oaWRG','W5BcTtxdUq7cHuVdJWnlga','AuucW4ZcQmkj','W7xcSSowgfe','WOZcId/dJW','x3n8WOi','WR4DWPKsCG','kCkLa1xcN8kTW7nzW6RdVqZdJSo1xGveySoBySkfsCoFW4b4','WQaRk8oTB8omWO3cQSo4rmoOWRX1W6C2WRHLW7fHWQqqC8kPy8kKpSoBzMn3mmkUW43dMq','DmozlHX1','WRVcNmkDdSkR','W4OED8oXWRm','WOnCW6lcQW','W7tdINTKtSkMW7C','W4ZcHmoknLRdGW','WQCUWRSVDb4','dv5UWPiH','W6zuaCkAW5u6W5j7W6G5tqbaWRncxcpcPmkwcmkaWRNdV8kCW6DHWOW','W4ZcKGlcR2qsWR0','WQGfuLHwW7jSC8odeCk9','WPGBW4ziW6a','W4qTW6WpW6u','WPtcTenX','frGKomklo8knW7K','WQWNWQKUFW','W5OnW64qW5fD','W4FcIu4KgCky','W5RcNCoznLG','W5VcLCoEpKhdImos','WRFcSI3dIcRdV8oqbXG','bXux','db/cLCoYjW','WONdOK/dPc8','WQHteSkGdG','WQ9+WOBcUSoQ','W68TW4hcHq','WR0QWRWYyWlcVCkPW6RcHSoBmSkbWQ51lfGSzG','WOlcQeHLW7ZdKq','W7NcINGzbG','WPrMWRbkf1FcHX1ZWRRcHa','W70mW6NcQmoM','z8oJW73cS8o6','W4/cOY7dNG','WOzJWPpcVmo2WRZdI8kYmWFcPeVdUSkXhN0ZC23dSq','WPpcOLj2W6FdMeTkWRNdOZWUWPHSFqJcLxDi','WO1EpK3cJSk6rmkc','wCkyCa0cW4ddI8klW5pcTCkHjSkq','W4ZcVIJdHa','g8ovjKfaWOa','WOO9WROOy0ZdVSoZW6NcKSobomkBWQa6nWnGna','CeimW5y','W4ZcVJhdHrq','hw3cI8obEv8','WRzIWOtcOq','kCkNtdBdJq','rKWygCk7','WPLCWQ1aWOqvW7TaESkHvCkqWPS','W4hcTsFdKrxcNvO','W7ldRgOrz0NdK8ohhrRcSNdcNa','W74HW5ZcKSokz8kN','W7hcVSk2W67cHSkl','jL9gWPGY','dSkLFcZdHG','W4xdG8o4t8oRkJ0vWQXCW6VdUW','WPXPW7pdP8o/aSoGWRG','Dq/cR1xdQs7cRGddUG','WODMWQ1T','WRS+AwPA','W58nW64pW5jw','W7r+yCoUWPGGW4q','W5BcPcddHbxcGG','rNrYWPGHnG','g8k2a1q','W7RdNhjR','WPWqW69sW7buWPOKWQq+WR1KBLCpWPVcTCo/W6SKW50dW5XlFCoF','aJmGW5XScCkNW4axW6OS','WQKCBgzG','W5dcMeKXgCkhWPO','FSkJDxpcHq','FSoBlYbTW69pWOX6CCovW57cQ8oP','W4ahW7S','W4FcVYxdIq','W6qQW4NcJG','u3OvW7BcUW','WQJdMSoKWOm/Eq'];e=function(){return au;};return e();}dotenv_1[z(0x1aa,'yw2m')][z(0x234,'bO#A')]();function f(a,b){const c=e();return f=function(d,g){d=d-0x1a6;let h=c[d];if(f['gEndmC']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['QQrlVh']=m,a=arguments,f['gEndmC']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['MCuchI']===undefined&&(f['MCuchI']=!![]),h=f['QQrlVh'](h,g),a[k]=h):h=l,h;},f(a,b);}const salt=bcryptjs_1[z(0x1d2,'k6%o')][z(0x1dd,'1Qe*')](0xa),createUser=async(g,h)=>{const a6={g:0x23b,h:'41Zp',i:0x237,j:'n4Id',k:0x1b8,l:0x1b4,m:0x215,n:'V2V(',o:0x20c,p:0x1c5,q:0x1fd,r:0x225,a7:'Sg#e'},A=z,i={'WCCFI':function(q,r){return q||r;},'jyFaM':'Please\x20provide\x20all\x20required\x20fields','Lavyl':A(a6.g,'cO]g')},{firstname:j,lastname:k,email:l,username:m,password:n,status:o,role:p}=g[A(0x207,a6.h)];if(i[A(a6.i,a6.j)](!j,!k)||!l||!m||!n||!o||!p)return h[A(a6.k,'uDvC')](0x190)[A(a6.l,'n4Id')]({'statusCode':0x190,'success':![],'message':i['jyFaM']});try{const q=await userModel_1[A(0x1c3,'qUpH')][A(a6.m,a6.n)]({'firstname':await(0x0,hasher_1[A(a6.o,'KA5R')])(j,salt),'lastname':await(0x0,hasher_1[A(0x248,'R]0#')])(k,salt),'email':l,'username':m,'password':await(0x0,hasher_1[A(a6.p,'0c83')])(n,salt),'rememberToken':salt,'status':o,'role':p});h[A(0x22d,'7V(M')](0xc9)[A(0x232,'7V(M')]({'statusCode':0xc9,'success':!![],'message':i['Lavyl'],'user':q});}catch(r){console['log'](r),h[A(a6.q,']wWy')](0x1f4)[A(a6.r,a6.a7)]({'statusCode':0x1f4,'success':![],'message':A(0x1e7,'0c83'),'error':r});}};exports['createUser']=createUser;const login=async(g,h)=>{const a8={g:0x230,h:'^LHb',i:0x200,j:'XCol',k:'XCol',l:0x1e1,m:'Sg#e',n:0x21f,o:'R]0#',p:0x24b,q:0x208,r:0x247,a9:'8$eK',aa:'cT0A',ab:'NSHx',ac:0x22b,ad:'41Zp',ae:'2VWz',af:0x1d0,ag:'a9H0',ah:0x20f,ai:0x203,aj:'k6%o',ak:'w)HN',al:0x224,am:'qUpH',an:0x1bc,ao:'0c83'},a7={g:0x1a9,h:'Sg#e',i:0x1fc,j:0x1e0,k:'41Zp',l:'k6%o',m:0x206,n:0x1dc,o:0x1fb,p:'^3%8',q:0x219,r:'k8Z9',a8:0x21c,a9:'uDvC'},B=z,i={'pCmtl':'Session\x20save\x20error:','JBnGe':B(a8.g,a8.h),'MwWIj':B(a8.i,a8.j),'FcsLZ':'User\x20verified\x20successfully','ybbEI':B(0x1ab,a8.k),'qRQUc':B(a8.l,a8.m)},{username:j,password:k}=g[B(a8.n,a8.o)];logger_1[B(a8.p,'cT0A')][B(a8.q,'s2ri')]('User\x20'+j+B(a8.r,a8.a9));try{const l=await userModel_1[B(0x1c8,'rW]U')][B(0x22f,a8.aa)]({'username':j});if(!l)return h[B(0x1b8,'uDvC')](0x194)[B(0x23e,a8.ab)]({'statusCode':0x194,'success':![],'error':i[B(0x1b0,'85uX')]});const m=l[B(a8.ac,'a9H0')],n=bcryptjs_1[B(0x1ef,a8.ad)][B(0x1a6,a8.ae)](k,m);if(!n)return h[B(a8.af,a8.ag)](0x191)[B(0x1bb,']wWy')]({'statusCode':0x191,'success':![],'message':'Invalid\x20credentials'});const o=config_1[B(0x1db,'w)HN')][B(0x1fa,'OB%L')][B(a8.ah,'5s2I')][B(0x20a,'NSHx')],p=jsonwebtoken_1[B(a8.ai,a8.ag)]['sign']({'username':j,'password':k},o,{'expiresIn':'1h'}),q={'username':l['username'],'role':l['role'],'email':l[B(0x1d1,a8.aj)],'status':l[B(0x1fd,']wWy')],'token':p};g['session'][B(0x1cc,a8.ak)]=q,g['session']['save'](r=>{const C=B;if(r)return console['log'](i[C(a7.g,a7.h)],r),h[C(a7.i,'41Zp')](0x1f4)[C(a7.j,a7.k)]({'statusCode':0x1f4,'success':![],'message':i[C(0x1b9,a7.l)]});console[C(a7.m,'OB%L')](i[C(a7.n,'a9H0')],g[C(a7.o,'k8Z9')][C(0x1ae,a7.p)]),h[C(0x1e6,'cf]#')](0xc8)[C(a7.q,a7.r)]({'statusCode':0xc8,'success':!![],'message':i[C(a7.a8,a7.a9)],'data':q});});}catch(r){console[B(a8.al,'KA5R')](r),h['status'](0x1f4)[B(0x1ff,a8.am)]({'statusCode':0x1f4,'success':![],'message':i[B(a8.an,a8.ao)],'error':r});}};exports[z(0x1ac,'0Z4e')]=login;const verify=async(g,h)=>{const a9={g:0x241,h:0x213,i:0x1d4,j:'ezyQ',k:'s2ri',l:0x21b,m:'bO#A',n:'cT0A',o:0x214,p:'yw2m',q:'8$eK'},D=z,i={'oTlYb':D(a9.g,']wWy'),'XQJyG':D(a9.h,'85uX'),'JHOfZ':D(0x1a7,'qUpH'),'IKvNf':'Error\x20verifying\x20user'};try{console[D(a9.i,'oEeQ')](i[D(0x222,a9.j)],g[D(0x1f1,a9.k)]['user']);const j=g[D(a9.l,'cO]g')][D(0x1eb,'Sg#e')];j?h['status'](0xc8)[D(0x24a,a9.m)]({'statusCode':0xc8,'success':!![],'message':i[D(0x22c,'KA5R')],'data':j}):h[D(0x1f2,'n4Id')](0x194)['json']({'statusCode':0x194,'success':![],'message':i['JHOfZ']});}catch(k){console[D(0x20d,a9.n)](k),h[D(a9.o,a9.p)](0x1f4)[D(0x1c2,a9.q)]({'statusCode':0x1f4,'success':![],'message':i[D(0x209,'uDvC')],'error':k});}};(function(){const ae={g:0x212,h:'tqtp',i:0x1b7},ad={g:'2VWz'},F=z,g={'BpBuy':function(j,k){return j(k);},'pTUAx':function(j,k){return j+k;},'xNxAB':'{}.constructor(\x22return\x20this\x22)(\x20)','NcDFa':function(j){return j();}},h=function(){const E=f;let j;try{j=g[E(0x1ec,'Wwli')](Function,g['pTUAx'](g[E(0x1f9,ad.g)](E(0x1e2,'w)HN'),g['xNxAB']),');'))();}catch(k){j=window;}return j;},i=g[F(ae.g,ae.h)](h);i[F(ae.i,'41Zp')](c,0x9c4);}()),exports['verify']=verify;const logout=async(g,h)=>{const ag={g:0x1bd,h:'V2V(',i:0x1b5,j:'*ire'},af={g:0x1e8,h:0x217,i:'pjC9'},G=z,i={'WIzbY':G(ag.g,ag.h),'Woxgy':G(ag.i,ag.j)};g['session']['destroy'](j=>{const H=G;if(j)return h[H(0x220,'cT0A')](0x1f4)[H(af.g,'uDvC')]({'statusCode':0x1f4,'success':![],'message':i[H(af.h,'0c83')],'error':j});h[H(0x1ea,af.i)](0xc8)['json']({'statusCode':0xc8,'success':!![],'message':i['Woxgy']});});};exports[z(0x249,'85uX')]=logout;function c(g){const at={g:'iWGf',h:0x227,i:'a9H0'},as={g:0x1c4,h:0x210,i:'tqtp',j:0x218,k:'@gZ!',l:0x233,m:'J6XZ',n:0x1de,o:'^LHb',p:'2VWz',q:0x1b3,r:0x246,at:'k6%o',au:0x204,av:0x23f,aw:'Wwli',ax:0x245,ay:'OB%L'},I=z,h={'rUGme':function(j,k){return j===k;},'nggUv':'counter','MbZAc':function(j,k){return j!==k;},'wCZkp':function(j,k){return j/k;},'JSODM':'length','pHFIE':function(j,k){return j===k;},'JqXfj':function(j,k){return j%k;},'MOBKK':function(j,k){return j+k;},'lpHeT':I(0x1ba,at.g),'XLDbP':'action','lpyYI':function(j,k){return j+k;},'UTDVW':I(at.h,at.i),'DtjJV':function(j,k){return j(k);}};function i(j){const J=I;if(h['rUGme'](typeof j,J(as.g,'k6%o')))return function(k){}[J(as.h,as.i)]('while\x20(true)\x20{}')[J(as.j,'iWGf')](h[J(0x1bf,as.k)]);else h['MbZAc']((''+h['wCZkp'](j,j))[h[J(as.l,as.m)]],0x1)||h[J(as.n,'s2ri')](h[J(0x1f3,as.o)](j,0x14),0x0)?function(){return!![];}[J(0x1c9,as.p)](h[J(0x22e,'pjC9')](h[J(as.q,'M26q')],'gger'))[J(0x1ad,'5s2I')](h[J(as.r,as.at)]):function(){return![];}[J(0x223,'yw2m')](h['lpyYI'](h[J(as.au,'cT0A')],h[J(0x244,'4u87')]))[J(as.av,as.aw)](J(as.ax,as.ay));h[J(0x235,'pjC9')](i,++j);}try{if(g)return i;else h[I(0x1d6,'yw2m')](i,0x0);}catch(j){}}