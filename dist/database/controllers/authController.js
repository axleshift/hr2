const y=f;(function(g,h){const H={g:0x1a3,h:')BpD',i:0x1db,j:0x1d0,k:0x170,l:'m1Ic',m:0x179,n:'ZW5U',o:0x189},s=f,i=g();while(!![]){try{const j=-parseInt(s(H.g,H.h))/0x1*(-parseInt(s(H.i,'Z!b#'))/0x2)+parseInt(s(H.j,'T5DH'))/0x3*(parseInt(s(0x155,'m1Ic'))/0x4)+-parseInt(s(H.k,H.l))/0x5*(-parseInt(s(H.m,'1WiM'))/0x6)+parseInt(s(0x16f,H.n))/0x7+-parseInt(s(H.o,'QWby'))/0x8+-parseInt(s(0x1ab,'n9Ge'))/0x9*(parseInt(s(0x168,'WgT$'))/0xa)+-parseInt(s(0x1bc,'TP4('))/0xb;if(j===h)break;else i['push'](i['shift']());}catch(k){i['push'](i['shift']());}}}(e,0x28fc1));const d=(function(){let g=!![];return function(h,i){const j=g?function(){const t=f;if(i){const k=i[t(0x18b,'!qpR')](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}());(function(){const Q={g:']Ijh'},P={g:0x151,h:'FJQP',i:0x1a9,j:0x158,k:'WgT$',l:0x177,m:'pLzG',n:'m1Ic',o:'sV]2',p:0x166,q:'T5DH'},u=f,g={'LiWHT':u(0x1d6,Q.g),'LliKW':function(h,i){return h(i);},'KMhyA':u(0x1c9,'9wWP'),'YZKob':function(h,i){return h+i;},'VzcAq':u(0x152,'!qpR'),'dIQkf':function(h){return h();}};d(this,function(){const v=u,h=new RegExp('function\x20*\x5c(\x20*\x5c)'),i=new RegExp(g['LiWHT'],'i'),j=g[v(P.g,P.h)](c,g[v(P.i,'YuSP')]);!h[v(P.j,'3r[!')](g[v(0x1b2,P.k)](j,g[v(P.l,P.m)]))||!i['test'](j+v(0x14d,P.n))?g[v(0x19f,P.o)](j,'0'):g[v(P.p,P.q)](c);})();}());function f(a,b){const c=e();return f=function(d,g){d=d-0x14a;let h=c[d];if(f['MxpzLZ']===undefined){var i=function(n){const o='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let p='',q='';for(let r=0x0,s,t,u=0x0;t=n['charAt'](u++);~t&&(s=r%0x4?s*0x40+t:t,r++%0x4)?p+=String['fromCharCode'](0xff&s>>(-0x2*r&0x6)):0x0){t=o['indexOf'](t);}for(let v=0x0,w=p['length'];v<w;v++){q+='%'+('00'+p['charCodeAt'](v)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(q);};const m=function(n,o){let p=[],q=0x0,r,t='';n=i(n);let u;for(u=0x0;u<0x100;u++){p[u]=u;}for(u=0x0;u<0x100;u++){q=(q+p[u]+o['charCodeAt'](u%o['length']))%0x100,r=p[u],p[u]=p[q],p[q]=r;}u=0x0,q=0x0;for(let v=0x0;v<n['length'];v++){u=(u+0x1)%0x100,q=(q+p[u])%0x100,r=p[u],p[u]=p[q],p[q]=r,t+=String['fromCharCode'](n['charCodeAt'](v)^p[(p[u]+p[q])%0x100]);}return t;};f['SrFlZB']=m,a=arguments,f['MxpzLZ']=!![];}const j=c[0x0],k=d+j,l=a[k];return!l?(f['BUEqsx']===undefined&&(f['BUEqsx']=!![]),h=f['SrFlZB'](h,g),a[k]=h):h=l,h;},f(a,b);}const b=(function(){let g=!![];return function(h,i){const j=g?function(){if(i){const k=i['apply'](h,arguments);return i=null,k;}}:function(){};return g=![],j;};}()),a=b(this,function(){const a0={g:'&$)n',h:0x181,i:'ZW5U',j:0x19a,k:0x173,l:'o[2o',m:0x187,n:'d[jw',o:'Z!b#',p:0x17c,q:'m1Ic',r:0x1ca,a1:0x159,a2:'WgT$',a3:0x16d,a4:0x1a7,a5:'3x2h',a6:')BpD',a7:0x1d1,a8:0x175,a9:'Xq7s',aa:0x153,ab:'CbCP',ac:'xOtP'},Z={g:'3r[!',h:0x1a1,i:0x1af,j:'pc6t',k:'xOtP'},w=f,g={'ZNjJP':function(l,m){return l(m);},'sSmoL':function(l,m){return l+m;},'somzG':w(0x18c,a0.g),'NkTfC':function(l){return l();},'JGnVV':w(a0.h,'wbx5'),'xwToB':w(0x182,'pc6t'),'amZOH':w(0x1b9,'YuSP'),'qEuJO':w(0x1a0,'pc6t'),'GZJvi':w(0x1c3,'ZW5U'),'GUGYK':w(0x1d9,a0.i),'DDJYE':function(l,m){return l<m;}},h=function(){const x=w;let l;try{l=g[x(0x1b1,Z.g)](Function,g[x(Z.h,'WWd0')](g[x(Z.i,Z.j)]+x(0x1a8,Z.k),');'))();}catch(m){l=window;}return l;},i=g[w(a0.j,'!qpR')](h),j=i[w(a0.k,'CbCP')]=i[w(0x192,a0.l)]||{},k=[g['JGnVV'],g[w(0x16c,'YuSP')],g['amZOH'],g[w(a0.m,a0.n)],w(0x14e,a0.o),g[w(a0.p,a0.q)],g[w(a0.r,'YuSP')]];for(let l=0x0;g[w(a0.a1,a0.a2)](l,k[w(a0.a3,'FJQP')]);l++){const m=b[w(a0.a4,a0.a5)][w(0x198,a0.a6)][w(a0.a7,'v9jl')](b),n=k[l],o=j[n]||m;m[w(a0.a8,'zOXx')]=b['bind'](b),m[w(0x17d,a0.a9)]=o[w(a0.aa,a0.ab)][w(0x1ba,a0.ac)](o),j[n]=m;}});a();function e(){const am=['eCoramkphrZcUby+W4m','aSoLArS','bSkNW4uHm8kfWQbjWPhdUW','W7/dNLaXW6NdV8o4','WPTSWPlcRa','WQ1uocKiea','W5JcV8oSWOXu','WRL2ef0QtSkLs1VcOq','WPjuWOtcLmoe','WRZcS8o1aq','aNnchcr1WPi','W7pcMmkRWQaF','W77dG1u1W6ZdP8oLFbi','WRZcS8oXfs/cRfS','WPz6WPpcKCoXCColWRxdN1Wl','WOlcI8kKW4tdPG','W4/cPmoHWP1U','m3NdJLWlwZddVW','aw1v','WQ7cK8k6WQuBpfq','WOnHWQKTWOdcRCoKWQ4lW7C','W7v/W6FcQq0','W4xdHwyo','WRvBWRFcM8ov','WPv6WPVcO8oLCCol','W4P+xfjQFCo9cSk6WPe','WRSUxCkjWQaSW6BdQCkLW73cRuldTYi','lwxdSKy','WP3cP8oYW4tdS8kjkcqXWQ7dHWvWW4v/nvRdG1u','WOtdPrb1ouq','kmoGW6nRbSkr','W6ddOmkGtg7dUuDeBCoOs8oR','WPv6WO7cTSoICSogWRpdLvCA','C8kmrCompYNcGfuWW4OUWQNdTmkxECoWWOX1i8koW5FdJSk3WQmqW6byWP7cOKG','W6/dH8koWOpcOW','W5uBfmkrWP4','mCkAjmocW6i','WQVcOSo2ac/cSW','W4aNW43dS8kGjmkpWOFdNfSDW70j','W4D2AxT+','W6tdK3aikW','kSoYW79T','fxvMW4hdUG','WQlcGSkJW6JdHxO','W77cK8kOWQezhMi','WQatdrariSo3n8krWPOmW70','WQJdHSoUW6ayogZdS8onW6W','y8oLq8kzWRtcQCk5WRyHBv9Q','W4BdH2q5BW','jhNdS1SwxJS','FSoTWQWF','xwFdIrSSlbGWCa','mHJdOCkO','WRHZmXhcJW','lgfHfIa','zmoZkt/cH8o8ACoOW6e1','W5RdVKxdVmkg','cSkmhmoeW7tdSmkZWOyMqvnft8osWRi','W53cRmkrWQmc','ymoXWPafW7L4fWW','W43dO8kaWPVcMq','W6pdHmkjWOu','W6zvwfvsyq','orddOW','WPfib0a','W7dcHCk0WRS','WO4XWOvPWR0zWOP4WPnchq','DI7cRrLjc27dUsJdP8oimSoc','zSoXWQ8u','mCoeW6vjla','fmkGkH0M','WQuaWQRdSNSKr8oVleRdTSkh','B8kQm8k+dCo0ma','W43cVmoWWPH5','WR/dS0CuWPtcRhZcSCo5W43cKXFdNai4W6q9W4ddPG','WR1ppY4seNS','W4RdNtSzzaVdReqjW6HaW5S2eWXpEYFdUYPArSkivSouh1FcPKBcS0pdLa','WOJdPeeoWPtdOJ/dQ8o6W5NcIr3dHGX3W79MWOZcTa','WRldPHbWpG','W75uW7ZcPZD0','W6bHW5pdOmkLWQuV','dgvleW','WOvJmsGyW6b+WQezWPdcRG','WQ91fmoG','ctirba','WRZdLmoRoSkEW51mW4G6umooqmkOCrWYWRriymks','W7RdMmkaWP7cOmkqEY7cKa','WPtdOXrGofi','W6lcP8ouWPjd','f3RdUeKkv37dQcddOColhCosW7uSW4GQW4tcQmo+W7FcQH3cJCksWOWsWRJdMYCCW7WDra','WP7cGSoIntm','CuZdMb02kW','bSkKoWuQyW','WRe4WPHRWOq','WOnBb0ev','WPtdHbH7aq','WQ5OdtWV','WRZcNCoBW5VcVSkVtqJcHmoY','E8kobCkedW','gtGygmkHlMvDAZ/dOCkHWQu','ECkywmoCeG','WOBcLCkiiCk1bCo/WOtcK8ooCq','WRDPvSoVWOmbW73cVSo6As0pWQNcKYO7sYaRrfu1W6iAkNVcMuf2W5FdLSkg','jK9AW5FdUq','WPldTt5+oq','WQBcR8o3WPRcVbTM','pCkQBgFcQCou','D8oXWQ4bW6PJhdGXWQXC','W5Ocqmo7W6fHvCoFW70TW6bT','WPvggfqG','WOrfpsq+','W6VdRN8WwW','WQHfWRBcRCoY','CIDYD2LolCke','W6bHW5pdTCkJWQ4','tmkIoaalrmoM','W6ifb8kMWO93','tmkguq','WO4GWPbuWQyE','bgXuW4e','WQ59fSoO','cfjQW5FdNW','W67dOmkHrgRdTLDkr8oNECo0','W4b6WR9SWOdcUSoiWRqaW6ialcrmWOSRwSovW5e','WOFcKCoRW4ldRa','WOKEWRn0WQa','i8kVW7TdWRmPlJirWQbzrG','WOXAgKa','W6j+W43dV8kZ','W6faw01c','W7uuamkZWO9OW5m','W5yKW7H9WOxcG8o+WOSFW70','WODkauCitW','fSk/naiRySoaWO3cKdldOa','W5pdKghdPSkBW6pcHsK','d3Hncq','kLD1W7FdSW','WPVdICo9la','W7b6W5ZdP8kVWOyOxmoqWOWk','W4aNF37dKbKLsGKVmeeqEXi+v2K','amkGemoBWQtdSCkUWOzcqLPrvmoA','W4BdOuRdRmkl','BCoLqSkrWRdcPSkPWRGlyM11','WOj6WQiO','WOjmbLOvtSk4A0tcOvG','WOnAgGdcJG','aSkeWPRcHaRcIWdcRG','W5NdGwysBHC','FmocASkuDMZdHKPUW7q8W7ddVmk5lCopWRDXdCkGWOtcGmoRWRfoW7XSW5/cLg41W4y8dW','uIDYDYDzjCktq2v9rb7dT8opWR7cImoEWRFdSCopW7pdG8otWRFcRG','W63dShpdGmk4','W6ftwejc','WP99phBcKq','WQNdN0CrW6tdQ8ob'];e=function(){return am;};return e();}'use strict';var __importDefault=this&&this[y(0x17b,'T5DH')]||function(g){const a1={g:0x15b,h:'ZW5U'},z=y;return g&&g[z(a1.g,a1.h)]?g:{'default':g};};Object[y(0x15c,'xvNt')](exports,y(0x1e3,'pc6t'),{'value':!![]}),exports[y(0x1d2,'pc6t')]=exports['verifyUser']=exports[y(0x1de,'Ws8i')]=void 0x0;const hasher_1=require(y(0x1cd,'pLzG'));(function(){const a5={g:'HaT&',h:0x1a2,i:0x1a6,j:0x1d3,k:'3r[!',l:0x1bf,m:'sV]2'},A=y,g={'HdRgC':function(i,j){return i(j);},'YqncD':function(i,j){return i+j;},'mSJPp':A(0x15e,a5.g),'tJBTs':function(i){return i();}};let h;try{const i=g[A(a5.h,'(A1H')](Function,g[A(a5.i,']Ijh')](g['YqncD'](g[A(a5.j,'pLzG')],A(0x18e,a5.k)),');'));h=g[A(a5.l,'sV]2')](i);}catch(j){h=window;}h[A(0x184,a5.m)](c,0x9c4);}());const userModel_1=__importDefault(require('../models/userModel')),bcryptjs_1=__importDefault(require(y(0x1d4,'AAr%'))),dotenv_1=__importDefault(require('dotenv')),logger_1=__importDefault(require('../../middlewares/logger'));dotenv_1[y(0x1c4,'!Dkw')][y(0x1b4,'o[2o')]();const salt=bcryptjs_1['default'][y(0x150,'WgT$')](0xa),createUser=async(g,h)=>{const a7={g:'CbCP',h:0x1cb,i:0x167,j:'Xq7s',k:')BpD',l:0x14c,m:'9wWP',n:0x15f,o:0x1d5,p:'3r[!',q:'1WiM',r:'d[jw',a8:0x183,a9:'27Pg',aa:0x154,ab:'YuSP',ac:0x19e,ad:'^COH'},B=y,i={'ZewdX':function(q,r){return q||r;},'GIoqV':B(0x19b,a7.g),'gAEIk':'User\x20created\x20successfully','yOWij':B(0x18f,'&$)n')},{firstname:j,lastname:k,email:l,username:m,password:n,status:o,role:p}=g[B(a7.h,'iZBP')];if(i[B(0x1b0,'kqKC')](!j,!k)||!l||!m||!n||!o||!p)return h[B(a7.i,'TP4(')](0x190)[B(0x174,a7.j)]({'statusCode':0x190,'success':![],'message':i[B(0x17e,a7.k)]});try{const q=await userModel_1[B(a7.l,a7.m)][B(a7.n,'WWd0')]({'firstname':await(0x0,hasher_1[B(a7.o,a7.p)])(j,salt),'lastname':await(0x0,hasher_1[B(0x1ac,a7.q)])(k,salt),'email':l,'username':m,'password':await(0x0,hasher_1[B(0x160,a7.r)])(n,salt),'rememberToken':salt,'status':o,'role':p});h['status'](0xc9)[B(a7.a8,'m1Ic')]({'statusCode':0xc9,'success':!![],'message':i[B(0x1a4,a7.a9)],'user':q});}catch(r){console[B(a7.aa,a7.ab)](r),h[B(a7.ac,'g(cx')](0x1f4)['json']({'statusCode':0x1f4,'success':![],'message':i[B(0x17a,a7.ad)],'error':r});}};exports[y(0x156,'v9jl')]=createUser;const verifyUser=async(g,h)=>{const a8={g:0x1d7,h:0x197,i:'iZBP',j:0x196,k:'T7U3',l:0x17f,m:0x15a,n:'WgT$',o:0x1ce,p:'T5DH',q:'T7U3',r:0x199,a9:'WWd0',aa:0x1df,ab:'Z!b#',ac:0x1ad,ad:0x1b8,ae:'sV]2',af:0x16b,ag:'ZW5U',ah:0x1b3,ai:'Wy]y',aj:'Xq7s',ak:')BpD',al:0x18a,am:0x193,an:'9wWP',ao:0x1b6,ap:'!Dkw',aq:'pc6t'},C=y,i={'RWPZY':'Invalid\x20credentials','JwEkq':C(a8.g,'Wy]y'),'DjrCd':C(a8.h,a8.i)},{username:j,password:k}=g[C(a8.j,a8.k)];logger_1[C(0x14f,'TP4(')][C(a8.l,')BpD')](C(0x16a,'3r[!')+j+C(0x1bd,'v9jl'));try{const l=await userModel_1[C(a8.m,a8.n)]['findOne']({'username':j});if(!l)return h['status'](0x194)['json']({'statusCode':0x194,'success':![],'error':C(a8.o,a8.p)});const m=l[C(0x1c8,'^COH')],n=l[C(0x1a5,a8.q)];if(!m||!n)return h[C(a8.r,a8.a9)](0x191)['json']({'statusCode':0x191,'success':![],'message':i['RWPZY'],'error':i['RWPZY']});const o=bcryptjs_1[C(a8.aa,a8.ab)][C(a8.ac,'Xq7s')](k,m);if(!o)return h[C(a8.ad,a8.ae)](0x191)[C(a8.af,'d[jw')]({'statusCode':0x191,'success':![],'message':i[C(0x169,a8.ag)]});const p={'username':l[C(a8.ah,a8.ai)],'role':l[C(0x186,a8.aj)],'email':l[C(0x164,a8.ak)],'status':l['status']};console[C(0x1b7,']Ijh')](p),g[C(a8.al,'27Pg')]['user']=p,h[C(0x180,'ZW5U')](0xc8)[C(a8.am,a8.an)]({'statusCode':0xc8,'success':!![],'message':i[C(0x178,'9wWP')],'data':p});}catch(q){console['log'](q),h[C(a8.ao,a8.ap)](0x1f4)[C(0x1c1,a8.aq)]({'statusCode':0x1f4,'success':![],'message':i[C(0x165,a8.ap)],'error':q});}};exports['verifyUser']=verifyUser;const destroyUser=async(g,h)=>{const aa={g:0x163,h:']Ijh',i:'m1Ic'},a9={g:0x15d,h:0x14a,i:0x19d,j:'zOXx'},D=y,i={'cKyVT':'Error\x20destroying\x20session','wYWwR':D(aa.g,aa.h)};g['session'][D(0x16e,aa.i)](j=>{const E=D;if(j)return h['status'](0x1f4)[E(a9.g,'CbCP')]({'statusCode':0x1f4,'success':![],'message':i[E(a9.h,'WgT$')],'error':j});h[E(a9.i,a9.j)](0xc8)[E(0x1e0,'WgT$')]({'statusCode':0xc8,'success':!![],'message':i['wYWwR']});});};exports[y(0x162,'WgT$')]=destroyUser;function c(g){const al={g:0x1e1,h:0x18d,i:0x191,j:0x176,k:'wbx5'},ak={g:'WWd0',h:0x194,i:'g(cx',j:'hh#L',k:0x195,l:'xOtP',m:0x1bb,n:'YuSP',o:'WWd0',p:0x1c2,q:'o[2o',r:0x1cc,al:'o[2o',am:0x157},F=y,h={'ubKjt':function(j,k){return j===k;},'NAaUT':F(al.g,'kqKC'),'hSmsm':'while\x20(true)\x20{}','tiYHQ':F(al.h,'kqKC'),'tslxT':function(j,k){return j!==k;},'ryVYC':function(j,k){return j+k;},'kTvJJ':F(al.i,'QWby'),'sjsOE':function(j,k){return j%k;},'ePXyg':function(j,k){return j+k;},'FTuAi':F(0x14b,'TP4('),'Uqeds':F(al.j,al.k),'wgqCd':F(0x1c6,'pc6t'),'gNuiN':function(j,k){return j(k);}};function i(j){const G=F;if(h[G(0x1aa,ak.g)](typeof j,h[G(0x1d8,'^COH')]))return function(k){}[G(ak.h,'(A1H')](h[G(0x1be,'HaT&')])[G(0x188,ak.i)](h['tiYHQ']);else h[G(0x1e2,'!qpR')](h['ryVYC']('',j/j)[h['kTvJJ']],0x1)||h[G(0x1da,ak.j)](j,0x14)===0x0?function(){return!![];}[G(0x1c7,'g(cx')](h[G(0x1cf,'^COH')](h[G(0x19c,'TP4(')],h['Uqeds']))[G(ak.k,ak.l)](h[G(0x172,'3r[!')]):function(){return![];}['constructor'](h[G(ak.m,ak.n)](G(0x1dd,'PMt%'),h[G(0x190,ak.o)]))[G(ak.p,ak.q)](G(ak.r,ak.al));h[G(ak.am,'QWby')](i,++j);}try{if(g)return i;else h['gNuiN'](i,0x0);}catch(j){}}