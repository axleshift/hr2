import{r as e}from"./react-router-dom-BnDDw25P.js";import{F as i,B as n,C as r}from"./index.es-BR7Rjtum.js";import{j as t,a,g as l,x as s,v as o,p as c,A as d,F as m,k as h,w as u}from"./index-D-GnuKZU.js";import{t as p,f as v,b as f}from"./index-DCO1bnrX.js";import b from"./EventForm-BUFFe_KH.js";import{u as y}from"./react-hook-form-DB8hWBdy.js";import{z as g}from"./zod-B0zZW6rS.js";import{s as w}from"./@hookform/resolvers/zod-1wp20Skh.js";import{J as C}from"./JobOfferForm-BsyvO5id.js";import{C as j,a as x,b as S}from"./CModalHeader-DQJDo40N.js";import{C as N}from"./CModalTitle-HFeZ3kaT.js";import{C as q,a as k}from"./CRow-Cw4eeKIx.js";import{C as I,b as E,a as F}from"./CFormLabel-CNa7kd_d.js";import{C as T}from"./CFormInput-Dn-iE12k.js";import{C as O}from"./CFormSelect-BQ8Vu6il.js";import{C as R}from"./CFormRange-C1H6iHil.js";import{C as A}from"./CFormTextarea-Dk0Pnquo.js";import{C as V}from"./CContainer-m_k2ePgi.js";import{C as z}from"./CInputGroup-CgKedWGZ.js";import{C as P,a as _}from"./CCardBody-BNtC-I3D.js";import{C as D,a as $,b as J,c as L,d as M,e as G}from"./CTable-Dt26rGib.js";import{C as H}from"./CTooltip-BDYXaFVj.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./AppPagination-CNyQjqz2.js";import"./CTabList-B5K2uO10.js";import"./DefaultLayout-DhgmFM8H.js";import"./index.esm-Bak_xBZl.js";import"./isRTL-D5ORmfro.js";import"./ConfirmationDialog-DLQbLm82.js";import"./CCardHeader-D5VxVYqk.js";import"./CFormCheck-cdq4rsa3.js";const Q=g.object({date:g.string().nonempty("Date is required"),job:g.string().min(3,{message:"Job is required"}),type:g.enum(["Phone","Video","In-Person"]),general:g.object({communication:g.number().min(1).max(5).default(1),technical:g.number().min(1).max(5).default(1),problemSolving:g.number().min(1).max(5).default(1),culturalFit:g.number().min(1).max(5).default(1),workExperienceRelevance:g.number().min(1).max(5).default(1),leadership:g.number().min(1).max(5).default(1)}),questions:g.array(g.object({question:g.string().min(1,{message:"A question is required."}),remark:g.string().optional()})).optional(),salaryExpectation:g.coerce.number().min(1).default(1),strength:g.string().optional(),weakness:g.string().optional(),recommendation:g.enum(["yes","no","need further review"]),finalComments:g.string().optional()}),B=({isVisible:i,onClose:n,state:r,interview:c})=>{var d,m,h;const[u,p]=e.useState(!1),[v,f]=e.useState({}),[b,g]=e.useState("view"),[V,z]=e.useState(!1),[P,_]=e.useState("create"),[D,$]=e.useState(!1),{register:J,handleSubmit:L,reset:M,setValue:G,watch:H,formState:{errors:B},control:W}=y({resolver:async(e,i,n)=>await w(Q)(e,i,n)});return e.useEffect((()=>{z("edit"!==r)}),[r]),e.useEffect((()=>{if(u&&c){let e="";if(c.date){e=new Date(c.date).toISOString().split("T")[0]}const i={...c,date:e};f(c),M(i)}}),[u,c,M]),e.useEffect((()=>{i&&p(i)}),[i]),t(j,{visible:u,onClose:()=>{n(),p(!1)},backdrop:"static",size:"xl",children:[a(x,{children:a(N,{children:"edit"===b?"Edit Interview":"Interview Form"})}),t(S,{children:[a(q,{children:a(k,{children:t(I,{onSubmit:L((async e=>{try{"edit"===b?await s(`/applicant/interview/${v._id}`,e):await o("/applicant/interview",e),n()}catch(i){}})),children:[t(q,{className:"mb-3",children:[t(k,{children:[a(E,{children:"Date"}),a(T,{type:"date",...J("date"),readOnly:V,invalid:B.date}),B.date&&a(F,{children:B.date.message})]}),t(k,{children:[a(E,{children:"Interview Type"}),t(O,{disabled:V,...J("type"),invalid:B.type,children:[a("option",{value:"",children:"Select Type"}),a("option",{value:"Phone",children:"Phone"}),a("option",{value:"Video",children:"Video"}),a("option",{value:"In-Person",children:"In-Person"})]}),B.type&&a(F,{children:B.type.message})]}),t(k,{children:[a(E,{children:"Interviewer"}),a(T,{readOnly:V,defaultValue:`${null==(d=c.interviewer)?void 0:d.lastname}, ${null==(m=c.interviewer)?void 0:m.firstname}`})]})]}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a("h5",{children:"General Evaluation"}),["communication","technical","problemSolving","culturalFit","workExperienceRelevance","leadership"].map((e=>{var i,n,r,l;return t("div",{children:[a("label",{className:"text-capitalize",children:e.replace(/([A-Z])/g," $1")}),a(R,{min:1,max:5,disabled:V,...J(`general.${e}`),invalid:null==(i=null==B?void 0:B.general)?void 0:i[e]}),(null==(n=null==B?void 0:B.general)?void 0:n[e])&&a(F,{children:null==(l=null==(r=null==B?void 0:B.general)?void 0:r[e])?void 0:l.message})]},e)}))]})}),a(q,{className:"mb-3",children:t(k,{children:[a(T,{label:"Position / Job Applied For",readOnly:V,...J("job"),invalid:B.job}),B.job&&a(F,{children:B.job.message})]})}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a("h5",{children:"Interview Questions"}),null==(h=H("questions"))?void 0:h.map(((e,i)=>{var n,r,l,s,o,c,d;return t("div",{children:[a(q,{className:"mb-3",children:t(k,{children:[a(E,{children:"Question"}),a(T,{readOnly:V,...J(`questions.${i}.question`),invalid:null==(r=null==(n=null==B?void 0:B.questions)?void 0:n[i])?void 0:r.question}),(null==(s=null==(l=null==B?void 0:B.questions)?void 0:l[i])?void 0:s.question)&&a(F,{children:null==(d=null==(c=null==(o=null==B?void 0:B.questions)?void 0:o[i])?void 0:c.question)?void 0:d.message})]})}),a(q,{className:"mb-3",children:t(k,{children:[a(E,{children:"Remark"}),a(A,{readOnly:V,...J(`questions.${i}.remark`)})]})})]},i)}))]})}),t(q,{className:"mb-3",children:[t(k,{xs:"12",sm:"6",children:[a(E,{children:"Salary Expectation"}),a(T,{type:"number",readOnly:V,...J("salaryExpectation"),invalid:B.salaryExpectation}),B.salaryExpectation&&a(F,{children:B.salaryExpectation.message})]}),t(k,{xs:"12",sm:"6",children:[a(E,{children:"Recommendation"}),t(O,{disabled:V,...J("recommendation"),invalid:B.recommendation,children:[a("option",{value:"yes",children:"Yes"}),a("option",{value:"no",children:"No"}),a("option",{value:"need further review",children:"Need further review"})]}),B.recommendation&&a(F,{children:B.recommendation.message})]})]}),a(q,{className:"mb-3",children:t(k,{children:[a(E,{children:"Strength"}),a(A,{readOnly:V,...J("strength")})]})}),a(q,{className:"mb-3",children:t(k,{children:[a(E,{children:"Weakness"}),a(A,{readOnly:V,...J("weakness")})]})}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a(E,{children:"Final Comments"}),a(A,{readOnly:V,...J("finalComments")})]})})]})})}),a(q,{children:a(k,{className:"d-flex justify-content-end",children:a(l,{color:"warning",size:"sm",onClick:()=>{_("create"),$(!0)},children:"Issue a Job Offer"})})}),a(q,{children:a(k,{children:a(C,{isVisible:D,state:P,onClose:()=>{$(!1)},interview:v})})})]})]})};B.propTypes={isVisible:c.bool.isRequired,onClose:c.func.isRequired,state:c.string,interview:c.object.isRequired};const W=()=>{const{userInformation:s}=e.useContext(d),[o,c]=e.useState([]),[y,g]=e.useState(!1),[w,C]=e.useState(!1),[j,x]=e.useState("view"),[S,N]=e.useState({}),[E,F]=e.useState(1),[O,R]=e.useState(9),[A,Q]=e.useState(0),[W,Y]=e.useState(0),[Z,K]=e.useState([]),[U,X]=e.useState(!1),[ee,ie]=e.useState(1),[ne,re]=e.useState(9),[te,ae]=e.useState(0),[le,se]=e.useState(0),[oe,ce]=e.useState(!1),[de,me]=e.useState({}),[he,ue]=e.useState("view"),[pe,ve]=e.useState({}),[fe,be]=e.useState({}),ye=async()=>{try{g(!0);const e=await u("/facilities/events/upcoming");200===e.status&&(c(e.data.data),g(!1))}catch(e){g(!1)}},ge=async()=>{try{X(!0);const e=await u("/applicant/interview/recent");200===e.status&&K(e.data.data)}catch(e){}finally{X(!1)}};return e.useEffect((()=>{const e=setTimeout((()=>{ye(),ge()}),500);return()=>clearTimeout(e)}),[E,A,W]),a(m,{children:t(V,{children:[a(q,{className:"mb-3",children:t(k,{children:[a("h2",{children:"Interviews & Other Events"}),t("small",{children:["In this page, you can ",a("span",{className:"text-info",children:"view"})," and"," ",a("span",{className:"text-warning",children:"edit"})," the list of upcoming interviews and events."]})]})}),a(q,{className:"mb-3",children:a(k,{children:a(I,{children:t(z,{children:[a(T,{type:"search",placeholder:"Search...","aria-label":"Search"}),a(l,{type:"button",color:"primary",children:a(i,{icon:n})}),a(l,{type:"button",color:"primary",onClick:()=>{ye()},children:a(i,{icon:r})})]})})})}),a(q,{className:"mb-3",children:a(k,{children:a(P,{children:a(_,{children:t(D,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[a($,{children:t(J,{children:[a(L,{children:"#"}),a(L,{children:"Event"}),a(L,{children:"Author"}),a(L,{children:"Type"}),a(L,{children:"Date"}),a(L,{children:"Timeslot"}),a(L,{children:"Participants"}),a(L,{children:"Approved"}),a(L,{children:"Actions"})]})}),a(M,{children:y?a(J,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:a(h,{variant:"grow",size:"sm"})})})}):0===o.length?a(J,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:"No upcoming events found"})})}):o.map((e=>{var i,n,r;return t(J,{children:[a(H,{placement:"top",content:e._id,children:a(G,{children:p(e._id,10)})}),a(G,{children:e.name}),t(G,{children:[e.author.lastname,", ",e.author.firstname]}),a(G,{children:e.type}),a(G,{children:v(e.date)}),t(G,{children:[f(null==(i=e.timeslot)?void 0:i.start)," - ",f(null==(n=e.timeslot)?void 0:n.end)," "]}),a(G,{children:a("div",{className:"d-flex justify-content-center",children:null==(r=e.participants)?void 0:r.length})}),a(G,{children:e.isApproved.status?a("span",{className:"text-success",children:"Approved"}):a("small",{className:"text-danger",children:"Requires Approval"})}),a(G,{children:t("div",{className:"d-flex gap-2 flex-row",children:[a(l,{color:"info",size:"sm",onClick:()=>{x("view"),C(!0),N(e.timeslot)},children:"View"}),("admin"===s.role||"manager"===s.role)&&a(l,{color:"warning",size:"sm",onClick:()=>{x("edit"),C(!0),N(e.timeslot)},children:"Manage"})]})})]},e._id)}))})]})})})})}),a("hr",{}),a(q,{children:a(k,{children:a("h2",{children:"Recent Interviews"})})}),a(q,{className:"mb-3",children:a(k,{children:a(P,{children:a(_,{children:t(D,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[a($,{children:t(J,{children:[a(L,{children:"#"}),a(L,{children:"Applicant"}),a(L,{children:"Interviewer"}),a(L,{children:"Type"}),a(L,{children:"Date"}),a(L,{children:"Recommendation"}),a(L,{children:"Action"})]})}),a(M,{children:U?a(J,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:a(h,{variant:"grow",size:"sm"})})})}):0===Z.length?a(J,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:"No recent interviews found"})})}):Z.map((e=>t(J,{children:[a(H,{placement:"top",content:e._id,children:a(G,{children:p(e._id,10)})}),t(G,{children:[e.applicant.lastname,", ",e.applicant.firstname]}),t(G,{children:[e.interviewer.lastname,", ",e.interviewer.firstname]}),a(G,{children:e.type}),a(G,{children:v(e.date)}),a(G,{className:"text-capitalize",children:e.recommendation}),a(G,{children:a(l,{color:"warning",size:"sm",onClick:()=>{me(e),ue("view"),ce(!0)},children:"Manage"})})]},e._id)))})]})})})})}),a(q,{children:a(k,{children:a(b,{isVisible:w,onClose:()=>{x("view"),C(!1),ye(),ge()},state:j,slot:S})})}),a(q,{children:a(k,{children:a(B,{isVisible:oe,onClose:()=>ce(!1),state:he,interview:de})})})]})})};export{W as default};
