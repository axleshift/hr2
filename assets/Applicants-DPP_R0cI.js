import{m as e,j as a,a as t,g as i,k as n,x as r,p as c,F as l}from"./index-DiLnYbjC.js";import{F as s,A as d,B as o,V as h,f as m,T as p}from"./index.es-BUpMRE3D.js";import{R as u,r as f}from"./react-router-dom-BnDDw25P.js";import{A as g}from"./AppPagination-CAajZQ_e.js";import{z as x}from"./zod-B0zZW6rS.js";import{u as N}from"./react-hook-form-DB8hWBdy.js";import{s as v}from"./@hookform/resolvers/zod-1wp20Skh.js";import{C as y}from"./Calendar-Boc9hzhP.js";import{U as C,f as S,t as b,c as j}from"./index-BOi-5bX2.js";import{C as w,a as _,b as T}from"./CModalHeader-BDpLr51j.js";import{C as k}from"./CModalTitle-Cp-5Mm7J.js";import{C as A}from"./CContainer-DzOuZpEx.js";import{C as D,a as P}from"./CRow-BNc0QFWW.js";import{C as F}from"./CFormInput-uT5SP9Ht.js";import{C as E,a as I,b as M,c as R}from"./CTabList-CMUdfq-k.js";import{b as $,a as z}from"./DefaultLayout-Cau2R5kl.js";import{C as L,a as K}from"./CFormLabel-DwEY-V3u.js";import{C as q}from"./CInputGroup-CqBjsx_2.js";import{C as H}from"./CTooltip-Dv1PmkHW.js";import{C as V,a as Y,b as O,c as B,d as W,e as G}from"./CTable-Bp7z3h6O.js";import{C as J,a as U}from"./CCardBody-BlNAuiwx.js";import"./react-dom-DgB6LS8R.js";import"./react-BF1r7_8g.js";import"./clsx-BeLtu-UY.js";import"./index.esm-Dwb_M0UQ.js";import"./isRTL-D5ORmfro.js";const X=({isVisible:c,onClose:l,isDarkMode:o,applicantData:h})=>{const{addToast:m}=u.useContext(e),[p,x]=f.useState({}),[N,v]=f.useState(!1),[z,K]=f.useState(C(new Date)),[J,U]=f.useState([]),[X,Z]=f.useState([]),[Q,ee]=f.useState([]),[ae,te]=f.useState([]),[ie,ne]=f.useState(1),[re,ce]=f.useState(10),[le,se]=f.useState(1),de=e=>e.sort(((e,a)=>{const t=new Date(e.date)-new Date(a.date);if(0!==t)return t;const i=e.timeslot.start.split(":").map(Number),n=a.timeslot.start.split(":").map(Number);return 60*i[0]+i[1]-(60*n[0]+n[1])})),oe=e=>{ee((a=>({...a,[e]:!a[e]})))};return f.useEffect((()=>{(async e=>{v(!0);try{const a=await r(`/interview/all?date=${e}&page=${ie}&limit=${re}`);if(200===a.status){const e=de(a.data.data);U(e),ee(new Array(a.data.data.length).fill(!1)),ne(a.data.currentPage),se(a.data.totalPages),v(!1)}else v(!1),m("Calendar | Scheduling Form",a.message.message,"danger")}catch(a){v(!1)}})(z)}),[z,ie,re]),f.useEffect((()=>{h&&x(h)}),[h]),a(w,{visible:c,onClose:()=>{l(),K(C(new Date)),te([])},size:"xl",children:[t(_,{children:t(k,{children:a("div",{children:["Schedule Interview for"," ",a("span",{className:"fw-bold",children:[null==h?void 0:h.lastname,", ",null==h?void 0:h.firstname]})]})})}),t(T,{children:a(A,{children:[t(D,{className:"mb-3",children:t(P,{children:t("div",{children:t(y,{onChange:e=>{K(e)},defaultValue:z,className:o?"calendar dark-mode":"calendar"})})})}),t(D,{className:"mb-3",children:t(P,{children:t(F,{type:"text",id:"date",name:"date",placeholder:"Date",value:S(z),readOnly:!0})})}),t(D,{className:"mb-3",children:a(P,{children:[t("h2",{children:"Events"}),a("small",{children:["Pick an event to schedule an interview for"," ",a("span",{className:"text-info",children:[null==h?void 0:h.lastname,", ",null==h?void 0:h.firstname]})]})]})}),t(D,{className:"mb-3",children:t(P,{children:a(E,{activeItemKey:"events",children:[a(I,{variant:"underline-border",children:[t(M,{itemKey:"events",children:"Events"}),t(M,{itemKey:"applicant",children:"Applicantâ€˜s Events"})]}),a($,{children:[a(R,{itemKey:"events",children:[t("div",{className:"my-3",children:t(L,{children:a(q,{children:[t(F,{type:"text",id:"search",name:"search",placeholder:"Search"}),t(H,{content:"Search for events",placement:"top",children:t(i,{color:"primary",children:t(s,{icon:d})})})]})})}),a(V,{align:"middle",responsive:!0,children:[t(Y,{children:a(O,{children:[t(B,{className:"text-center",children:"#"}),t(B,{className:"text-center",children:"Title"}),t(B,{className:"text-center",children:"Capacity"}),t(B,{className:"text-center",children:"Participants"}),t(B,{className:"text-center",children:"Timeslot"}),t(B,{className:"text-center",children:"Actions"})]})}),t(W,{children:N?t(O,{children:t(G,{colSpan:"7",className:"text-center",children:t(n,{color:"primary",variant:"grow"})})}):0===J.length?t(O,{children:t(G,{colSpan:"7",className:"text-center",children:"No data found"})}):J.map(((e,n)=>e.participants.includes(h._id)?null:a(u.Fragment,{children:[a(O,{children:[t(G,{className:"text-center",children:b(e._id,3)}),t(G,{className:"text-center",children:e.title}),t(G,{className:"text-center",children:e.capacity}),t(G,{className:"text-center",children:e.participants.length}),t(G,{className:"text-center",children:a("small",{children:[j(e.timeslot.start)," -"," ",j(e.timeslot.end)]})}),t(G,{className:"text-center",children:a(q,{children:[t(i,{color:"primary",size:"sm",disabled:e.participants.length>=e.capacity||e.participants.includes(h._id)||!!ae.find((a=>a._id===e._id)),onClick:()=>(async e=>{try{if(ae.find((a=>a._id===e._id)))return;const a=de([...ae,e]);te(a)}catch(a){}})(e),children:e.participants.length>=e.capacity?"Full":e.participants.includes(h._id)||ae.find((a=>a._id===e._id))?"Added":"Add"}),t(i,{color:"info",size:"sm",onClick:()=>oe(n),children:Q[n]?"Hide":"Show"})]})})]}),Q[n]&&t(O,{children:a(G,{colSpan:"7",children:[t("h6",{children:"Addditional Information"}),t("p",{children:e.additionalInfo}),t("h6",{children:"Location"}),t("p",{children:e.location})]})})]},e._id)))})]}),t("div",{className:"d-flex align-items-center justify-content-center",children:t(g,{currentPage:ie,totalPages:le,onPageChange:ne})})]}),a(R,{itemKey:"applicant",children:[a(V,{align:"middle",responsive:!0,children:[t(Y,{children:a(O,{children:[t(B,{className:"text-center",children:"#"}),t(B,{className:"text-center",children:"Title"}),t(B,{className:"text-center",children:"Date"}),t(B,{className:"text-center",children:"Timeslot"}),t(B,{className:"text-center",children:"Actions"})]})}),t(W,{children:N?t(O,{children:t(G,{colSpan:"7",className:"text-center",children:t(n,{color:"primary",variant:"grow"})})}):0===ae.length?t(O,{children:t(G,{colSpan:"7",className:"text-center",children:"No data found"})}):ae.map(((e,n)=>e.participants.includes(h._id)?null:a(u.Fragment,{children:[a(O,{children:[t(G,{className:"text-center",children:b(e._id,3)}),t(G,{className:"text-center",children:e.title}),t(G,{className:"text-center",children:S(e.date,"MMMM DD, YYYY")}),t(G,{className:"text-center",children:a("small",{children:[j(e.timeslot.start)," -"," ",j(e.timeslot.end)]})}),t(G,{className:"text-center",children:a(q,{children:[t(i,{color:"danger",size:"sm",disabled:e.participants.length>=e.capacity,onClick:()=>(async e=>{try{te((a=>a.filter((a=>a._id!==e._id))))}catch(a){}})(e),children:"Remove"}),t(i,{color:"info",size:"sm",onClick:()=>oe(n),children:Q[n]?"Hide":"Show"})]})})]}),Q[n]&&t(O,{children:a(G,{colSpan:"7",children:[t("h6",{children:"Addditional Information"}),t("p",{children:e.additionalInfo}),t("h6",{children:"Location"}),t("p",{children:e.location})]})})]},e._id)))})]}),a("div",{children:[a("small",{children:[t("span",{className:"text-danger",children:"Note:"})," Events added here will be scheduled for the applicant once the form is submitted."]}),t("br",{}),a("small",{children:[t("span",{className:"text-danger",children:"Warning:"})," Once closed, the events will be resetted. Make sure to submit the form before closing."]})]}),t("div",{className:"d-flex justify-content-end",children:t(i,{className:"btn btn-primary",children:"Submit"})})]})]})]})})})]})})]})};X.propTypes={isVisible:c.bool.isRequired,onClose:c.func.isRequired,isDarkMode:c.bool.isRequired,applicantData:c.object};const Z=({theme:c})=>{const u="dark"===c,{addToast:y}=f.useContext(e),[C,S]=f.useState(!1),[b,j]=f.useState([]),[w,_]=f.useState(!1),[T,k]=f.useState([]),[E,I]=f.useState({}),[M,R]=f.useState(!1),[$,Z]=f.useState([]),[Q,ee]=f.useState(!1),[ae,te]=f.useState(""),[ie,ne]=f.useState(1),[re,ce]=f.useState(9),[le,se]=f.useState(1),de=async(e,a,t)=>{try{_(!0);let i="";$.length>0&&(i=$.map((e=>`${e}`)).join(","));const n=Q?await r(`/applicant/search?query=${t}&page=${e}&limit=${a}&tags=${i}`):await r("/applicant/all");200===n.status?(k(n.data.data),se(n.data.totalPages),_(!1)):(y("Error","Failed to fetch data","danger"),_(!1))}catch(i){y("Error","Failed to fetch data","danger")}},oe=x.object({searchTerm:x.string().min(1,"Search term is required")}),{register:he,handleSubmit:me,formState:{errors:pe}}=N({resolver:async(e,a,t)=>await v(oe)(e,a,t)});return f.useEffect((()=>{(async()=>{try{S(!0);const e="applicant",a=await r(`/tags/category/${e}`);200===a.status?(j(a.data.data),S(!1)):(y("Calendar | Applicants",a.message.message,"danger"),S(!1))}catch(e){y("Calendar | Applicants","Failed to fetch data","danger")}})();const e=setTimeout((()=>{de(ie,re,ae)}),300);return()=>clearTimeout(e)}),[ie,re,Q,ae]),t(l,{children:a(A,{className:"d-flex flex-column gap-3",children:[t(D,{children:a(P,{children:[t("h2",{children:"Applicants"}),t("small",{children:"In this page, you can view and edit the list of applicants which are waiting for the HR to schedule an interview or any event they need to attend."})]})}),t(D,{children:a(A,{className:"d-flex flex-column gap-3",children:[a(L,{onSubmit:me((e=>{const{searchTerm:a}=e;k([]),te(a),ee(!0),ne(1),de(ie,re,a)})),children:[a(q,{children:[t(F,{type:"text",placeholder:"Search",...he("searchTerm"),invalid:!!pe.searchTerm}),t(H,{placement:"top",content:"Search",children:t(i,{type:"submit",color:"primary",children:t(s,{icon:d})})}),t(H,{placement:"top",content:"Refresh",children:t(i,{color:"primary",onClick:()=>(te(""),ee(!1),ne(1),void de(ie,re)),children:t(s,{icon:o})})})]}),pe.searchTerm&&t(K,{invalid:!0,children:pe.searchTerm.message})]}),t("div",{className:"d-flex flex-wrap gap-2",children:b.map((e=>t(H,{content:$.includes(e._id)?"Remove":"Add",children:a(z,{onClick:()=>(e=>{if($.includes(e)){const a=$.filter((a=>a!==e));Z(a)}else Z([...$,e])})(e._id),color:$.includes(e._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[e.name,$.includes(e._id)&&t(s,{icon:h,className:"ms-2"})]})},e._id)))})]})}),t(D,{children:t(A,{children:t(J,{children:t(U,{children:a(V,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[t(Y,{children:a(O,{children:[t(B,{children:t(s,{icon:m})}),t(B,{children:"Email"}),t(B,{children:"Phone"}),t(B,{children:"Tags"}),t(B,{children:"Action"})]})}),t(W,{children:w?t(O,{children:t(G,{colSpan:5,children:t("div",{className:"pt-3 text-center",children:t(n,{color:"primary",variant:"grow"})})})}):T.length>0?T.map((e=>a(O,{children:[t(G,{children:a("div",{children:[e.lastname,", ",e.firstname]})}),t(G,{children:t("div",{children:e.email})}),t(G,{children:t("div",{children:e.phone})}),t(G,{children:t("div",{className:"d-flex gap-2",children:e.tags.map(((e,a)=>t(z,{color:"primary",children:b.find((a=>a._id===e))&&b.find((a=>a._id===e)).name},a)))})}),t(G,{children:t(H,{placement:"top",content:"Schedule Interview for this applicant",children:t(i,{onClick:()=>(async e=>{try{R(!0);const a=T.find((a=>a._id===e));I(a)}catch(a){y("Error","Failed to fetch data","danger")}})(e._id),className:"btn btn-primary",size:"sm",children:t(s,{icon:p})})})})]},e._id))):t(O,{children:t(G,{colSpan:5,children:"No data available"})})})]})})})})}),t(D,{children:t(P,{children:t("div",{className:"d-flex justify-content-center align-items-center",children:t(g,{currentPage:ie,totalPages:le,onPageChange:ne})})})}),t(D,{children:t(P,{children:t(X,{isVisible:M,onClose:()=>R(!1),isDarkMode:u,applicantData:E})})})]})})};Z.propTypes={theme:c.string};export{Z as default};
