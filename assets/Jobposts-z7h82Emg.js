import{q as _,R as r,o as G,k as e,g as p,l as L,G as P}from"./index-CiV4mRcZ.js";import{F as u,D as O,z as V,I as Y,K as H}from"./index.es-ba-Ohs3A.js";import"./index-DzqCvRIn.js";import{t as b,a as J}from"./index-DROTT6wf.js";import{A as K}from"./AppPagination-CbuU39Nq.js";import{z as w,u as Q,t as U}from"./zod-BQFeo2Z_.js";import{C as W}from"./CContainer-Do4jvznw.js";import{C as f,a as S}from"./CRow-DuUDi8eX.js";import{C as X,a as Z,c as ee}from"./CFormInput-DTJIjxRp.js";import{C as se}from"./CInputGroup-C2Au0wq3.js";import{C as l}from"./CTooltip-blDH3YDi.js";import{C as te,a as ae}from"./CCardBody-BSH2F1wg.js";import{C as re,a as ne,b as C,c as n,d as ce,e as a}from"./CTable-DxG5dJz1.js";import{a as d}from"./DefaultLayout-DjGsySbU.js";import{C as le}from"./CButtonGroup-Bcv8H7hU.js";import"./index.esm-C8caOtPE.js";const Ie=()=>{const D=_(),{addToast:v}=r.useContext(G),[y,A]=r.useState([]),[I,h]=r.useState(!1),[x,R]=r.useState(1),[T,F]=r.useState(1),[m,oe]=r.useState(10),[ie,j]=r.useState(!1),[g,de]=r.useState(""),N=async(s="",o,i)=>{h(!0);try{const t=s===""||s===null||s===void 0?await P(`/jobposter/all?page=${o}&limit=${i}`):await P(`/jobposter/all?query=${s}&page=${o}&limit=${i}`);if(t.status===200){console.log("Data:",t.data),A(t.data.data),F(t.data.totalPages),h(!1),j(!1);return}else v("Info",`No data found for '${s}'`,"info"),h(!1),j(!1)}catch(t){v("Danger","Failed to fetch data","Error"),console.error(t),h(!1),j(!1)}},$=w.object({query:w.string().min(3,{message:"Search query must be at least 3 characters"})}),{register:k,reset:xe,handleSubmit:M,formState:{error:c}}=Q({resolver:async(s,o,i)=>{const t=await U($)(s,o,i);return console.log("Validation result:",t),t}}),q=async s=>{j(!0),N(s.query,x,m)},B=()=>{N(g,x,m)},E=s=>{D(`/recruitment/jobposter/${s.ref_id}`)},z=s=>{const o=new Date,i=new Date(s),t=o-i;return Math.floor(t/(1e3*60*60*24))};return r.useEffect(()=>{N(g,x,m)},[g,x,m]),e.jsx(e.Fragment,{children:e.jsxs(W,{children:[e.jsx(f,{className:"mb-3",children:e.jsxs(S,{children:[e.jsx("h1",{children:"Jobpost Tracker"}),e.jsx("small",{className:"text-muted",children:"In this page, you can view all the jobpost tracker data in various platforms."})]})}),e.jsx(f,{className:"mb-3",children:e.jsx(S,{children:e.jsx(X,{onSubmit:M(q),children:e.jsxs(se,{children:[e.jsx(Z,{type:"text",placeholder:"Search...",...k("query"),invalid:!!(c!=null&&c.query)}),(c==null?void 0:c.query)&&e.jsx(ee,{className:"text-danger",children:c.query.message}),e.jsx(l,{content:"Search",placement:"top",children:e.jsx(p,{type:"submit",className:"btn btn-primary",children:e.jsx(u,{icon:O})})}),e.jsx(l,{content:"Refresh",placement:"top",children:e.jsx(p,{onClick:B,className:"btn btn-primary",children:e.jsx(u,{icon:V})})})]})})})}),e.jsx(f,{children:e.jsx(S,{children:e.jsx(te,{children:e.jsx(ae,{children:e.jsxs(re,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(ne,{children:e.jsxs(C,{children:[e.jsx(n,{children:e.jsx("div",{className:"text-center",children:e.jsx("strong",{children:"#"})})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Platform"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Approved"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Posted"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Deleted"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Expires At"})}),e.jsx(n,{children:"Content "}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Actions"})})]})}),e.jsx(ce,{children:I?e.jsx(C,{children:e.jsx(a,{colSpan:"8",children:e.jsx(L,{variant:"grow"})})}):y.length===0?e.jsx(C,{children:e.jsx(a,{colSpan:"8",children:e.jsx("div",{className:"text-center",children:"No data"})})}):y.map(s=>e.jsxs(C,{children:[e.jsx(a,{children:e.jsx(l,{content:s._id,placement:"top",interactive:!0,offset:[-10,0],children:e.jsx("div",{className:"text-capitalize text-center",children:b(s._id,2)})})}),e.jsx(a,{children:e.jsx("div",{className:"text-capitalize text-center",children:s.platform})}),e.jsx(a,{className:"text-center",children:s.isApproved?e.jsx(d,{color:"success",children:"YES"}):e.jsx(d,{color:"danger",children:"NO"})}),e.jsx(a,{className:"text-center",children:s.isPosted?e.jsx(d,{color:"success",children:"YES"}):e.jsx(d,{color:"danger",children:"NO"})}),e.jsx(a,{className:"text-center",children:s.isDeleted?e.jsx(d,{color:"danger",children:"YES"}):e.jsx(d,{color:"info",children:"NO"})}),e.jsx(a,{className:"text-center",children:e.jsx(l,{content:z(s.expiresAt)+" days left",placement:"top",children:e.jsx("span",{className:"text-info",children:J(s.expiresAt)})})}),e.jsx(a,{children:e.jsx(l,{content:b(s.content,100),placement:"top",children:e.jsx("small",{children:b(s.content,50)})})}),e.jsx(a,{className:"text-center",children:e.jsxs(le,{children:[e.jsx(l,{content:"Edit",placement:"top",children:e.jsx(p,{color:"primary",children:e.jsx(u,{icon:Y})})}),e.jsx(l,{content:"View",placement:"top",children:e.jsx(p,{color:"info",onClick:()=>E(s),children:e.jsx(u,{icon:H})})})]})})]},s._id))})]})})})})}),e.jsx(f,{children:e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(K,{currentPage:x,totalPages:T,onPageChange:R})})})]})})};export{Ie as default};
