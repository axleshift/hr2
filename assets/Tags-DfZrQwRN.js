import{r,o as ge,A as ue,k as e,g as o,l as U,G as k,E as je,F as pe,I as fe}from"./index-BHhXFTpT.js";import{z as i,u as G,C as d,t as _}from"./zod-bsdIf8UL.js";import{A as ye}from"./AppPagination-DAbLINZA.js";import{F as m,y as q,q as Ce,r as be,m as B,D as Se,E as Ne,G as Pe,s as Te,x as ve}from"./index.es-1HsAF_2m.js";import{c as we}from"./index-BAMQJqXZ.js";import{C as A}from"./CContainer-Ckh7DILw.js";import{C as n,a as l}from"./CRow-DPHhf0KO.js";import{C as H,a as z}from"./CCardBody-ChGd257n.js";import{C as Ee}from"./CCardHeader-hWHSLVp-.js";import{C as Ie}from"./CCollapse-RPaFKmnY.js";import{C as Y,a as j,c as g,b as O}from"./CFormInput-75QpXbeP.js";import{C as D}from"./CInputGroup-mfxy4iHe.js";import{C as Fe}from"./CCardFooter-CtEQt-La.js";import{C as ke}from"./CButtonGroup-5a1Wvfjo.js";import{C as Ae,a as De,b as Me,c as Re,d as $e}from"./CModalTitle-pXG5y8oH.js";import{C as Le}from"./CFormCheck-fXw7GKfI.js";import"./DefaultLayout-B876mhfk.js";import"./index.esm-ChwMT21S.js";const rs=()=>{const{addToast:c}=r.useContext(ge),[P,V]=r.useState([]),[W,f]=r.useState(!1),[T,J]=r.useState({}),[h,v]=r.useState(!1),[y,C]=r.useState(!0),[K,w]=r.useState(!1),[E,Q]=r.useState(!1),[X,I]=r.useState(!1),[M,Z]=r.useState(""),[R,ee]=r.useState(!1),[b,$]=r.useState(1),[F,Ue]=r.useState(9),[se,te]=r.useState(0);r.useContext(ue);const S=async()=>{try{f(!0);const s=R?await k(`/tags/search?query=${M}&page=${b}&limit=${F}`):await k(`/tags/all?page=${b}&limit=${F}`);s.status===200?(V(s.data.data),te(s.data.totalPages),$(s.data.currentPage),f(!1),c("Success","Tags are successfully retrieved","success")):(console.log(s),f(!1),c("Error","An error occurred while fetching the tags","danger"))}catch(s){console.log(s),f(!1),c("Error","An error occurred while fetching the tags","danger")}},ae=i.object({id:i.string().optional(),name:i.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:i.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:i.preprocess(s=>s==="true"||s===!0,i.boolean()).optional().default(!1),isSystem:i.preprocess(s=>s==="true"||s===!0,i.boolean()).optional().default(!1),description:i.string().optional()}),{register:p,reset:x,handleSubmit:re,formState:{errors:a}}=G({resolver:_(ae)}),ne=async s=>{try{const t=P.find(L=>L.name===s.name&&L.category===s.category);if(!h&&t){console.log("Tag already exist");return}console.log(s);const u=h?await je(`/tags/${s.id}`,s):await pe("/tags",s);u.status===200||u.status===201?(h?c("Success","Tag is successfully updated","success"):c("Success","Tag is successfully added","success"),x({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),v(!1),C(!0),S()):c("Error","An error occurred while adding the tag","danger")}catch{c("Error","An error occurred while adding the tag","danger")}},ce=async s=>{try{v(!0),C(!0);const t=await k(`/tags/${s}`);if(t.status===200){const u={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};x(u),c("Success","Tag is successfully retrieved","success")}}catch{c("Error","An error occurred while fetching the tag","danger")}},oe=s=>{const t=P.find(u=>u._id===s);J(t),w(!0)},ie=async s=>{try{I(!0);const t=await fe(`/tags/${s}`);t.status===200?(c("Success","Tag has been deleted successfully","success"),S(),w(!1)):(console.log(t),c("Error",t.message.message,"danger"),I(!1))}catch{c("Error","An error occurred while deleting the tag","danger"),I(!1)}},le=()=>{x({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),v(!1),C(!0)},de=i.object({searchInput:i.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:me,reset:Ge,handleSubmit:he,formState:{errors:N}}=G({resolver:_(de)}),xe=async s=>{try{console.log(s),Z(s.searchInput),ee(!0),S()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{S()},300);return()=>clearTimeout(s)},[b,F,R,M]),e.jsxs(A,{className:"d-flex flex-column gap-3",children:[e.jsx(n,{children:e.jsx(A,{children:e.jsxs(H,{children:[e.jsx(Ee,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:h?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:h?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[h&&e.jsx(d,{content:"Reset form",placement:"top",children:e.jsx(o,{onClick:()=>le(),className:"btn btn-danger",children:e.jsx(m,{icon:q})})}),e.jsx(d,{content:y?"Collapse":"Expand",placement:"top",children:e.jsx(o,{onClick:()=>C(!y),className:"btn btn-primary",children:e.jsx(m,{icon:y?Ce:be})})})]})]})}),e.jsx(Ie,{visible:y,children:e.jsx(z,{children:e.jsx(Y,{onSubmit:re(ne),children:e.jsxs(A,{className:"d-flex flex-column gap-2",children:[e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(j,{type:"hidden",id:"id",...p("id"),invalid:!!a.id}),a&&a.id&&e.jsx(g,{className:"text-danger",children:a.id.message}),e.jsx(j,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...p("name"),invalid:!!a.name}),a&&a.name&&e.jsx(g,{className:"text-danger",children:a.name.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(j,{type:"text",id:"category",placeholder:"Category",label:"Category",...p("category"),invalid:!!a.category}),a&&a.category&&e.jsx(g,{className:"text-danger",children:a.category.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(O,{children:"Protected?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...p("isProtected"),invalid:!!a.isProtected}),e.jsx(d,{content:"Protect",placement:"top",children:e.jsx(o,{onClick:()=>x({isProtected:!0}),className:"btn btn-primary",children:e.jsx(m,{icon:B})})}),e.jsx(d,{content:"Unprotect",placement:"top",children:e.jsx(o,{onClick:()=>x({isProtected:!1}),className:"btn btn-warning",children:e.jsx(m,{icon:Se})})})]}),a&&a.isProtected&&e.jsx(g,{className:"text-danger",children:a.isProtected.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(O,{children:"System Tag ?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:!1,...p("isSystem"),invalid:!!a.isSystem}),e.jsx(d,{content:"Protect",placement:"top",children:e.jsx(o,{onClick:()=>x({isSystem:!0}),className:"btn btn-primary",children:e.jsx(m,{icon:Ne})})}),e.jsx(d,{content:"Unprotect",placement:"top",children:e.jsx(o,{onClick:()=>x({isSystem:!1}),className:"btn btn-warning",children:e.jsx(m,{icon:Pe})})})]}),a&&a.isSystem&&e.jsx(g,{className:"text-danger",children:a.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(o,{color:"primary",type:"submit",className:"mb-3 w-25",children:h?"Update":"Submit"})})]})})})})]})})}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("h1",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(Y,{onSubmit:he(xe),children:[e.jsxs(D,{children:[e.jsx(j,{placeholder:"...",id:"searcInput",...me("searchInput"),invalid:!!N.searchInput}),e.jsx(d,{content:"Search tags",placement:"top",children:e.jsx(o,{type:"submit",className:"btn btn-primary",children:e.jsx(m,{icon:Te})})})]}),N&&N.searchInput&&e.jsx(g,{className:"text-danger",children:N.searchInput.message})]})})]})}),e.jsx(n,{children:W?e.jsx("div",{className:"pt-3 text-center",children:e.jsx(U,{color:"primary",variant:"grow"})}):P.map((s,t)=>e.jsx(l,{md:4,className:"mb-3",children:e.jsxs(H,{className:"h-100",children:[e.jsxs(z,{children:[e.jsx(n,{children:e.jsxs(l,{children:[e.jsx("h5",{children:we(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(n,{children:e.jsxs(l,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(n,{children:e.jsxs(l,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsx(Fe,{children:e.jsx(n,{children:e.jsx(l,{children:e.jsxs(ke,{children:[e.jsx(d,{content:"Edit tag",placement:"top",children:e.jsx(o,{color:"primary",onClick:()=>ce(s._id),children:e.jsx(m,{icon:ve})})}),e.jsx(d,{content:"Delete tag",placement:"top",children:e.jsx(o,{color:"danger",onClick:()=>oe(s._id),disabled:s.isProtected,children:e.jsx(m,{icon:s.isProtected?B:q})})})]})})})})]})},t))}),e.jsx(n,{children:e.jsx(l,{children:e.jsxs(Ae,{visible:K,onClose:()=>w(!1),children:[e.jsx(De,{children:e.jsx(Me,{className:"text-danger",children:"Warning"})}),e.jsx(Re,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:T.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:T.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs($e,{children:[e.jsxs(l,{className:"d-flex justify-content-end",children:[e.jsx(Le,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:E,onChange:()=>Q(!E)}),e.jsx(g,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(o,{onClick:()=>ie(T._id),disabled:!E,className:"btn btn-danger",children:X?e.jsx(U,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ye,{currentPage:b,totalPages:se||1,onPageChange:$})})})]})};export{rs as default};
