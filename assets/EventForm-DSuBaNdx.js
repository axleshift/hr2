import{r as e,R as a}from"./react-router-dom-BnDDw25P.js";import{m as i,a as r,j as t,k as s,F as n,g as c,w as o,x as l,v as d,p as m}from"./index-C66lSxRl.js";import{z as p}from"./zod-B0zZW6rS.js";import{u as h}from"./react-hook-form-DGCwHb0C.js";import{s as u}from"./@hookform/resolvers/zod-B5rlnuQ9.js";import{b as f}from"./index-BVfmz2P_.js";import{C as b}from"./CContainer-DnAwT2KJ.js";import{C as v,a as C}from"./CRow-BC2jnXSR.js";import{C as j,a as y,b as g}from"./CModalHeader-17a_J2dP.js";import{C as x}from"./CModalTitle-UbKkKgfG.js";import{C as N,a as E}from"./CFormLabel-CnrvBD9C.js";import{C as w}from"./CFormInput-7yAhRXCl.js";import{C as F}from"./CFormTextarea-CUvmDkxd.js";import{C as M,a as S}from"./CCardBody-oEpd84ML.js";import{C as T}from"./CCardHeader-QL0CeDVz.js";import{C as k,a as D,b as z,c as L,d as $,e as A}from"./CTable-C_OnMufT.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./DefaultLayout-BlBcqPq3.js";import"./index.esm-CoSUUeCw.js";import"./index.es-DzFLx6Av.js";import"./isRTL-D5ORmfro.js";const I=({isVisible:m,onClose:I,isEdit:R,slot:V})=>{const{addToast:_}=e.useContext(i),[H,U]=a.useState({}),[B,G]=a.useState(!1),[K,P]=a.useState(!1),Q=p.object({name:p.string().min(3).max(50),description:p.string().optional(),capacity:p.number().int().positive()}),{register:W,handleSubmit:X,reset:Y,formState:{errors:Z},setValue:q}=h({resolver:u(Q)});return e.useEffect((()=>{R&&(async()=>{try{G(!0);const e=await o(`/facilities/event/${V.event}`);if(200===e.status)return U(e.data.data),Y(e.data.data),G(!1),_("Success","Event Fetched","success")}catch(e){_("error","failed to load event data","danger")}})()}),[R]),r(b,{children:r(v,{children:r(C,{children:t(j,{visible:m,onClose:()=>{Y({name:"",description:"",capacity:1}),I(),U({})},size:"xl",children:[r(y,{children:r(x,{children:R?"Manage Event":"Add Event"})}),r(g,{children:t(b,{children:[r(v,{className:"mb-3",children:t(C,{children:[t("strong",{children:[f(V.start)," - ",f(V.end)]}),r("br",{}),t("small",{className:"text-muted",children:[" Timeslot ID: ",V._id]})]})}),B&&R?r(v,{children:r(C,{children:r(s,{size:"sm"})})}):t(n,{children:[r(v,{children:r(C,{children:t(N,{onSubmit:X((async e=>{try{P(!0);const a=new FormData;a.append("name",e.name),a.append("description",e.description),a.append("capacity",e.capacity);const i=R?await l(`facilities/event/timeslot/${V._id}`,e):await d(`facilities/event/timeslot/${V._id}`,e);return 201===i.status?(P(!1),I(),_("success","Event created!","success")):200===i.status?(P(!1),I(),_("success","Event Updated!","success")):(P(!1),I(),_("Error","Failed to create event","error"))}catch(a){}})),children:[r(v,{className:"mb-3",children:t(C,{children:[r(w,{type:"text",label:"Name",placeholder:"Applicant Interview",...W("name"),invalid:Z.name}),Z.name&&r(E,{invalid:!0,className:"text-danger",children:Z.name.message})]})}),r(v,{className:"mb-3",children:t(C,{children:[r(F,{type:"text",label:"Description",placeholder:"Lorem ipsum...",rows:6,...W("description"),invalid:Z.description}),Z.description&&r(E,{invalid:!0,className:"text-danger",children:Z.description.message})]})}),r(v,{className:"mb-3",children:t(C,{children:[r(w,{type:"number",label:"Capacity",placeholder:"1",defaultValue:1,...W("capacity",{valueAsNumber:!0}),invalid:Z.capacity}),Z.capacity&&r(E,{invalid:!0,className:"text-danger",children:Z.capacity.message})]})}),r(v,{className:"mb-3",children:r(C,{children:t("div",{className:"d-flex justify-content-end gap-2",children:[r(c,{type:"button",color:"warning",onClick:()=>{const e=Math.floor(100*Math.random()),a={name:`Event ${e}`,description:`This is a mock description for event #${e}`,capacity:Math.floor(100*Math.random())+1};Y(a)},children:"Fill Mock Data"}),r(c,{type:"submit",color:"danger",children:"Delete"}),r(c,{type:"submit",color:"primary",children:K?r(s,{}):"Submit"})]})})})]})})}),H.participants&&r(n,{children:r(v,{children:r(C,{children:t(M,{children:[r(T,{children:"Participants"}),r(S,{children:t(k,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[r(D,{children:t(z,{children:[r(L,{children:"Name"}),r(L,{children:"Email"}),r(L,{children:"Action"})]})}),r($,{children:H.participants.map((e=>t(z,{children:[t(A,{children:[e.lastname,", ",e.firstname]}),r(A,{children:e.email}),r(A,{children:r(c,{size:"sm",color:"danger",children:"Remove"})})]},e._id)))})]})})]})})})})]})]})})]})})})})};I.propTypes={isVisible:m.bool,onClose:m.func,isEdit:m.bool,slot:m.object};export{I as default};
