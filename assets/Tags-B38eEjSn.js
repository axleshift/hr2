import{r as n,A as ne,j as e,B as T,y as ce,z as oe,E as ie}from"./index-CwFz_CIa.js";import{z as c,u as D,t as R}from"./zod-C9vK0_5Y.js";import{C as l,c as le}from"./index-BUSVYtsg.js";import{A as de}from"./AppPagination-BKMroPD6.js";import{F as d,l as $,m as me,n as he,k as U,w as xe,x as ge,y as je,z as pe,s as ue}from"./index.es-dst4GtBe.js";import{C as v}from"./CContainer-d5W9Xun5.js";import{C as r,a as o}from"./CRow-BgAALhH6.js";import{C as z,a as B}from"./CCardBody-rHsqc536.js";import{C as fe}from"./CCardHeader-CuH1JTgm.js";import{a as i}from"./CButton-RIN6mrQU.js";import{C as ye}from"./CCollapse-Dpa-BuCv.js";import{C as G,a as j,c as h,b as H}from"./CFormInput-Me9koE1O.js";import{C as w}from"./CInputGroup-DH04h0Uy.js";import{C as Ce}from"./CCardFooter-D2NMoMJz.js";import{C as be}from"./CButtonGroup-DtJkK7GH.js";import{C as Se,a as Ne,b as Pe,c as Te,d as ve}from"./CModalTitle-BTuK9VSO.js";import{C as we}from"./CFormCheck-kP3xtMXj.js";import"./DefaultLayout-B5Soh4xG.js";import"./index.esm-Dnt0BHkQ.js";const Ke=()=>{const[I,q]=n.useState([]),[x,S]=n.useState(!1),[u,f]=n.useState(!0),[L,k]=n.useState(!1),[N,Y]=n.useState(!1),[F,_]=n.useState(""),[E,O]=n.useState(!1),[y,M]=n.useState(1),[P,Ie]=n.useState(9),[W,J]=n.useState(0);n.useContext(ne);const C=async()=>{try{const s=E?await T(`/tags/search?query=${F}&page=${y}&limit=${P}`):await T(`/tags/all?page=${y}&limit=${P}`);s.status===200?(q(s.data.data),J(s.data.totalPages),M(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},K=c.object({id:c.string().optional(),name:c.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:c.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:c.preprocess(s=>s==="true"||s===!0,c.boolean()).optional().default(!1),isSystem:c.preprocess(s=>s==="true"||s===!0,c.boolean()).optional().default(!1),description:c.string().optional()}),{register:p,reset:m,handleSubmit:Q,formState:{errors:t}}=D({resolver:R(K)}),V=async s=>{try{const a=I.find(A=>A.name===s.name&&A.category===s.category);if(!x&&a){console.log("Tag already exist");return}console.log(s);const g=x?await ce(`/tags/${s.id}`,s):await oe("/tags",s);g.status===200||g.status===201?(alert(g.data.message),m({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),S(!1),f(!0),C()):console.log(g)}catch{}},X=async s=>{try{S(!0),f(!0);const a=await T(`/tags/${s}`);if(a.status===200){const g={id:a.data.data._id,name:a.data.data.name,category:a.data.data.category,isProtected:a.data.data.isProtected||!1,isSystem:a.data.data.isSystem||!1};m(g)}}catch{}},Z=async s=>{try{if(!confirm("Are you sure you want to delete this tag?"))return;(await ie(`/tags/${s}`)).status===200&&C()}catch{}},ee=()=>{m({id:"",name:"",category:""}),S(!1),f(!0)},se=c.object({searchInput:c.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:te,reset:ke,handleSubmit:ae,formState:{errors:b}}=D({resolver:R(se)}),re=async s=>{try{console.log(s),_(s.searchInput),O(!0),C()}catch(a){console.log(a)}};return n.useEffect(()=>{const s=setTimeout(()=>{C()},300);return()=>clearTimeout(s)},[y,P,E,F]),e.jsxs(v,{className:"d-flex flex-column gap-3",children:[e.jsx(r,{children:e.jsx(v,{children:e.jsxs(z,{children:[e.jsx(fe,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:x?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:x?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[x&&e.jsx(l,{content:"Reset form",placement:"top",children:e.jsx(i,{onClick:()=>ee(),className:"btn btn-danger",children:e.jsx(d,{icon:$})})}),e.jsx(l,{content:u?"Collapse":"Expand",placement:"top",children:e.jsx(i,{onClick:()=>f(!u),className:"btn btn-primary",children:e.jsx(d,{icon:u?me:he})})})]})]})}),e.jsx(ye,{visible:u,children:e.jsx(B,{children:e.jsx(G,{onSubmit:Q(V),children:e.jsxs(v,{className:"d-flex flex-column gap-2",children:[e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(j,{type:"hidden",id:"id",...p("id"),invalid:!!t.id}),t&&t.id&&e.jsx(h,{className:"text-danger",children:t.id.message}),e.jsx(j,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...p("name"),invalid:!!t.name}),t&&t.name&&e.jsx(h,{className:"text-danger",children:t.name.message})]})}),e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(j,{type:"text",id:"category",placeholder:"Category",label:"Category",...p("category"),invalid:!!t.category}),t&&t.category&&e.jsx(h,{className:"text-danger",children:t.category.message})]})}),e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(H,{children:"Protected?"}),e.jsxs(w,{children:[e.jsx(j,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,...p("isProtected"),invalid:!!t.isProtected}),e.jsx(l,{content:"Protect",placement:"top",children:e.jsx(i,{onClick:()=>m({isProtected:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:U})})}),e.jsx(l,{content:"Unprotect",placement:"top",children:e.jsx(i,{onClick:()=>m({isProtected:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:xe})})})]}),t&&t.isProtected&&e.jsx(h,{className:"text-danger",children:t.isProtected.message})]})}),e.jsx(r,{children:e.jsxs(o,{children:[e.jsx(H,{children:"System Tag ?"}),e.jsxs(w,{children:[e.jsx(j,{type:"text",id:"system",placeholder:"...",readOnly:!0,...p("isSystem"),invalid:!!t.isSystem}),e.jsx(l,{content:"Protect",placement:"top",children:e.jsx(i,{onClick:()=>m({isSystem:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:ge})})}),e.jsx(l,{content:"Unprotect",placement:"top",children:e.jsx(i,{onClick:()=>m({isSystem:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:je})})})]}),t&&t.isSystem&&e.jsx(h,{className:"text-danger",children:t.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(i,{color:"primary",type:"submit",className:"mb-3 w-25",children:x?"Update":"Submit"})})]})})})})]})})}),e.jsx(r,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(G,{onSubmit:ae(re),children:[e.jsxs(w,{children:[e.jsx(j,{placeholder:"...",id:"searcInput",...te("searchInput"),invalid:!!b.searchInput}),e.jsx(l,{content:"Search tags",placement:"top",children:e.jsx(i,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:pe})})})]}),b&&b.searchInput&&e.jsx(h,{className:"text-danger",children:b.searchInput.message})]})})]})}),e.jsx(r,{children:I.map((s,a)=>e.jsx(o,{md:4,className:"mb-3",children:e.jsxs(z,{className:"h-100",children:[e.jsxs(B,{children:[e.jsx(r,{children:e.jsxs(o,{children:[e.jsx("h5",{children:le(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(r,{children:e.jsxs(o,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(r,{children:e.jsxs(o,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsxs(Ce,{children:[e.jsx(r,{children:e.jsx(o,{children:e.jsxs(be,{children:[e.jsx(l,{content:"Edit tag",placement:"top",children:e.jsx(i,{color:"primary",onClick:()=>X(s._id),children:e.jsx(d,{icon:ue})})}),e.jsx(l,{content:"Delete tag",placement:"top",children:e.jsx(i,{color:"danger",onClick:()=>k(!0),disabled:s.isProtected,children:e.jsx(d,{icon:s.isProtected?U:$})})})]})})}),e.jsx(r,{children:e.jsx(o,{children:e.jsxs(Se,{visible:L,onClose:()=>k(!1),children:[e.jsx(Ne,{children:e.jsx(Pe,{children:"Warning"})}),e.jsx(Te,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:s.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:s.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs(ve,{children:[e.jsxs(o,{className:"d-flex justify-content-end",children:[e.jsx(we,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:N,onChange:()=>Y(!N)}),e.jsx(h,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(i,{onClick:()=>Z(s._id),disabled:!N,className:"btn btn-danger",children:"Delete"})]})]})})})]})]})},a))}),e.jsx(r,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(de,{currentPage:y,totalPages:W||1,onPageChange:M})})})]})};export{Ke as default};
