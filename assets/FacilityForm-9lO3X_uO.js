import{r as e}from"./react-router-dom-BnDDw25P.js";import{m as i,A as r,j as t,a,g as s,l as o,k as n,y as l,w as d,p as c}from"./index-qHb5tAdx.js";import{z as m}from"./zod-B0zZW6rS.js";import{u as p,b as u}from"./react-hook-form-DB8hWBdy.js";import{s as h}from"./@hookform/resolvers/zod-1wp20Skh.js";import{C as y,a as f,b as v}from"./CModalHeader-beeSvsCt.js";import{C as b}from"./CModalTitle-IUT3VrW5.js";import{C,b as j}from"./CFormLabel-UDpH3Qx3.js";import{C as q,a as g}from"./CRow-DYavEpjv.js";import{C as x}from"./CFormInput-DF5LQCIp.js";import{C as N}from"./CFormTextarea-DP8Q6-6q.js";import{C as T}from"./CInputGroup-C6uD42B3.js";import{C as k}from"./CModalFooter-DRWyebc_.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./DefaultLayout-CPc9-BYb.js";import"./CContainer-B1Ovw4vN.js";import"./index.esm-GVz-2sp-.js";import"./index.es-DYre-5ez.js";import"./isRTL-D5ORmfro.js";const F=m.object({title:m.string().min(1,"Title is required"),description:m.string().optional()}),R=m.object({name:m.string().nonempty("Name is required"),type:m.string().nonempty("Type is required"),description:m.string().nonempty("Description is required"),requirements:m.array(F).optional(),location:m.string().nonempty("Location is required")}),D=({isVisible:c,onClose:m,isEdit:F,facilityData:D})=>{const{addToast:L}=e.useContext(i),{userInformation:w}=e.useContext(r),[E,S]=e.useState(!1),{register:A,control:z,handleSubmit:I,setValue:V,reset:$,formState:{errors:M}}=p({resolver:h(R),defaultValues:D||{requirements:[]}}),{fields:H,append:O,remove:_}=u({control:z,name:"requirements"});return e.useEffect((()=>{c||$(),F&&D&&$({name:null==D?void 0:D.name,type:null==D?void 0:D.type,description:null==D?void 0:D.description,location:null==D?void 0:D.location,requirements:(null==D?void 0:D.requirements)||[]})}),[c,F,D,$]),t(y,{visible:c,onClose:()=>{$(),m()},children:[a(f,{children:a(b,F?{children:"Edit Facility"}:{children:"Add Facility"})}),a(v,{children:t(C,{onSubmit:I((async e=>{try{S(!0);const i={name:e.name,type:e.type,description:e.description,requirements:e.requirements||[],location:e.location},r=F?await l(`/facilities/update/${D._id}`,i):await d("/facilities/create",i);200!==r.status&&201!==r.status||L("Success","Facility Added Successfully","success"),V("name",r.data.data.name),V("type",r.data.data.type),V("description",r.data.data.description),V("requirements",r.data.data.requirements||[]),V("location",r.data.data.location),S(!1),m()}catch(i){L("Error","An Error Occurred","danger")}})),children:[a(q,{className:"mb-3",children:t(g,{children:[a(x,{type:"text",label:"Facility Name",placeholder:"Facility Name",...A("name"),invalid:!!(null==M?void 0:M.name)}),M.name&&a("div",{className:"invalid-feedback",children:M.name.message})]})}),a(q,{className:"mb-3",children:t(g,{children:[a(x,{type:"text",label:"Type",placeholder:"Type",...A("type"),invalid:!!(null==M?void 0:M.type)}),M.type&&a("div",{className:"invalid-feedback",children:M.type.message})]})}),a(q,{className:"mb-3",children:t(g,{children:[a(N,{type:"text",rows:5,label:"Description",placeholder:"Description",...A("description"),invalid:!!(null==M?void 0:M.description)}),M.description&&a("div",{className:"invalid-feedback",children:M.description.message})]})}),a(q,{children:a(g,{children:a(j,{children:"Requirements"})})}),a(q,{className:"mb-3",children:t(g,{className:"d-flex gap-2 flex-column",children:[H.map(((e,i)=>t("div",{className:"d-flex gap-3 flex-column",children:[t("div",{children:[a(j,{children:"Title"}),t(T,{children:[a(x,{type:"text",placeholder:"Title",...A(`requirements.${i}.title`)}),["admin","manager","interviewer"].includes(w.role)&&a(s,{color:"danger",onClick:()=>_(i),children:"Remove"})]})]}),a("div",{children:a(N,{type:"text",label:"Description",placeholder:"Description",...A(`requirements.${i}.description`)})})]},e.id))),["admin","manager","interviewer"].includes(w.role)&&a(s,{color:"success",size:"sm",onClick:()=>O({title:"",description:""}),children:"Add Requirement"})]})}),a(q,{className:"mb-3",children:t(g,{children:[a(x,{type:"text",label:"Location",placeholder:"Location",...A("location"),invalid:!!(null==M?void 0:M.location)}),M.location&&a("div",{className:"invalid-feedback",children:M.location.message})]})}),t(k,{children:["development"===o.env,E?t(s,{color:"primary",type:"submit",disabled:!E,children:[a(n,{size:"sm"})," Loading..."]}):a(s,{color:"primary",type:"submit",children:F?"Update":"Create"})]})]})})]})};D.propTypes={isVisible:c.bool.isRequired,onClose:c.func.isRequired,isEdit:c.bool.isRequired,facilityData:c.object};export{D as default};
