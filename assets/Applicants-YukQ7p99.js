import{p as T,r as a,G as E,k as e,o as ne,g as H,l as oe}from"./index-UTTuAW8U.js";import{F as C,E as le,G as ie,V as ce,f as de,r as he}from"./index.es-BAdYZpO5.js";import{A as me}from"./AppPagination-BLJvdAUp.js";import{z,u as xe,t as ue}from"./zod-BWNvkW38.js";import{C as fe}from"./TimeForm-DJ3Cez3v.js";import{U as je,f as pe}from"./index-DQqLSrbO.js";import{C as ge,a as Ce,b as Se,c as Te}from"./CModalTitle-D4RJQrjF.js";import{C as I}from"./CContainer-C1-PhLTA.js";import{C as d,a as f}from"./CRow-CtyKWugl.js";import{a as O,C as ye,c as be}from"./CFormInput-CYqszj66.js";import{C as ve}from"./CInputGroup-BbQKEH9b.js";import{C as D}from"./CTooltip-CT0N7Q5s.js";import{a as G}from"./DefaultLayout-zyy4DIyJ.js";import{C as we,a as Pe}from"./CCardBody-D2FqdOjE.js";import{C as Fe,a as Ae,b as k,c as S,d as Ne,e as m}from"./CTable-DLxNqTMQ.js";import"./clsx-B-dksMZM.js";import"./CInputGroupText-k37NtXda.js";import"./CModalFooter-wsljN6_3.js";import"./index.esm-D3MO8Nld.js";const X=({isVisible:R,onClose:M,isDarkMode:h,applicantData:o})=>{const[y,j]=a.useState({}),[V,x]=a.useState(!1),[c,p]=a.useState(je(new Date)),[_,b]=a.useState([]);a.useState([]);const[v,U]=a.useState(1),[g,l]=a.useState(10),[$,w]=a.useState(1),P=u=>{p(u)},F=a.useCallback(async u=>{x(!0);try{const r=await E(`/interview/all?date=${u}&page=${v}&limit=${g}`);if(r.status===404){b([]),x(!1);return}console.log(r.data),b(r.data.data),w(r.data.totalPages),x(!1)}catch(r){console.error(r),x(!1)}});return a.useEffect(()=>{F(c)},[c,v,g]),a.useEffect(()=>{o&&j(o)},[o]),e.jsxs(ge,{visible:R,onClose:M,size:"lg",children:[e.jsx(Ce,{children:e.jsx(Se,{children:e.jsxs("div",{children:["Schedule Interview for"," ",e.jsxs("span",{className:"fw-bold",children:[o==null?void 0:o.lastname,", ",o==null?void 0:o.firstname]})]})})}),e.jsx(Te,{children:e.jsxs(I,{children:[e.jsx(d,{className:"mb-3",children:e.jsx(f,{children:e.jsx("div",{children:e.jsx(fe,{onChange:P,defaultValue:c,className:h?"calendar dark-mode":"calendar"})})})}),e.jsx(d,{className:"mb-3",children:e.jsx(f,{children:e.jsx(O,{type:"text",id:"date",name:"date",placeholder:"Date",value:pe(c),readOnly:!0})})}),e.jsx(d,{children:e.jsx(f,{children:e.jsx("strong",{children:"Time Slots"})})})]})})]})};X.propTypes={isVisible:T.bool.isRequired,onClose:T.func.isRequired,isDarkMode:T.bool.isRequired,applicantData:T.object};const De=({theme:R})=>{const M=R==="dark",{addToast:h}=a.useContext(ne),[o,y]=a.useState(!1),[j,V]=a.useState([]),[x,c]=a.useState(!1),[p,_]=a.useState([]),[b,v]=a.useState({}),[U,g]=a.useState(!1),[l,$]=a.useState([]),[w,P]=a.useState(!1),[F,u]=a.useState(""),[r,L]=a.useState(1),[A,ke]=a.useState(9),[J,K]=a.useState(1),q=async(s,t,i)=>{try{c(!0);let n="";l.length>0&&(n=l.map(re=>`${re}`).join(","));const N=w?await E(`/applicant/search?query=${i}&page=${s}&limit=${t}&tags=${n}`):await E("/applicant/all");N.status===200?(console.log(N.data.data),_(N.data.data),K(N.data.totalPages),c(!1)):(h("Error","Failed to fetch data","danger"),c(!1))}catch{h("Error","Failed to fetch data","danger")}},Q=async s=>{try{g(!0);const t=p.find(i=>i._id===s);v(t)}catch{h("Error","Failed to fetch data","danger")}},W=async()=>{try{y(!0);const t=await E("/tags/category/applicant");t.status===200?(V(t.data.data),y(!1)):(h("Error","Failed to fetch data","danger"),y(!1))}catch{h("Error","Failed to fetch data","danger")}},Y=s=>{if(l.includes(s)){const i=l.filter(n=>n!==s);$(i)}else $([...l,s])},Z=z.object({searchTerm:z.string().min(1,"Search term is required")}),{register:ee,handleSubmit:se,formState:{errors:B}}=xe({resolver:async(s,t,i)=>{const n=await ue(Z)(s,t,i);return console.log("Validation result:",n),n}}),ae=s=>{const{searchTerm:t}=s;_([]),u(t),P(!0),L(1),q(r,A,t)},te=()=>{u(""),P(!1),L(1),q(r,A)};return a.useEffect(()=>{W();const s=setTimeout(()=>{q(r,A,F)},300);return()=>clearTimeout(s)},[r,A,w,F]),e.jsx(e.Fragment,{children:e.jsxs(I,{className:"d-flex flex-column gap-3",children:[e.jsx(d,{children:e.jsxs(f,{children:[e.jsx("h2",{children:"Applicants"}),e.jsx("small",{children:"In this page, you can view and edit the list of applicants which are waiting for the HR to schedule an interview or any event they need to attend."})]})}),e.jsx(d,{children:e.jsxs(I,{className:"d-flex flex-column gap-3",children:[e.jsxs(ye,{onSubmit:se(ae),children:[e.jsxs(ve,{children:[e.jsx(O,{type:"text",placeholder:"Search",...ee("searchTerm"),invalid:!!B.searchTerm}),e.jsx(D,{placement:"top",content:"Search",children:e.jsx(H,{type:"submit",color:"primary",children:e.jsx(C,{icon:le})})}),e.jsx(D,{placement:"top",content:"Refresh",children:e.jsx(H,{color:"primary",onClick:()=>te(),children:e.jsx(C,{icon:ie})})})]}),B.searchTerm&&e.jsx(be,{invalid:!0,children:B.searchTerm.message})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:j.map(s=>e.jsx(D,{content:l.includes(s._id)?"Remove":"Add",children:e.jsxs(G,{onClick:()=>Y(s._id),color:l.includes(s._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[s.name,l.includes(s._id)&&e.jsx(C,{icon:ce,className:"ms-2"})]})},s._id))})]})}),e.jsx(d,{children:e.jsx(I,{children:e.jsx(we,{children:e.jsx(Pe,{children:e.jsxs(Fe,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(Ae,{children:e.jsxs(k,{children:[e.jsx(S,{children:e.jsx(C,{icon:de})}),e.jsx(S,{children:"Email"}),e.jsx(S,{children:"Phone"}),e.jsx(S,{children:"Tags"}),e.jsx(S,{children:"Action"})]})}),e.jsx(Ne,{children:x?e.jsx(k,{children:e.jsx(m,{colSpan:5,children:e.jsx("div",{className:"pt-3 text-center",children:e.jsx(oe,{color:"primary",variant:"grow"})})})}):p.length>0?p.map(s=>e.jsxs(k,{children:[e.jsx(m,{children:e.jsxs("div",{children:[s.lastname,", ",s.firstname]})}),e.jsx(m,{children:e.jsx("div",{children:s.email})}),e.jsx(m,{children:e.jsx("div",{children:s.phone})}),e.jsx(m,{children:e.jsx("div",{className:"d-flex gap-2",children:s.tags.map((t,i)=>e.jsx(G,{color:"primary",children:j.find(n=>n._id===t)&&j.find(n=>n._id===t).name},i))})}),e.jsx(m,{children:e.jsx(D,{placement:"top",content:"Schedule Interview for this applicant",children:e.jsx(H,{onClick:()=>Q(s._id),className:"btn btn-primary",size:"sm",children:e.jsx(C,{icon:he})})})})]},s._id)):e.jsx(k,{children:e.jsx(m,{colSpan:5,children:"No data available"})})})]})})})})}),e.jsx(d,{children:e.jsx(f,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(me,{currentPage:r,totalPages:J,onPageChange:L})})})}),e.jsx(d,{children:e.jsx(f,{children:e.jsx(X,{isVisible:U,onClose:()=>g(!1),isDarkMode:M,applicantData:b})})})]})})};De.propTypes={theme:T.string};export{De as default};
