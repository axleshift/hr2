import{q as _,R as r,o as z,k as e,g,l as L,G as P}from"./index-DrjcOHzu.js";import{F as N,E as V,G as Y,O as H}from"./index.es-xVlOGKl_.js";import"./index-AEkgOS_o.js";import{t as b,d as A,f as J}from"./index-wJw5MR4V.js";import{A as M}from"./AppPagination-UhOljCQo.js";import{z as w,u as Q,t as K}from"./zod-BHPmFnPI.js";import{C as U}from"./CContainer-U-6RkYr-.js";import{C as p,a as S}from"./CRow-cwBv8WMd.js";import{C as W,a as X,c as Z}from"./CFormInput-03SL98tc.js";import{C as ee}from"./CInputGroup-BDi0pL70.js";import{C as l}from"./CTooltip-8Xx3ukpY.js";import{C as se,a as te}from"./CCardBody-B4c-rfPr.js";import{C as ae,a as re,b as u,c as n,d as ne,e as t}from"./CTable-DKmfm88j.js";import{a as o}from"./DefaultLayout-CXtOpFYs.js";import{C as ce}from"./CButtonGroup-BzGVwqQh.js";import"./index.esm-yebAidTW.js";const we=()=>{const I=_(),{addToast:v}=r.useContext(z),[y,R]=r.useState([]),[T,d]=r.useState(!1),[i,D]=r.useState(1),[F,$]=r.useState(1),[x,le]=r.useState(10),[oe,h]=r.useState(!1),[f,ie]=r.useState(""),C=async(s="",m,j)=>{d(!0);try{const a=s===""||s===null||s===void 0?await P(`/jobposter/all?page=${m}&limit=${j}`):await P(`/jobposter/all?query=${s}&page=${m}&limit=${j}`);if(a.status===200){console.log("Data:",a.data),R(a.data.data),$(a.data.totalPages),d(!1),h(!1);return}else v("Info",`No data found for '${s}'`,"info"),d(!1),h(!1)}catch(a){v("Danger","Failed to fetch data","Error"),console.error(a),d(!1),h(!1)}},k=w.object({query:w.string().min(3,{message:"Search query must be at least 3 characters"})}),{register:q,reset:de,handleSubmit:B,formState:{error:c}}=Q({resolver:async(s,m,j)=>{const a=await K(k)(s,m,j);return console.log("Validation result:",a),a}}),E=async s=>{h(!0),C(s.query,i,x)},G=()=>{C(f,i,x)},O=s=>{I(`/recruitment/jobposter/${s.ref_id}`)};return r.useEffect(()=>{C(f,i,x)},[f,i,x]),e.jsx(e.Fragment,{children:e.jsxs(U,{children:[e.jsx(p,{className:"mb-3",children:e.jsxs(S,{children:[e.jsx("h1",{children:"Jobpost Tracker"}),e.jsx("small",{className:"text-muted",children:"In this page, you can view all the jobpost tracker data in various platforms."})]})}),e.jsx(p,{className:"mb-3",children:e.jsx(S,{children:e.jsx(W,{onSubmit:B(E),children:e.jsxs(ee,{children:[e.jsx(X,{type:"text",placeholder:"Search...",...q("query"),invalid:!!(c!=null&&c.query)}),(c==null?void 0:c.query)&&e.jsx(Z,{className:"text-danger",children:c.query.message}),e.jsx(l,{content:"Search",placement:"top",children:e.jsx(g,{type:"submit",className:"btn btn-primary",children:e.jsx(N,{icon:V})})}),e.jsx(l,{content:"Refresh",placement:"top",children:e.jsx(g,{onClick:G,className:"btn btn-primary",children:e.jsx(N,{icon:Y})})})]})})})}),e.jsx(p,{children:e.jsx(S,{children:e.jsx(se,{children:e.jsx(te,{children:e.jsxs(ae,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(re,{children:e.jsxs(u,{children:[e.jsx(n,{children:e.jsx("div",{className:"text-center",children:e.jsx("strong",{children:"#"})})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Platform"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Approved"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Posted"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Deleted"})}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Expires At"})}),e.jsx(n,{children:"Content "}),e.jsx(n,{children:e.jsx("div",{className:"text-center",children:"Actions"})})]})}),e.jsx(ne,{children:T?e.jsx(u,{children:e.jsx(t,{colSpan:"8",className:"text-center",children:e.jsx(L,{color:"primary",variant:"grow"})})}):y.length===0?e.jsx(u,{children:e.jsx(t,{colSpan:"8",children:e.jsx("div",{className:"text-center",children:"No data"})})}):y.map(s=>e.jsxs(u,{children:[e.jsx(t,{children:e.jsx(l,{content:s._id,placement:"top",children:e.jsx("div",{className:"text-capitalize text-center",children:b(s._id,2)})})}),e.jsx(t,{children:e.jsx("div",{className:"text-capitalize text-center",children:s.platform})}),e.jsx(t,{className:"text-center",children:s.isApproved?e.jsx(o,{color:"success",children:"YES"}):e.jsx(o,{color:"danger",children:"NO"})}),e.jsx(t,{className:"text-center",children:s.isPosted?e.jsx(o,{color:"success",children:"YES"}):e.jsx(o,{color:"danger",children:"NO"})}),e.jsx(t,{className:"text-center",children:s.isDeleted?e.jsx(o,{color:"danger",children:"YES"}):e.jsx(o,{color:"info",children:"NO"})}),e.jsx(t,{className:"text-center",children:e.jsx(l,{content:A(s.expiresAt)+" days left",placement:"top",children:e.jsx("span",{className:A(s.expiresAt)>0?"text-info":"text-danger",children:J(s.expiresAt)})})}),e.jsx(t,{children:e.jsx(l,{content:b(s.content,100),placement:"top",children:e.jsx("small",{children:b(s.content,50)})})}),e.jsx(t,{className:"text-center",children:e.jsx(ce,{children:e.jsx(l,{content:"View",placement:"top",children:e.jsx(g,{color:"info",onClick:()=>O(s),children:e.jsx(N,{icon:H})})})})})]},s._id))})]})})})})}),e.jsx(p,{children:e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(M,{currentPage:i,totalPages:F,onPageChange:D})})})]})})};export{we as default};
