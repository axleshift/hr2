import{r as e}from"./react-router-dom-BnDDw25P.js";import{z as t}from"./zod-B0zZW6rS.js";import{u as a}from"./react-hook-form-DB8hWBdy.js";import{s as r}from"./@hookform/resolvers/zod-1wp20Skh.js";import{m as s,A as n,j as i,a as c,g as o,k as d,w as l,x as m,v as h,y as g}from"./index-CcMoZ86M.js";import{A as u}from"./AppPagination-DKVbBTy2.js";import{F as p,M as y,J as f,K as C,u as b,a2 as x,A as S,H as j}from"./index.es-bvOFjCBQ.js";import{C as N}from"./CContainer-CXw2kXtD.js";import{C as v,a as w}from"./CRow-Bcopbwr-.js";import{C as P,a as T}from"./CCardBody-NXgyA15G.js";import{C as k}from"./CCardHeader-C6GIS5ko.js";import{C as I}from"./CTooltip-DPwsLnsN.js";import{C as A}from"./CCollapse-nOmryMfg.js";import{C as E,a as z,b as $}from"./CFormLabel-Cn49qeSD.js";import{C as F}from"./CFormInput-DqSYQ0H6.js";import{C as M}from"./CInputGroup-CE3U5zA5.js";import{C as D}from"./CButtonGroup-CLoG-eYt.js";import{C as _,a as H,b as L}from"./CModalHeader-_Q4P1NwJ.js";import{C as R}from"./CModalTitle-CUSi6tVS.js";import{C as V}from"./CModalFooter-CD7E3XOU.js";import{C as Y}from"./CFormCheck-Yt3tueCj.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./isRTL-D5ORmfro.js";import"./getTransitionDurationFromElement-2nBpLMKS.js";import"./DefaultLayout-f6fgnM5a.js";import"./index.esm-5D08hL8w.js";const q=()=>{const{addToast:q}=e.useContext(s),[G,J]=e.useState([]),[O,U]=e.useState(!1),[W,B]=e.useState({}),[K,Q]=e.useState(!1),[Z,X]=e.useState(!0),[ee,te]=e.useState(!1),[ae,re]=e.useState(!1),[se,ne]=e.useState(!1),[ie,ce]=e.useState(""),[oe,de]=e.useState(!1),[le,me]=e.useState(1),[he,ge]=e.useState(9),[ue,pe]=e.useState(0),{userInformation:ye}=e.useContext(n),fe=async()=>{try{U(!0);const e=oe?await l(`/tags/search?query=${ie}&page=${le}&limit=${he}`):await l(`/tags/all?page=${le}&limit=${he}`);200===e.status?(J(e.data.data),pe(e.data.totalPages),me(e.data.currentPage),U(!1),q("Success","Tags are successfully retrieved","success")):(U(!1),q("Error","An error occurred while fetching the tags","danger"))}catch(e){U(!1),q("Error","An error occurred while fetching the tags","danger")}},Ce=t.object({id:t.string().optional(),name:t.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:t.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),isSystem:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),description:t.string().optional()}),{register:be,reset:xe,watch:Se,handleSubmit:je,formState:{errors:Ne,defaultValues:ve}}=a({resolver:r(Ce)});Se("isProtected");const we=Se("isSystem"),Pe=t.object({searchInput:t.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:Te,reset:ke,handleSubmit:Ie,formState:{errors:Ae}}=a({resolver:r(Pe)});return e.useEffect((()=>{const e=setTimeout((()=>{fe()}),300);return()=>clearTimeout(e)}),[le,he,oe,ie]),i(N,{className:"d-flex flex-column gap-3",children:[c(v,{children:c(N,{children:i(P,{children:[c(k,{children:i("div",{className:"d-flex justify-content-between align-items-center",children:[i("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[c("strong",{children:"Jobposting Form"}),c("span",{className:K?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:K?"Edit Mode":"Create Mode"})]}),i("div",{className:"d-flex flex-row gap-2",children:[K&&c(I,{content:"Reset form",placement:"top",children:c(o,{onClick:()=>(xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),void X(!0)),className:"btn btn-danger",children:c(p,{icon:y})})}),c(I,{content:Z?"Collapse":"Expand",placement:"top",children:c(o,{onClick:()=>X(!Z),className:"btn btn-primary",children:c(p,{icon:Z?f:C})})})]})]})}),c(A,{visible:Z,children:c(T,{children:c(E,{onSubmit:je((async e=>{try{const t=G.find((t=>t.name===e.name&&t.category===e.category));if(!K&&t)return;const a=K?await m(`/tags/${e.id}`,e):await h("/tags",e);200===a.status||201===a.status?(q("Success",K?"Tag is successfully updated":"Tag is successfully added","success"),xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),X(!0),fe()):q("Error","An error occurred while adding the tag","danger")}catch(t){q("Error","An error occurred while adding the tag","danger")}})),children:i(N,{className:"d-flex flex-column gap-2",children:[c(v,{children:i(w,{children:[c(F,{type:"hidden",id:"id",...be("id"),invalid:!!Ne.id}),Ne&&Ne.id&&c(z,{className:"text-danger",children:Ne.id.message}),c(F,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...be("name"),invalid:!!Ne.name}),Ne&&Ne.name&&c(z,{className:"text-danger",children:Ne.name.message})]})}),c(v,{children:i(w,{children:[c(F,{type:"text",id:"category",placeholder:"Category",label:"Category",...be("category"),invalid:!!Ne.category}),Ne&&Ne.category&&c(z,{className:"text-danger",children:Ne.category.message})]})}),c(v,{children:i(w,{children:[c($,{children:"Protected?"}),i(M,{children:[c(F,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...be("isProtected"),invalid:!!Ne.isProtected}),c(I,{content:"Protect",placement:"top",children:c(o,{onClick:()=>xe({isProtected:!0}),color:"primary",children:c(p,{icon:b})})}),c(I,{content:"Unprotect",placement:"top",children:c(o,{onClick:()=>xe({isProtected:!1}),color:"warning",children:c(p,{icon:x})})})]}),Ne&&Ne.isProtected&&c(z,{className:"text-danger",children:Ne.isProtected.message})]})}),c(v,{className:"mb-3",children:i(w,{children:[c($,{children:"System Tag ?"}),i(M,{children:[c(F,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:we,...be("isSystem"),invalid:!!Ne.isSystem}),c(I,{content:"Protect",placement:"top",children:c(o,{onClick:()=>xe({isSystem:!0}),color:"primary",children:c(p,{icon:b})})}),c(I,{content:"Unprotect",placement:"top",children:c(o,{onClick:()=>xe({isSystem:!1}),color:"secondary",children:c(p,{icon:x})})})]}),Ne&&Ne.isSystem&&c(z,{className:"text-danger",children:Ne.isSystem.message})]})}),c("div",{className:"d-flex justify-content-end",children:c(o,{color:"primary",type:"submit",children:K?"Update":"Submit"})})]})})})})]})})}),c(v,{children:i("div",{className:"d-flex justify-content-between",children:[c("div",{className:"d-flex justify-content-between align-items-center",children:c("h1",{children:"All Tags"})}),c("div",{children:i(E,{onSubmit:Ie((async e=>{try{ce(e.searchInput),de(!0),fe()}catch(t){}})),children:[i(M,{children:[c(F,{placeholder:"...",id:"searcInput",...Te("searchInput"),invalid:!!Ae.searchInput}),c(I,{content:"Search tags",placement:"top",children:c(o,{type:"submit",color:"primary",size:"sm",children:c(p,{icon:S})})})]}),Ae&&Ae.searchInput&&c(z,{className:"text-danger",children:Ae.searchInput.message})]})})]})}),c(v,{children:O?c("div",{className:"pt-3 text-center",children:c(d,{color:"primary",variant:"grow"})}):G.map(((e,t)=>c(w,{md:4,className:"mb-3",children:c(P,{className:"h-100",children:i(T,{children:[c(v,{className:"mb-3",children:i(w,{children:[c("h5",{className:"text-capitalize",children:e.name}),c("small",{className:"text-muted",children:e.category})]})}),c(v,{children:i(w,{children:[c("small",{children:"Protected:"})," ",c("small",{children:e.isProtected?"Yes":"No"}),c("br",{}),c("small",{children:"System:"})," ",c("small",{children:e.isSystem?"Yes":"No"})]})}),c(v,{children:c(w,{className:"d-flex justify-content-end",children:i(D,{children:[c(I,{content:"Edit tag",placement:"top",children:c(o,{color:"primary",size:"sm",onClick:()=>(async e=>{try{Q(!0),X(!0);const t=await l(`/tags/${e}`);if(200===t.status){const e={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};xe(e),q("Success","Tag is successfully retrieved","success")}}catch(t){q("Error","An error occurred while fetching the tag","danger")}})(e._id),children:c(p,{icon:j})})}),c(I,{content:"Delete tag",placement:"top",children:c(o,{color:"danger",size:"sm",onClick:()=>(e=>{const t=G.find((t=>t._id===e));B(t),te(!0)})(e._id),disabled:e.isProtected,children:c(p,{icon:e.isProtected?b:y})})})]})})})]})})},t)))}),c(v,{children:c(w,{children:i(_,{visible:ee,onClose:()=>te(!1),children:[c(H,{children:c(R,{className:"text-danger",children:"Warning"})}),c(L,{children:i("div",{children:[c("p",{children:"Are you sure you want to delete this tag?"}),i("p",{children:["Name: ",c("strong",{children:W.name}),c("br",{}),"Category: ",c("strong",{children:W.category})]}),i("p",{children:[c("strong",{children:"Note:"})," This action cannot be undone."]}),c("p",{children:"There's no way to recover the tag once it's deleted."}),c("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),c("p",{children:c("strong",{children:"What this action does:"})}),c("p",{children:"It removes the tag from the system and removes the tag from any content."}),c("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),i(V,{children:[i(w,{className:"d-flex justify-content-end",children:[c(Y,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:ae,onChange:()=>re(!ae)}),c(z,{invalid:!0,children:"You must agree before submitting."})]}),c(o,{onClick:()=>(async e=>{try{ne(!0);const t=await g(`/tags/${e}`);200===t.status?(q("Success","Tag has been deleted successfully","success"),fe(),te(!1)):(q("Error",t.message.message,"danger"),ne(!1))}catch(t){q("Error","An error occurred while deleting the tag","danger"),ne(!1)}})(W._id),disabled:!ae,size:"sm",children:se?c(d,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),c(v,{children:c("div",{className:"d-flex justify-content-center",children:c(u,{currentPage:le,totalPages:ue||1,onPageChange:me})})})]})};export{q as default};
