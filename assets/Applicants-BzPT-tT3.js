import{p as S,r as a,G as k,k as e,o as ne,g as H,l as oe}from"./index-BHhXFTpT.js";import{F as p,s as le,p as ce,H as ie,f as de,I as me}from"./index.es-1HsAF_2m.js";import{A as he}from"./AppPagination-DAbLINZA.js";import{z,u as xe,C as D,t as ue}from"./zod-bsdIf8UL.js";import{C as fe}from"./TimeForm-BHkljfoi.js";import{U as je,a as ge}from"./index-BAMQJqXZ.js";import{C as pe,a as Ce,b as Se,c as Te}from"./CModalTitle-pXG5y8oH.js";import{C as I}from"./CContainer-Ckh7DILw.js";import{C as h,a as T}from"./CRow-DPHhf0KO.js";import{a as O,C as ye,c as be}from"./CFormInput-75QpXbeP.js";import{C as ve}from"./CInputGroup-mfxy4iHe.js";import{a as G}from"./DefaultLayout-B876mhfk.js";import{C as Pe,a as we}from"./CCardBody-ChGd257n.js";import{C as Fe,a as Ae,b as M,c as C,d as Ne,e as m}from"./CTable-L0p9goUu.js";import"./clsx-B-dksMZM.js";import"./CInputGroupText-D2c4K8W8.js";import"./index.esm-ChwMT21S.js";const X=({isVisible:E,onClose:R,isDarkMode:d,applicantData:o})=>{const[y,f]=a.useState({}),[U,x]=a.useState(!1),[i,j]=a.useState(je(new Date)),[_,b]=a.useState([]);a.useState([]);const[v,V]=a.useState(1),[g,l]=a.useState(10),[$,P]=a.useState(1),w=u=>{j(u)},F=a.useCallback(async u=>{x(!0);try{const r=await k(`/interview/all?date=${u}&page=${v}&limit=${g}`);if(r.status===404){b([]),x(!1);return}console.log(r.data),b(r.data.data),P(r.data.totalPages),x(!1)}catch(r){console.error(r),x(!1)}});return a.useEffect(()=>{F(i)},[i,v,g]),a.useEffect(()=>{o&&f(o)},[o]),e.jsxs(pe,{visible:E,onClose:R,size:"lg",children:[e.jsx(Ce,{children:e.jsx(Se,{children:e.jsxs("div",{children:["Schedule Interview for"," ",e.jsxs("span",{className:"fw-bold",children:[o==null?void 0:o.lastname,", ",o==null?void 0:o.firstname]})]})})}),e.jsx(Te,{children:e.jsxs(I,{children:[e.jsx(h,{className:"mb-3",children:e.jsx(T,{children:e.jsx("div",{children:e.jsx(fe,{onChange:w,defaultValue:i,className:d?"calendar dark-mode":"calendar"})})})}),e.jsx(h,{className:"mb-3",children:e.jsx(T,{children:e.jsx(O,{type:"text",id:"date",name:"date",placeholder:"Date",value:ge(i),readOnly:!0})})}),e.jsx(h,{children:e.jsx(T,{children:e.jsx("strong",{children:"Time Slots"})})})]})})]})};X.propTypes={isVisible:S.bool.isRequired,onClose:S.func.isRequired,isDarkMode:S.bool.isRequired,applicantData:S.object};const De=({theme:E})=>{const R=E==="dark",{addToast:d}=a.useContext(ne),[o,y]=a.useState(!1),[f,U]=a.useState([]),[x,i]=a.useState(!1),[j,_]=a.useState([]),[b,v]=a.useState({}),[V,g]=a.useState(!1),[l,$]=a.useState([]),[P,w]=a.useState(!1),[F,u]=a.useState(""),[r,L]=a.useState(1),[A,Me]=a.useState(9),[J,K]=a.useState(1),q=async(s,t,c)=>{try{i(!0);let n="";l.length>0&&(n=l.map(re=>`${re}`).join(","));const N=P?await k(`/applicant/search?query=${c}&page=${s}&limit=${t}&tags=${n}`):await k("/applicant/all");N.status===200?(console.log(N.data.data),_(N.data.data),K(N.data.totalPages),i(!1)):(d("Error","Failed to fetch data","danger"),i(!1))}catch{d("Error","Failed to fetch data","danger")}},Q=async s=>{try{g(!0);const t=j.find(c=>c._id===s);v(t)}catch{d("Error","Failed to fetch data","danger")}},W=async()=>{try{y(!0);const t=await k("/tags/category/applicant");t.status===200?(U(t.data.data),y(!1)):(d("Error","Failed to fetch data","danger"),y(!1))}catch{d("Error","Failed to fetch data","danger")}},Y=s=>{if(l.includes(s)){const c=l.filter(n=>n!==s);$(c)}else $([...l,s])},Z=z.object({searchTerm:z.string().min(1,"Search term is required")}),{register:ee,handleSubmit:se,formState:{errors:B}}=xe({resolver:async(s,t,c)=>{const n=await ue(Z)(s,t,c);return console.log("Validation result:",n),n}}),ae=s=>{const{searchTerm:t}=s;_([]),u(t),w(!0),L(1),q(r,A,t)},te=()=>{u(""),w(!1),L(1),q(r,A)};return a.useEffect(()=>{W();const s=setTimeout(()=>{q(r,A,F)},300);return()=>clearTimeout(s)},[r,A,P,F]),e.jsx(e.Fragment,{children:e.jsxs(I,{className:"d-flex flex-column gap-3",children:[e.jsx(h,{children:e.jsxs(I,{className:"d-flex flex-column gap-3",children:[e.jsxs(ye,{onSubmit:se(ae),children:[e.jsxs(ve,{children:[e.jsx(O,{type:"text",placeholder:"Search",...ee("searchTerm"),invalid:!!B.searchTerm}),e.jsx(D,{placement:"top",content:"Search",children:e.jsx(H,{type:"submit",color:"primary",children:e.jsx(p,{icon:le})})}),e.jsx(D,{placement:"top",content:"Refresh",children:e.jsx(H,{color:"primary",onClick:()=>te(),children:e.jsx(p,{icon:ce})})})]}),B.searchTerm&&e.jsx(be,{invalid:!0,children:B.searchTerm.message})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:f.map(s=>e.jsx(D,{content:l.includes(s._id)?"Remove":"Add",children:e.jsxs(G,{onClick:()=>Y(s._id),color:l.includes(s._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[s.name,l.includes(s._id)&&e.jsx(p,{icon:ie,className:"ms-2"})]})},s._id))})]})}),e.jsx(h,{children:e.jsx(I,{children:e.jsx(Pe,{children:e.jsx(we,{children:e.jsxs(Fe,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(Ae,{children:e.jsxs(M,{children:[e.jsx(C,{children:e.jsx(p,{icon:de})}),e.jsx(C,{children:"Email"}),e.jsx(C,{children:"Phone"}),e.jsx(C,{children:"Tags"}),e.jsx(C,{children:"Action"})]})}),e.jsx(Ne,{children:x?e.jsx(M,{children:e.jsx(m,{colSpan:5,children:e.jsx("div",{className:"pt-3 text-center",children:e.jsx(oe,{color:"primary",variant:"grow"})})})}):j.length>0?j.map(s=>e.jsxs(M,{children:[e.jsx(m,{children:e.jsxs("div",{children:[s.lastname,", ",s.firstname]})}),e.jsx(m,{children:e.jsx("div",{children:s.email})}),e.jsx(m,{children:e.jsx("div",{children:s.phone})}),e.jsx(m,{children:e.jsx("div",{className:"d-flex gap-2",children:s.tags.map((t,c)=>e.jsx(G,{color:"primary",children:f.find(n=>n._id===t)&&f.find(n=>n._id===t).name},c))})}),e.jsx(m,{children:e.jsx(D,{placement:"top",content:"Schedule Interview for this applicant",children:e.jsx(H,{onClick:()=>Q(s._id),className:"btn btn-primary",size:"sm",children:e.jsx(p,{icon:me})})})})]},s._id)):e.jsx(M,{children:e.jsx(m,{colSpan:5,children:"No data available"})})})]})})})})}),e.jsx(h,{children:e.jsx(T,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(he,{currentPage:r,totalPages:J,onPageChange:L})})})}),e.jsx(h,{children:e.jsx(T,{children:e.jsx(X,{isVisible:V,onClose:()=>g(!1),isDarkMode:R,applicantData:b})})})]})})};De.propTypes={theme:S.string};export{De as default};
