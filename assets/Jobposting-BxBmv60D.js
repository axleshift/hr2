import{r,o as je,k as e,g as x,l as me,E as fe,F as xe,G as w}from"./index-UTTuAW8U.js";import{z as n,u as A,t as $}from"./zod-BWNvkW38.js";import{F as d,D as he,E as ue,G as ge,H,I as V,J as G,K as z}from"./index.es-BAdYZpO5.js";import{A as be}from"./AppPagination-BLJvdAUp.js";import{f,a as C,t as K}from"./index-DQqLSrbO.js";import{C as U}from"./CContainer-C1-PhLTA.js";import{C as i,a as j}from"./CRow-CtyKWugl.js";import{C as ye,a as Se,b as ve,c as Ce}from"./CModalTitle-D4RJQrjF.js";import{C as Y,a as m,b as p,c as o}from"./CFormInput-CYqszj66.js";import{C as M}from"./CFormTextarea-B0dRZNEj.js";import{C as Ne}from"./CFormCheck-C0VRvDZN.js";import{C as T}from"./CTooltip-CT0N7Q5s.js";import{C as De}from"./CInputGroup-BbQKEH9b.js";import{C as we,a as Me}from"./CCardBody-D2FqdOjE.js";import{C as Te}from"./CCardHeader-CtbzJgW6.js";import{C as Ee}from"./CCardFooter-6C2m62RE.js";import"./DefaultLayout-zyy4DIyJ.js";import"./index.esm-D3MO8Nld.js";const Xe=()=>{const{addToast:h}=r.useContext(je),[E,g]=r.useState(!1),[F,O]=r.useState(!1),[b,_]=r.useState(!1),[q,Fe]=r.useState("active"),[I,Q]=r.useState([]);r.useState([]);const[W,u]=r.useState(!1),[J,y]=r.useState(!1),[R,P]=r.useState(""),[N,L]=r.useState(1),[S,_e]=r.useState(9),[X,Z]=r.useState(1),[ee,qe]=r.useState("grid"),B=new Date(new Date().setDate(new Date().getDate()+1)),se=new Date(new Date().setDate(new Date().getDate()-1)),te=n.object({jpf_id:n.string().optional(),jpfTitle:n.string().min(1,{message:"Job Title is required"}),jpfType:n.string().min(1,{message:"Job Type is required"}),jpfDesc:n.string().min(1,{message:"Job Description is required"}),jpfSalaryMin:n.number().min(1,{message:"Minimum Salary is required"}).default(0),jpfSalaryMax:n.number().min(1,{message:"Maximum Salary is required"}).default(1),jpfLoc:n.string().min(1,{message:"Location is required"}),jpfBnft:n.string().min(1,{message:"Benefit is required"}),jpfReq:n.string().min(1,{message:"Requirement is required"}),jpfSchedStart:n.preprocess(s=>new Date(s),n.date().min(se,{message:"Start Date must be today or later"})),jpfSchedEnd:n.preprocess(s=>new Date(s),n.date().min(new Date,{message:"End Date must be in the future"})),jpfStatus:n.string().optional()}).refine(s=>s.jpfSchedEnd>s.jpfSchedStart,{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}).refine(s=>s.jpfSalaryMin<s.jpfSalaryMax,{message:"Minimum Salary must be less than Maximum Salary",path:["jpfSalaryMax"]}),{register:c,reset:D,handleSubmit:ae,formState:{errors:t}}=A({resolver:$(te)}),ie=async s=>{try{const a={title:s.jpfTitle||"none",type:s.jpfType||"none",salary_min:s.jpfSalaryMin||0,salary_max:s.jpfSalaryMax||1,location:s.jpfLoc||"none",description:s.jpfDesc||"none",requirements:s.jpfReq||"none",responsibilities:s.jpfResp||"none",benefits:s.jpfBnft||"none",schedule_start:s.jpfSchedStart,schedule_end:s.jpfSchedEnd,status:s.jpfStatus||"inactive"},l=b?await fe(`/jobposting/${s.jpf_id}`,a):await xe("/jobposting",a);l.status===201&&(h("Jobposting",l.data.message,"success"),v(1),D())}catch(a){console.log(a),h("Jobposting","Error creating jobposting","danger")}},k=async s=>{try{const a=await w(`/jobposting/${s}`);if(a.status===200){h("Jobposting",`Jobposting for ${s} retrieved`,"success"),_(!0),g(!0);const l={jpf_id:a.data.data._id,jpfTitle:a.data.data.title,jpfType:a.data.data.type,jpfDesc:a.data.data.description,jpfSalaryMin:a.data.data.salary_min,jpfSalaryMax:a.data.data.salary_max,jpfLoc:a.data.data.location,jpfBnft:a.data.data.benefits,jpfReq:a.data.data.requirements,jpfSchedStart:f(a.data.data.schedule_start),jpfSchedEnd:f(a.data.data.schedule_end),jpfStatus:a.data.status};D(l),window.scrollTo(0,0)}else h("Jobposting","Error getting jobposting","danger")}catch(a){console.log(a),h("Jobposting","Error getting jobposting","danger")}},ne=()=>{_(!1),g(!1),D({jpf_id:"",jpfTitle:"",jpfType:"",jpfDesc:"",jpfSalaryMin:0,jpfSalaryMax:1,jpfLoc:"",jpfBnft:"",jpfReq:"",jpfSchedStart:new Date,jpfSchedEnd:new Date,jpfStatus:"active"})},re=s=>{O(s.target.checked)},v=async(s,a)=>{try{u(!0);const l=J?await w(`/jobposting/search?query=${R}&page=${s}&limit=${a}`):await w(`/jobposting?page=${s}&limit=${a}`);l.status===200||l.status===201?(Q(l.data.data),L(l.data.currentPage),Z(l.data.totalPages),u(!1)):(h("Jobposting","Error getting jobposting","danger"),console.log("Error: ",l.data),u(!1),y(!1))}catch(l){console.log(l)}},le=n.object({jpSearchInput:n.string().min(1,{message:"Search query is required"})}),{register:ce,handleSubmit:de,formState:{searchError:Ie}}=A({resolver:$(le)}),oe=async s=>{try{y(!0),u(!0),P(s.jpSearchInput),v(1,S)}catch(a){console.log(a),u(!1),y(!1)}},pe=()=>{y(!1),P(""),v(1,S)};return r.useEffect(()=>{const s=setTimeout(()=>{v(N,S)},500);return()=>clearTimeout(s)},[N,S,J,R]),e.jsx(e.Fragment,{children:e.jsxs(U,{children:[e.jsx(i,{children:e.jsxs(j,{children:[e.jsx("h1",{children:"Job Postings"}),e.jsx("small",{className:"text-muted",children:"In this page, you can view all the job posting data, create new job postings, and edit existing job postings."})]})}),e.jsx(i,{children:e.jsx(j,{className:"d-flex justify-content-end",children:e.jsx("div",{children:e.jsx(x,{type:"button",onClick:()=>g(!E),className:"btn btn-primary w-30",children:"Create"})})})}),e.jsx(i,{className:"mb-3",children:e.jsx(j,{children:e.jsxs(ye,{visible:E,size:"lg",onClose:()=>{g(!1),ne()},children:[e.jsx(Se,{children:e.jsx(ve,{children:e.jsxs("div",{children:[b?"Edit Job Posting":"Create Job Posting",e.jsx("span",{className:q==="active"?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:q==="active"?"Active":"Inactive"})]})})}),e.jsx(Ce,{children:e.jsxs(Y,{onSubmit:ae(ie),children:[e.jsx(i,{className:"visually-hidden",children:e.jsx("div",{children:e.jsx(m,{type:"text",id:"jpf_id",...c("jpf_id")})})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfTitle",children:"Job Title"}),e.jsx(m,{type:"text",id:"jpfTitle",placeholder:"e.g. Software Engineer",...c("jpfTitle"),invalid:!!t.jpfTitle}),t.jpfTitle&&e.jsx(o,{invalid:!0,children:t.jpfTitle.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfType",children:"Job Type"}),e.jsx(m,{type:"text",id:"jpfType",placeholder:"e.g. Full-time",...c("jpfType"),invalid:!!t.jpfType}),t.jpfType&&e.jsx(o,{invalid:!0,children:t.jpfType.message})]})}),e.jsx(i,{children:e.jsx("strong",{children:"Salary"})}),e.jsxs(i,{children:[e.jsx(j,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSalaryMin",children:"Minimum"}),e.jsx(m,{type:"number",id:"jpfSalaryMin",placeholder:"0",...c("jpfSalaryMin",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMin}),t.jpfSalaryMin&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMin.message})]})}),e.jsx(j,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSalaryMax",children:"Maximum"}),e.jsx(m,{type:"number",id:"jpfSalaryMax",placeholder:"1",...c("jpfSalaryMax",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMax}),t.jpfSalaryMax&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMax.message})]})})]}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfLoc",children:"Location"}),e.jsx(m,{type:"text",id:"jpfLoc",placeholder:"e.g. Manila",...c("jpfLoc"),invalid:!!t.jpfLoc}),t.jpfLoc&&e.jsx(o,{invalid:!0,children:t.jpfLoc.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfDesc",children:"Description"}),e.jsx(M,{id:"jpfDesc",placeholder:"e.g. Job description details...",...c("jpfDesc"),invalid:!!t.jpfDesc,className:"scalableCFormTextArea-200"}),t.jpfDesc&&e.jsx(o,{invalid:!0,children:t.jpfDesc.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfBnft",children:"Benefits"}),e.jsx(M,{id:"jpfBnft",placeholder:"e.g. Dental Care",...c("jpfBnft"),invalid:!!t.jpfBnft,className:"scalableCFormTextArea-200"}),t.jpfBnft&&e.jsx(o,{invalid:!0,children:t.jpfBnft.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfReq",children:"Requirements"}),e.jsx(M,{id:"jpfReq",placeholder:"e.g. Identification Documents",...c("jpfReq"),invalid:!!t.jpfReq,className:"scalableCFormTextArea-200"}),t.jpfReq&&e.jsx(o,{invalid:!0,children:t.jpfReq.message})]})}),e.jsxs(i,{children:[e.jsx("strong",{children:"Deployment Schedule"}),e.jsx("p",{className:"text-muted small",children:"These parameters determine the duration of the job posting."})]}),e.jsxs(i,{children:[e.jsx(j,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSchedStart",children:"Start"}),e.jsx(m,{type:"date",id:"jpfSchedStart",defaultValue:f(B),...c("jpfSchedStart"),invalid:!!t.jpfSchedStart}),t.jpfSchedStart&&e.jsx(o,{invalid:!0,children:t.jpfSchedStart.message})]})}),e.jsx(j,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSchedEnd",children:"Expire"}),e.jsx(m,{type:"date",id:"jpfSchedEnd",defaultValue:f(B),...c("jpfSchedEnd"),invalid:!!t.jpfSchedEnd}),t.jpfSchedEnd&&e.jsx(o,{invalid:!0,children:t.jpfSchedEnd.message})]})})]}),e.jsx("hr",{}),e.jsx(i,{children:e.jsxs("div",{className:"ml-5 mb-3 d-flex justify-content-end",children:[e.jsx(Ne,{type:"checkbox",id:"invalidCheck",label:"I've reviewed the job posting and checked that all is correct. ",checked:F,onChange:re}),e.jsx(o,{invalid:!0,children:"You must agree before submitting."})]})}),e.jsx(i,{children:e.jsxs(j,{className:"d-flex flex-row gap-2 justify-content-end",children:[e.jsx("div",{children:b&&e.jsx(T,{content:"Print (unavailable)",placement:"top",children:e.jsx(x,{type:"button",className:"btn btn-info w-30",children:e.jsx(d,{icon:he})})})}),e.jsx("div",{children:e.jsx(x,{color:"primary",type:"submit",disabled:!F,children:b?"Update":"Add"})})]})})]})})]})})}),e.jsx(i,{className:"d-flex mb-3 ustify-content-between align-items-center",children:e.jsx(U,{children:e.jsx(Y,{onSubmit:de(oe),className:"d-flex flex-row gap-2 justify-content-end align-items-center",children:e.jsxs(De,{children:[e.jsx(m,{type:"text",id:"jpSearchInput",placeholder:"...",...ce("jpSearchInput"),invalid:!!t.jpSearchInput}),e.jsx(T,{content:"Search",placement:"top",children:e.jsx(x,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:ue})})}),e.jsx(T,{content:"Reset",placement:"top",children:e.jsx(x,{onClick:()=>pe(),type:"button",className:"btn btn-primary",children:e.jsx(d,{icon:ge})})})]})})})}),e.jsxs(i,{children:[W?e.jsx("div",{className:"pt-3 text-center",children:e.jsx(me,{color:"primary",variant:"grow"})}):e.jsx("div",{children:ee==="grid"?e.jsx(i,{xs:{cols:1},md:{cols:3},className:"g-3",children:I.map(s=>s?e.jsx(j,{children:e.jsxs(we,{className:"mb-3 h-100",children:[e.jsx(Te,{className:"fw-bold text-uppercase text-primary",children:e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]})}),e.jsx(Me,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-between",children:[e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(d,{icon:H}),e.jsx("p",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(d,{icon:V}),e.jsxs("p",{children:[f(s.schedule_start)," -"," ",f(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(d,{icon:G}),e.jsxs("p",{children:[C(s.salary_min)," -"," ",C(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:K(s.description,150)})]})]})}),e.jsx(Ee,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(x,{onClick:()=>k(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(d,{icon:z}),"Edit"]})})})]})},s._id):e.jsx("div",{children:"Loading"},Math.random()))}):e.jsx("ul",{className:"list-group list-group-flush",children:I.map(s=>s?e.jsxs("li",{className:"list-group-item",children:[e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-bg-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]}),e.jsxs("div",{children:[e.jsx(d,{icon:H,className:"me-2"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{children:[e.jsx(d,{icon:V,className:"me-2"}),e.jsxs("span",{children:[f(s.schedule_start)," - ",f(s.schedule_end)]})]}),e.jsxs("div",{children:[e.jsx(d,{icon:G,className:"me-2"}),e.jsxs("span",{children:[C(s.salary_min)," - ",C(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:K(s.description,150)})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(x,{onClick:()=>k(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(d,{icon:z}),"Edit"]})})})]},s._id):null)})}),e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(be,{currentPage:N,totalPages:X,onPageChange:L})})]})]})})};export{Xe as default};
