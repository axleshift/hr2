import{r as e}from"./react-router-dom-BnDDw25P.js";import{m as a,a as t,F as i,j as s,g as r,k as n,w as l,x as d,v as c}from"./index-idxjfpO7.js";import{z as o}from"./zod-B0zZW6rS.js";import{u as m}from"./react-hook-form-DB8hWBdy.js";import{s as p}from"./@hookform/resolvers/zod-1wp20Skh.js";import{F as h,z as f,A as j,B as u,C as g,D as S,E as y,G as b,H as v,I as x}from"./index.es-CQWNrdDz.js";import{A as N}from"./AppPagination-C6YUkUGB.js";import{f as M,a as C,t as D}from"./index-DCO1bnrX.js";import{C as T}from"./CContainer-HvLLCUu_.js";import{C as w,a as _}from"./CRow-DEvZ4-I-.js";import{C as q,a as E,b as F}from"./CModalHeader-CdUpBEI3.js";import{C as I}from"./CModalTitle-Ccg3gLsQ.js";import{C as L,b as Y,a as J}from"./CFormLabel-DfytgIE9.js";import{C as R}from"./CFormInput-DlBYdvLv.js";import{C as z}from"./CFormTextarea-DTox_qbu.js";import{C as k}from"./CFormCheck-ClI9EWhj.js";import{C as B}from"./CTooltip-BYrF9prw.js";import{C as A}from"./CInputGroup-D6uFn-TN.js";import{C as P,a as $}from"./CCardBody-BkAZIxub.js";import{C as O,a as G}from"./CListGroupItem-Cj1-qjE1.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./DefaultLayout-BuWzCyjW.js";import"./index.esm-CNiLTC84.js";import"./isRTL-D5ORmfro.js";const H=()=>{const{addToast:H}=e.useContext(a),[K,Q]=e.useState(!1),[U,V]=e.useState(!1),[W,X]=e.useState(!1),[Z,ee]=e.useState("active"),[ae,te]=e.useState([]),[ie,se]=e.useState([]),[re,ne]=e.useState(!1),[le,de]=e.useState(!1),[ce,oe]=e.useState(""),[me,pe]=e.useState(1),[he,fe]=e.useState(9),[je,ue]=e.useState(1),[ge,Se]=e.useState("grid");new Date((new Date).setDate((new Date).getDate()+1)),new Date((new Date).setDate((new Date).getDate()-1));const ye=o.object({jpf_id:o.string().optional(),jpfTitle:o.string().min(1,{message:"Job Title is required"}),jpfType:o.string().min(1,{message:"Job Type is required"}),jpfDesc:o.string().min(1,{message:"Job Description is required"}),jpfSalaryMin:o.number().min(1,{message:"Minimum Salary is required"}).default(0),jpfSalaryMax:o.number().min(1,{message:"Maximum Salary is required"}).default(1),jpfLoc:o.string().min(1,{message:"Location is required"}),jpfBnft:o.string().min(1,{message:"Benefit is required"}),jpfReq:o.string().min(1,{message:"Requirement is required"}),jpfSchedStart:o.preprocess((e=>new Date(e)),o.date()),jpfSchedEnd:o.preprocess((e=>new Date(e)),o.date().min(new Date,{message:"End Date must be in the future"})),jpfStatus:o.string().optional()}).refine((e=>e.jpfSchedEnd>e.jpfSchedStart),{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}).refine((e=>e.jpfSalaryMin<e.jpfSalaryMax),{message:"Minimum Salary must be less than Maximum Salary",path:["jpfSalaryMax"]}),{register:be,reset:ve,handleSubmit:xe,formState:{errors:Ne}}=m({resolver:p(ye)}),Me=async e=>{try{const a=await l(`/jobposting/${e}`);if(200===a.status){H("Jobposting",`Jobposting for ${e} retrieved`,"success"),X(!0),Q(!0);const t={jpf_id:a.data.data._id,jpfTitle:a.data.data.title,jpfType:a.data.data.type,jpfDesc:a.data.data.description,jpfSalaryMin:a.data.data.salary_min,jpfSalaryMax:a.data.data.salary_max,jpfLoc:a.data.data.location,jpfBnft:a.data.data.benefits,jpfReq:a.data.data.requirements,jpfSchedStart:new Date(a.data.data.schedule_start).toISOString().split("T")[0],jpfSchedEnd:new Date(a.data.data.schedule_end).toISOString().split("T")[0],jpfStatus:a.data.status};ve(t),window.scrollTo(0,0)}else H("Jobposting","Error getting jobposting","danger")}catch(a){H("Jobposting","Error getting jobposting","danger")}},Ce=async(e,a)=>{try{ne(!0);const t=le?await l(`/jobposting/search?query=${ce}&page=${e}&limit=${a}`):await l(`/jobposting?page=${e}&limit=${a}`);200===t.status||201===t.status?(te(t.data.data),pe(t.data.currentPage),ue(t.data.totalPages),Q(!1),ne(!1)):(H("Jobposting "+t.status,t.message.message,"danger"),ne(!1),de(!1))}catch(t){}},De=o.object({jpSearchInput:o.string().min(1,{message:"Search query is required"})}),{register:Te,handleSubmit:we}=m({resolver:p(De)});return e.useEffect((()=>{const e=setTimeout((()=>{Ce(me,he)}),500);return()=>clearTimeout(e)}),[me,he,le,ce]),t(i,{children:s(T,{children:[t(w,{className:"mb-3",children:s(_,{children:[t("h1",{children:"Job Postings"}),t("small",{className:"text-muted",children:"In this page, you can view all the job posting data, create new job postings, and edit existing job postings."})]})}),t(w,{children:t(_,{className:"d-flex justify-content-end",children:t("div",{children:t(r,{type:"button",onClick:()=>Q(!K),color:"primary",size:"sm",children:"Create"})})})}),t(w,{className:"mb-3",children:t(_,{children:s(q,{visible:K,size:"lg",backdrop:"static",onClose:()=>{Q(!1),(()=>{X(!1),Q(!1);const e={jpf_id:"",jpfTitle:"",jpfType:"",jpfDesc:"",jpfSalaryMin:0,jpfSalaryMax:1,jpfLoc:"",jpfBnft:"",jpfReq:"",jpfSchedStart:(new Date).toISOString().split("T")[0],jpfSchedEnd:(new Date).toISOString().split("T")[0],jpfStatus:"active"};ve(e)})()},children:[t(E,{children:t(I,{children:s("div",{children:[W?"Edit Job Posting":"Create Job Posting",t("span",{className:"active"===Z?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:"active"===Z?"Active":"Inactive"})]})})}),t(F,{children:s(L,{onSubmit:xe((async e=>{try{const a={title:e.jpfTitle||"none",type:e.jpfType||"none",salary_min:e.jpfSalaryMin||0,salary_max:e.jpfSalaryMax||1,location:e.jpfLoc||"none",description:e.jpfDesc||"none",requirements:e.jpfReq||"none",responsibilities:e.jpfResp||"none",benefits:e.jpfBnft||"none",schedule_start:e.jpfSchedStart,schedule_end:e.jpfSchedEnd,status:e.jpfStatus||"inactive"},t=W?await d(`/jobposting/${e.jpf_id}`,a):await c("/jobposting",a);201===t.status&&(H("Jobposting",t.data.message,"success"),Ce(1),ve())}catch(a){H("Jobposting","Error creating jobposting","danger")}})),children:[t(w,{className:"visually-hidden",children:t("div",{children:t(R,{type:"text",id:"jpf_id",...be("jpf_id")})})}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfTitle",children:"Job Title"}),t(R,{type:"text",id:"jpfTitle",placeholder:"e.g. Software Engineer",...be("jpfTitle"),invalid:!!Ne.jpfTitle}),Ne.jpfTitle&&t(J,{invalid:!0,children:Ne.jpfTitle.message})]})}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfType",children:"Job Type"}),t(R,{type:"text",id:"jpfType",placeholder:"e.g. Full-time",...be("jpfType"),invalid:!!Ne.jpfType}),Ne.jpfType&&t(J,{invalid:!0,children:Ne.jpfType.message})]})}),t(w,{children:t("strong",{children:"Salary"})}),s(w,{children:[t(_,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfSalaryMin",children:"Minimum"}),t(R,{type:"number",id:"jpfSalaryMin",placeholder:"0",...be("jpfSalaryMin",{valueAsNumber:!0}),invalid:!!Ne.jpfSalaryMin}),Ne.jpfSalaryMin&&t(J,{invalid:!0,children:Ne.jpfSalaryMin.message})]})}),t(_,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfSalaryMax",children:"Maximum"}),t(R,{type:"number",id:"jpfSalaryMax",placeholder:"1",...be("jpfSalaryMax",{valueAsNumber:!0}),invalid:!!Ne.jpfSalaryMax}),Ne.jpfSalaryMax&&t(J,{invalid:!0,children:Ne.jpfSalaryMax.message})]})})]}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfLoc",children:"Location"}),t(R,{type:"text",id:"jpfLoc",placeholder:"e.g. Manila",...be("jpfLoc"),invalid:!!Ne.jpfLoc}),Ne.jpfLoc&&t(J,{invalid:!0,children:Ne.jpfLoc.message})]})}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfDesc",children:"Description"}),t(z,{id:"jpfDesc",placeholder:"e.g. Job description details...",...be("jpfDesc"),invalid:!!Ne.jpfDesc,className:"scalableCFormTextArea-200"}),Ne.jpfDesc&&t(J,{invalid:!0,children:Ne.jpfDesc.message})]})}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfBnft",children:"Benefits"}),t(z,{id:"jpfBnft",placeholder:"e.g. Dental Care",...be("jpfBnft"),invalid:!!Ne.jpfBnft,className:"scalableCFormTextArea-200"}),Ne.jpfBnft&&t(J,{invalid:!0,children:Ne.jpfBnft.message})]})}),t(w,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfReq",children:"Requirements"}),t(z,{id:"jpfReq",placeholder:"e.g. Identification Documents",...be("jpfReq"),invalid:!!Ne.jpfReq,className:"scalableCFormTextArea-200"}),Ne.jpfReq&&t(J,{invalid:!0,children:Ne.jpfReq.message})]})}),s(w,{children:[t("strong",{children:"Deployment Schedule"}),t("p",{className:"text-muted small",children:"These parameters determine the duration of the job posting."})]}),s(w,{children:[t(_,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfSchedStart",children:"Start"}),t(R,{type:"date",id:"jpfSchedStart",...be("jpfSchedStart"),invalid:!!Ne.jpfSchedStart}),Ne.jpfSchedStart&&t(J,{invalid:!0,children:Ne.jpfSchedStart.message})]})}),t(_,{children:s("div",{className:"mb-3",children:[t(Y,{htmlFor:"jpfSchedEnd",children:"Expire"}),t(R,{type:"date",id:"jpfSchedEnd",...be("jpfSchedEnd"),invalid:!!Ne.jpfSchedEnd}),Ne.jpfSchedEnd&&t(J,{invalid:!0,children:Ne.jpfSchedEnd.message})]})})]}),t("hr",{}),t(w,{children:s("div",{className:"ml-5 mb-3 d-flex justify-content-end",children:[t(k,{type:"checkbox",id:"invalidCheck",label:"I've reviewed the job posting and checked that all is correct. ",checked:U,onChange:e=>{V(e.target.checked)}}),t(J,{invalid:!0,children:"You must agree before submitting."})]})}),t(w,{children:s(_,{className:"d-flex flex-row gap-2 justify-content-end",children:[t("div",{children:W&&t(B,{content:"Print (unavailable)",placement:"top",children:t(r,{type:"button",color:"info",size:"sm",children:t(h,{icon:f})})})}),t("div",{children:t(r,{color:"primary",size:"sm",type:"submit",disabled:!U,children:re?t(n,{color:"primary"}):W?"Update":"Add"})})]})})]})})]})})}),t(w,{className:"d-flex mb-3 ustify-content-between align-items-center",children:t(T,{children:t(L,{onSubmit:we((async e=>{try{de(!0),ne(!0),oe(e.jpSearchInput),Ce(1,he)}catch(a){ne(!1),de(!1)}})),className:"d-flex flex-row gap-2 justify-content-end align-items-center",children:s(A,{children:[t(R,{type:"text",id:"jpSearchInput",placeholder:"...",...Te("jpSearchInput"),invalid:!!Ne.jpSearchInput}),t(B,{content:"Search",placement:"top",children:t(r,{type:"submit",color:"primary",size:"sm",children:t(h,{icon:j})})}),t(B,{content:"Reset",placement:"top",children:t(r,{onClick:()=>(de(!1),oe(""),void Ce(1,he)),type:"button",color:"primary",size:"sm",children:t(h,{icon:u})})})]})})})}),s(w,{children:[t("div",re?{className:"pt-3 text-center",children:t(n,{color:"primary",variant:"grow"})}:{children:"grid"===ge?t(w,{xs:{cols:1},md:{cols:3},className:"g-3",children:ae.map((e=>e?t(_,{children:t(P,{className:"position-relative h-100",children:s($,{children:[t("h4",{className:"fw-bold text-capitalize",children:e.title}),s("div",{children:[t(h,{icon:g,className:"me-2"}),t("small",{className:"text-muted text-capitalize",children:e.location})]}),s("div",{children:[t(h,{icon:S,className:"me-2"}),"active"===e.status?t("small",{className:"text-success",children:"Active"}):t("small",{className:"text-danger",children:"Inactive"})]}),s("div",{children:[t(h,{icon:y,className:"me-2"}),s("small",{className:"text-muted",children:[M(e.schedule_start,"MMM D, YYYY")," -"," ",M(e.schedule_end,"MMM D, YYYY")]})]}),s("div",{children:[t(h,{icon:b,className:"me-2"}),s("small",{className:"text-muted",children:[C(e.salary_min)," - ",C(e.salary_max)]})]}),t("br",{}),s("div",{children:[t("strong",{children:"Description"}),t("br",{}),t("small",{className:"text-muted",children:D(e.description,150)})]}),t("br",{}),t("div",{className:"d-flex justify-content-end",children:s(r,{onClick:()=>Me(e._id),color:"primary",size:"sm",children:[t(h,{icon:v,className:"me-2"}),"Edit"]})})]})})},e._id):t("div",{children:"Loading"},Math.random())))}):t(O,{children:ae.map((e=>e?t(G,{children:s(T,{children:[t(w,{children:t(_,{children:t("h4",{className:"fw-bold text-capitalize",children:e.title})})}),s(w,{children:[s(_,{children:[s("div",{children:[t(h,{icon:g,className:"me-2"}),t("small",{className:"text-muted text-capitalize",children:e.location})]}),s("div",{children:[t(h,{icon:S,className:"me-2"}),"active"===e.status?t("small",{className:"text-success",children:"Active"}):t("small",{className:"text-danger",children:"Inactive"})]}),s("div",{children:[t(h,{icon:y,className:"me-2"}),s("small",{className:"text-muted",children:[M(e.schedule_start,"MMM D, YYYY")," -"," ",M(e.schedule_end,"MMM D, YYYY")]})]}),s("div",{children:[t(h,{icon:x,className:"me-2"}),s("small",{className:"text-muted",children:[C(e.salary_min)," -"," ",C(e.salary_max)]})]}),t("br",{})]}),t(_,{children:s("div",{children:[s("div",{children:[t("strong",{children:"Description"}),t("br",{}),t("small",{className:"text-muted",children:D(e.description,150)})]}),t("br",{}),t("div",{className:"d-flex justify-content-end",children:s(r,{onClick:()=>Me(e._id),color:"primary",size:"sm",children:[t(h,{icon:v,className:"me-2"}),"Edit"]})})]})})]})]})},e._id):null))})}),t("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:t(N,{currentPage:me,totalPages:je||1,onPageChange:pe})})]})]})})};export{H as default};
