import{r as c,j as e}from"./index-BTqRlzNU.js";import{z as n,u as U,f as w,a as M,b as E,t as O,c as z,p as ue,d as ge,g as q}from"./index-CQgnhZE6.js";import{F as i,f as ye,a as be,b as Se,c as ve,d as G,e as Y,g as K,h as Q,i as Ce,j as Ne,k as De,l as we}from"./DefaultLayout-0iBsoURn.js";import{C as T}from"./index.esm-DUs5EjL4.js";import{C as l,a as y}from"./CRow-CW1B0TsK.js";import{C as I,a as P}from"./CCardBody-CuNyQdm_.js";import{C as R}from"./CCardHeader-BEx_8av2.js";import{a as j}from"./cil-user-BAdj4vKc.js";import{C as Me}from"./CTooltip-BYB7Nj9L.js";import{C as Ee}from"./CCollapse-Bh6PaIOH.js";import{C as W}from"./CForm-s-jRDDLq.js";import{C as m}from"./CFormInput-C8AdvKAf.js";import{C as f}from"./CFormLabel-BCODsSJI.js";import{C as o}from"./CFormControlValidation-6c7fEoYD.js";import{C as L}from"./CFormTextarea-bSYOkFsO.js";import{C as Te}from"./CFormCheck-Bh8YGY1i.js";import{C as X}from"./CCardFooter-BtpfoN25.js";import"./getRTLPlacement-BWaqstQ-.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./CFormControlWrapper-BIy505T4.js";const Ze=()=>{const[b,F]=c.useState(!1),[B,Z]=c.useState(!1),[x,J]=c.useState(!1);c.useState("active");const[A,ee]=c.useState([]);c.useState([]);const[se,u]=c.useState(!1),[_,S]=c.useState(!1),[$,V]=c.useState(""),[h,g]=c.useState(1),[v,Fe]=c.useState(9),[C,te]=c.useState(0),[ae,_e]=c.useState("grid"),re=new Date,ne=new Date(new Date().setDate(new Date().getDate()+1)),ie=new Date(new Date().setDate(new Date().getDate()-1)),le=n.object({jpf_id:n.string().optional(),jpfTitle:n.string().min(1,{message:"Job Title is required"}),jpfType:n.string().min(1,{message:"Job Type is required"}),jpfDesc:n.string().min(1,{message:"Job Description is required"}),jpfSalaryMin:n.number().min(1,{message:"Minimum Salary is required"}).default(0),jpfSalaryMax:n.number().min(1,{message:"Maximum Salary is required"}).default(1),jpfLoc:n.string().min(1,{message:"Location is required"}),jpfBnft:n.string().min(1,{message:"Benefit is required"}),jpfReq:n.string().min(1,{message:"Requirement is required"}),jpfSchedStart:n.preprocess(s=>new Date(s),n.date().min(ie,{message:"Start Date must be today or later"})),jpfSchedEnd:n.preprocess(s=>new Date(s),n.date().min(new Date,{message:"End Date must be in the future"})),jpfStatus:n.string().optional()}).refine(s=>(console.log("Start Date:",s.jpfSchedStart,"End Date:",s.jpfSchedEnd),s.jpfSchedEnd>s.jpfSchedStart),{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}).refine(s=>s.jpfSalaryMin<s.jpfSalaryMax,{message:"Minimum Salary must be less than Maximum Salary",path:["jpfSalaryMax"]}),{register:d,reset:k,handleSubmit:ce,formState:{errors:t}}=U({resolver:async(s,a,r)=>{try{const p=await z(le)(s,a,r);return console.log("Validation result:",p),p}catch(p){console.log(p)}}}),oe=async(s,a)=>{console.log(s);try{console.log("JOB POSTING: ",s);const r={title:s.jpfTitle||"none",type:s.jpfType||"none",salary_min:s.jpfSalaryMin||0,salary_max:s.jpfSalaryMax||1,location:s.jpfLoc||"none",description:s.jpfDesc||"none",requirements:s.jpfReq||"none",responsibilities:s.jpfResp||"none",benefits:s.jpfBnft||"none",schedule_start:s.jpfSchedStart,schedule_end:s.jpfSchedEnd,status:s.jpfStatus||"active"};console.log("ID:",s.jpf_id);const p=x?await ue(`/jobposting/${s.jpf_id}`,r):await ge("/jobposting",r);console.log(p),p.success===!0&&(alert(x?"Jobposting updated successfully":"Jobposting created successfully"),N(1),k())}catch(r){console.log(r),alert("Error creating jobposting")}},H=async s=>{try{const a=await q(`/jobposting/${s}`);if(a.success===!0){J(!0),F(!0),console.log("Edit: ",a.data);const r={jpf_id:a.data._id,jpfTitle:a.data.title,jpfType:a.data.type,jpfDesc:a.data.description,jpfSalaryMin:a.data.salary_min,jpfSalaryMax:a.data.salary_max,jpfLoc:a.data.location,jpfBnft:a.data.benefits,jpfReq:a.data.requirements,jpfSchedStart:w(a.data.schedule_start),jpfSchedEnd:w(a.data.schedule_end),jpfStatus:a.data.status};k(r),window.scrollTo(0,0)}else alert("Error getting jobposting")}catch(a){console.log(a),alert("Error getting jobposting")}},de=()=>{J(!1),F(!1),k({jpf_id:"",jpfTitle:"",jpfType:"",jpfDesc:"",jpfSalaryMin:0,jpfSalaryMax:1,jpfLoc:"",jpfBnft:"",jpfReq:"",jpfSchedStart:new Date,jpfSchedEnd:new Date,jpfStatus:"active"})},je=s=>{Z(s.target.checked)},N=async(s,a)=>{try{u(!0),console.log("Fetch: Search Mode:  ",_);const r=_?await q(`/jobposting/search?query=${$}&page=${s}&limit=${a}`):await q(`/jobposting?page=${s}&limit=${a}`);r.success===!0?(ee(r.data),g(r.currentPage),te(r.totalPages),u(!1)):(alert("Error getting jobposting"),console.log("Error: ",r.data),u(!1),S(!1))}catch(r){console.log(r)}},pe=n.object({jpSearchInput:n.string().min(1,{message:"Search query is required"})}),{register:fe,handleSubmit:me,formState:{searchError:ke}}=U({resolver:async(s,a,r)=>{const p=await z(pe)(s,a,r);return console.log("Validation result:",p),p}}),he=async s=>{try{console.log("Search Input:  ",s.jpSearchInput),S(!0),u(!0),V(s.jpSearchInput),N(1,v)}catch(a){console.log(a),u(!1),S(!1)}},xe=()=>{S(!1),V(""),N(1,v)};c.useEffect(()=>{const s=setTimeout(()=>{N(h,v)},500);return()=>clearTimeout(s)},[h,v,_,$]);const D=s=>{switch(console.log("Action: ",s),s){case"firstPage":g(1);break;case"prevPage":g(a=>a-1);break;case"nextPage":g(a=>a+1);break;case"lastPage":g(C);break;default:console.warn("Unknown action:",s)}};return e.jsx(e.Fragment,{children:e.jsxs(T,{className:"d-flex flex-column gap-3 mb-3",children:[e.jsx(l,{children:e.jsx(T,{children:e.jsxs(I,{children:[e.jsx(R,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:x?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:x?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[x&&e.jsx(j,{type:"button",onClick:()=>de(),className:"btn btn-danger w-30",children:e.jsx(i,{icon:ye})}),e.jsx(Me,{content:b?"Collapse":"Expand",placement:"top",children:e.jsx(j,{type:"button",onClick:()=>F(!b),className:"btn btn-primary w-30",children:b?e.jsx(i,{icon:be}):e.jsx(i,{icon:Se})})})]})]})}),e.jsx(Ee,{visible:b,children:e.jsx(P,{children:e.jsxs(W,{onSubmit:ce(oe),children:[e.jsx(l,{className:"visually-hidden",children:e.jsx("div",{children:e.jsx(m,{type:"text",id:"jpf_id",...d("jpf_id")})})}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfTitle",children:"Job Title"}),e.jsx(m,{type:"text",id:"jpfTitle",placeholder:"e.g. Software Engineer",...d("jpfTitle"),invalid:!!t.jpfTitle}),t.jpfTitle&&e.jsx(o,{invalid:!0,children:t.jpfTitle.message})]})}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfType",children:"Job Type"}),e.jsx(m,{type:"text",id:"jpfType",placeholder:"e.g. Full-time",...d("jpfType"),invalid:!!t.jpfType}),t.jpfType&&e.jsx(o,{invalid:!0,children:t.jpfType.message})]})}),e.jsx(l,{children:e.jsx("strong",{children:"Salary"})}),e.jsxs(l,{children:[e.jsx(y,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfSalaryMin",children:"Minimum"}),e.jsx(m,{type:"number",id:"jpfSalaryMin",placeholder:"0",...d("jpfSalaryMin",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMin}),t.jpfSalaryMin&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMin.message})]})}),e.jsx(y,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfSalaryMax",children:"Maximum"}),e.jsx(m,{type:"number",id:"jpfSalaryMax",placeholder:"1",...d("jpfSalaryMax",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMax}),t.jpfSalaryMax&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMax.message})]})})]}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfLoc",children:"Location"}),e.jsx(m,{type:"text",id:"jpfLoc",placeholder:"e.g. Manila",...d("jpfLoc"),invalid:!!t.jpfLoc}),t.jpfLoc&&e.jsx(o,{invalid:!0,children:t.jpfLoc.message})]})}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfDesc",children:"Description"}),e.jsx(L,{id:"jpfDesc",placeholder:"e.g. Job description details...",...d("jpfDesc"),invalid:!!t.jpfDesc}),t.jpfDesc&&e.jsx(o,{invalid:!0,children:t.jpfDesc.message})]})}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfBnft",children:"Benefits"}),e.jsx(L,{id:"jpfBnft",placeholder:"e.g. Dental Care",...d("jpfBnft"),invalid:!!t.jpfBnft}),t.jpfBnft&&e.jsx(o,{invalid:!0,children:t.jpfBnft.message})]})}),e.jsx(l,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfReq",children:"Requirements"}),e.jsx(L,{id:"jpfReq",placeholder:"e.g. Identification Documents",...d("jpfReq"),invalid:!!t.jpfReq}),t.jpfReq&&e.jsx(o,{invalid:!0,children:t.jpfReq.message})]})}),e.jsxs(l,{children:[e.jsx("strong",{children:"Deployment Schedule"}),e.jsx("p",{className:"text-muted small",children:"These parameters determine the duration of the job posting."})]}),e.jsxs(l,{children:[e.jsx(y,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfSchedStart",children:"Start"}),e.jsx(m,{type:"date",id:"jpfSchedStart",defaultValue:w(re),...d("jpfSchedStart",{valueAsDate:!0}),invalid:!!t.jpfSchedStart}),t.jpfSchedStart&&e.jsx(o,{invalid:!0,children:t.jpfSchedStart.message})]})}),e.jsx(y,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"jpfSchedEnd",children:"Expire"}),e.jsx(m,{type:"date",id:"jpfSchedEnd",defaultValue:w(ne),...d("jpfSchedEnd",{valueAsDate:!0}),invalid:!!t.jpfSchedEnd}),t.jpfSchedEnd&&e.jsx(o,{invalid:!0,children:t.jpfSchedEnd.message})]})})]}),e.jsx("hr",{}),e.jsx(l,{children:e.jsxs("div",{className:"ml-5 mb-3 d-flex justify-content-end",children:[e.jsx(Te,{type:"checkbox",id:"invalidCheck",label:"I've reviewed the job posting and checked that all is correct. ",checked:B,onChange:je}),e.jsx(o,{invalid:!0,children:"You must agree before submitting."})]})}),e.jsx(l,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(j,{color:"primary",type:"submit",disabled:!B,className:"mb-3 w-25",children:x?"Update":"Add"})})})]})})})]})})}),e.jsx(l,{children:e.jsx(T,{children:e.jsxs(I,{children:[e.jsx(R,{children:e.jsxs(W,{onSubmit:me(he),className:"d-flex flex-row gap-2 justify-content-end align-items-center",children:[e.jsxs("div",{children:[e.jsx(m,{type:"text",id:"jpSearchInput",placeholder:"...",...fe("jpSearchInput"),invalid:!!t.jpSearchInput}),t.jpSearchInput&&e.jsx(o,{invalid:!0,children:t.jpSearchInput.message})]}),e.jsx(j,{type:"submit",className:"btn btn-primary",children:"Search"}),e.jsx(j,{onClick:()=>xe(),type:"button",className:"btn btn-primary",children:e.jsx(i,{icon:ve})})]})}),e.jsx(P,{children:se?e.jsx("div",{children:"Loading"}):e.jsx("div",{children:ae==="grid"?e.jsx(T,{children:e.jsx(l,{xs:{cols:1},md:{cols:3},className:"g-3",children:A.map(s=>s?e.jsx(y,{children:e.jsxs(I,{className:"mb-3 h-100",children:[e.jsx(R,{className:"fw-bold text-uppercase text-primary",children:e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]})}),e.jsx(P,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-between",children:[e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:G}),e.jsx("p",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:Y}),e.jsxs("p",{children:[M(s.schedule_start)," -"," ",M(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:K}),e.jsxs("p",{children:[E(s.salary_min)," -"," ",E(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:O(s.description,150)})]})]})}),e.jsx(X,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(j,{onClick:()=>H(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(i,{icon:Q}),"Edit"]})})})]})},s._id):e.jsx("div",{children:"Loading"},Math.random()))})}):e.jsx("ul",{className:"list-group list-group-flush",children:A.map(s=>s?e.jsxs("li",{className:"list-group-item",children:[e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-bg-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:G}),e.jsx("div",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:Y}),e.jsxs("p",{children:[M(s.schedule_start)," -"," ",M(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(i,{icon:K}),e.jsxs("p",{children:[E(s.salary_min)," -"," ",E(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:O(s.description,150)})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(j,{onClick:()=>H(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(i,{icon:Q}),"Edit"]})})})]},s._id):null)})})}),e.jsxs(X,{className:"d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(j,{onClick:()=>D("firstPage"),disabled:h===1&&!0,className:"btn btn-outline-primary",children:e.jsx(i,{icon:Ce})}),e.jsx(j,{onClick:()=>D("prevPage"),disabled:h===1&&!0,className:"btn btn-outline-primary",children:e.jsx(i,{icon:Ne})}),e.jsxs("p",{children:["Page ",h," of ",C]}),e.jsx(j,{onClick:()=>D("nextPage"),disabled:h===C&&!0,className:"btn btn-outline-primary",children:e.jsx(i,{icon:De})}),e.jsx(j,{onClick:()=>D("lastPage"),disabled:h===C&&!0,className:"btn btn-outline-primary",children:e.jsx(i,{icon:we})})]})]})})})]})})};export{Ze as default};
