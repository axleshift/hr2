import{r,j as e,y as w,w as ee,x as se,D as te}from"./index-DJmP4oi1.js";import{z as n,u as $,t as A}from"./zod-DUXwhK-0.js";import{c as ae}from"./index-B7W5ZAKh.js";import{A as re}from"./DefaultLayout-B3wRVOO4.js";import{F as d,h as k,i as ne,j as ce,s as oe,o as ie}from"./index-eE9MX41S.js";import{C as m}from"./CContainer-Bi4TmV07.js";import{C as c,a as h}from"./CRow-C4bqXax5.js";import{C as v,a as F}from"./CCardBody-CsRVGBr3.js";import{C as M}from"./CCardHeader-fZYpQjk6.js";import{C as g}from"./CTooltip-SjvLySxl.js";import{a as l}from"./CButton-BokoXM6Y.js";import{C as le}from"./CCollapse-BxLZ-LAq.js";import{C as B}from"./CForm-CXAWI-AN.js";import{C as y}from"./CFormInput-CXMpxMYz.js";import{C}from"./CFormControlValidation-CkCCXccc.js";import{C as H}from"./CCardFooter-D3-cekKp.js";import{C as de}from"./CButtonGroup-Dr5SINpO.js";import"./index.esm-ChogiBHI.js";import"./cil-user-Dlmw-Gem.js";import"./getRTLPlacement-DNCpgelB.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./CFormControlWrapper-4INfD17j.js";import"./CFormLabel-ByYPne7n.js";const Me=()=>{const[I,U]=r.useState([]),[o,b]=r.useState(!1),[x,p]=r.useState(!0),[E,_]=r.useState(""),[P,q]=r.useState(!1),[j,D]=r.useState(1),[S,me]=r.useState(9),[z,G]=r.useState(0),u=async()=>{try{const s=P?await w(`/tags/search?query=${E}&page=${j}&limit=${S}`):await w(`/tags/all?page=${j}&limit=${S}`);s.status===200?(U(s.data.data),G(s.data.totalPages),D(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},J=n.object({id:n.string().optional(),name:n.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:n.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),description:n.string().optional()}),{register:N,reset:T,handleSubmit:L,formState:{errors:a}}=$({resolver:A(J)}),K=async s=>{try{const t=I.find(R=>R.name===s.name&&R.category===s.category);if(!o&&t){console.log("Tag already exist");return}console.log(s);const i=o?await ee(`/tags/${s.id}`,s):await se("/tags",s);i.status===200||i.status===201?(alert(i.data.message),T({id:"",name:"",category:""}),b(!1),p(!0),u()):console.log(i)}catch{}},O=async s=>{try{b(!0),p(!0);const t=await w(`/tags/${s}`);if(t.status===200){const i={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category};T(i)}}catch{}},Q=async s=>{try{if(!confirm("Are you sure you want to delete this tag?"))return;(await te(`/tags/${s}`)).status===200&&u()}catch{}},V=()=>{T({id:"",name:"",category:""}),b(!1),p(!0)},W=n.object({searchInput:n.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:X,reset:he,handleSubmit:Y,formState:{errors:f}}=$({resolver:A(W)}),Z=async s=>{try{console.log(s),_(s.searchInput),q(!0),u()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{u()},300);return()=>clearTimeout(s)},[j,S,P,E]),e.jsxs(m,{className:"d-flex flex-column gap-3",children:[e.jsx(c,{children:e.jsx(m,{children:e.jsxs(v,{children:[e.jsx(M,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:o?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:o?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[o&&e.jsx(g,{content:"Reset form",placement:"top",children:e.jsx(l,{onClick:()=>V(),className:"btn btn-danger",children:e.jsx(d,{icon:k})})}),e.jsx(g,{content:x?"Collapse":"Expand",placement:"top",children:e.jsx(l,{onClick:()=>p(!x),className:"btn btn-primary",children:e.jsx(d,{icon:x?ne:ce})})})]})]})}),e.jsx(le,{visible:x,children:e.jsx(F,{children:e.jsx(B,{onSubmit:L(K),children:e.jsxs(m,{className:"d-flex flex-column gap-2",children:[e.jsx(c,{children:e.jsxs(h,{children:[e.jsx(y,{type:"hidden",id:"id",...N("id"),invalid:!!a.id}),a&&a.id&&e.jsx(C,{className:"text-danger",children:a.id.message}),e.jsx(y,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...N("name"),invalid:!!a.name}),a&&a.name&&e.jsx(C,{className:"text-danger",children:a.name.message})]})}),e.jsx(c,{children:e.jsxs(h,{children:[e.jsx(y,{type:"text",id:"category",placeholder:"Category",label:"Category",...N("category"),invalid:!!a.category}),a&&a.category&&e.jsx(C,{className:"text-danger",children:a.category.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(l,{color:"primary",type:"submit",className:"mb-3 w-25",children:o?"Update":"Submit"})})]})})})})]})})}),e.jsx(c,{children:e.jsx(m,{children:e.jsxs(v,{children:[e.jsx(M,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(B,{onSubmit:Y(Z),className:"d-flex flex-row gap-2",children:[e.jsxs("div",{children:[e.jsx(y,{placeholder:"...",id:"searcInput",...X("searchInput"),invalid:!!f.searchInput}),f&&f.searchInput&&e.jsx(C,{className:"text-danger",children:f.searchInput.message})]}),e.jsx(g,{content:"Search tags",placement:"top",children:e.jsx(l,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:oe})})})]})})]})}),e.jsx(F,{children:e.jsx(m,{children:e.jsx(c,{children:I.map((s,t)=>e.jsx(h,{md:4,className:"mb-3",children:e.jsxs(v,{className:"h-100",children:[e.jsx(F,{children:e.jsx(c,{children:e.jsxs(h,{children:[e.jsx("h5",{children:ae(s.name)}),e.jsx("p",{children:s.category})]})})}),e.jsx(H,{children:e.jsx(c,{children:e.jsx(h,{children:e.jsxs(de,{children:[e.jsx(g,{content:"Edit tag",placement:"top",children:e.jsx(l,{color:"primary",onClick:()=>O(s._id),children:e.jsx(d,{icon:ie})})}),e.jsx(g,{content:"Delete tag",placement:"top",children:e.jsx(l,{color:"danger",onClick:()=>Q(s._id),children:e.jsx(d,{icon:k})})})]})})})})]})},t))})})}),e.jsx(H,{className:"d-flex justify-content-center",children:e.jsx(re,{currentPage:j,totalPages:z||1,onPageChange:D})})]})})})]})};export{Me as default};
