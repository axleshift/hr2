import{r,o as ue,k as e,g as m,l as ge,E as ye,F as be,G as T}from"./index-CiV4mRcZ.js";import{z as i,u as A,t as $}from"./zod-BQFeo2Z_.js";import{F as l,z as H,A as Se,B as ve,C as Ce,D as Ne,E as G,G as z,H as U,I as V}from"./index.es-ba-Ohs3A.js";import{A as De}from"./AppPagination-CbuU39Nq.js";import{f as C,a as N,b as D,t as Y}from"./index-DROTT6wf.js";import{C as F}from"./CContainer-Do4jvznw.js";import{C as n,a as h}from"./CRow-DuUDi8eX.js";import{C as K,a as O}from"./CCardBody-BSH2F1wg.js";import{C as Q}from"./CCardHeader-QVwXVPrs.js";import{C as g}from"./CTooltip-blDH3YDi.js";import{C as we}from"./CCollapse-DQXX3K80.js";import{C as W,a as j,b as p,c as o}from"./CFormInput-DTJIjxRp.js";import{C as _}from"./CFormTextarea-CjobtssV.js";import{C as Me}from"./CFormCheck-BMR-6tlK.js";import{C as Ee}from"./CInputGroup-C2Au0wq3.js";import{C as Te}from"./CCardFooter-scExt8SB.js";const Oe=()=>{const{addToast:f}=r.useContext(ue),[y,w]=r.useState(!1),[q,X]=r.useState(!1),[x,I]=r.useState(!1);r.useState("active");const[R,Z]=r.useState([]);r.useState([]);const[ee,u]=r.useState(!1),[P,b]=r.useState(!1),[J,L]=r.useState(""),[M,k]=r.useState(1),[S,Fe]=r.useState(9),[se,te]=r.useState(1),[ae,_e]=r.useState("grid"),ne=new Date,ie=new Date(new Date().setDate(new Date().getDate()+1)),re=new Date(new Date().setDate(new Date().getDate()-1)),le=i.object({jpf_id:i.string().optional(),jpfTitle:i.string().min(1,{message:"Job Title is required"}),jpfType:i.string().min(1,{message:"Job Type is required"}),jpfDesc:i.string().min(1,{message:"Job Description is required"}),jpfSalaryMin:i.number().min(1,{message:"Minimum Salary is required"}).default(0),jpfSalaryMax:i.number().min(1,{message:"Maximum Salary is required"}).default(1),jpfLoc:i.string().min(1,{message:"Location is required"}),jpfBnft:i.string().min(1,{message:"Benefit is required"}),jpfReq:i.string().min(1,{message:"Requirement is required"}),jpfSchedStart:i.preprocess(s=>new Date(s),i.date().min(re,{message:"Start Date must be today or later"})),jpfSchedEnd:i.preprocess(s=>new Date(s),i.date().min(new Date,{message:"End Date must be in the future"})),jpfStatus:i.string().optional()}).refine(s=>s.jpfSchedEnd>s.jpfSchedStart,{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}).refine(s=>s.jpfSalaryMin<s.jpfSalaryMax,{message:"Minimum Salary must be less than Maximum Salary",path:["jpfSalaryMax"]}),{register:d,reset:E,handleSubmit:ce,formState:{errors:t}}=A({resolver:$(le)}),de=async s=>{try{const a={title:s.jpfTitle||"none",type:s.jpfType||"none",salary_min:s.jpfSalaryMin||0,salary_max:s.jpfSalaryMax||1,location:s.jpfLoc||"none",description:s.jpfDesc||"none",requirements:s.jpfReq||"none",responsibilities:s.jpfResp||"none",benefits:s.jpfBnft||"none",schedule_start:s.jpfSchedStart,schedule_end:s.jpfSchedEnd,status:s.jpfStatus||"inactive"},c=x?await ye(`/jobposting/${s.jpf_id}`,a):await be("/jobposting",a);c.status===201&&(f("Jobposting",c.data.message,"success"),v(1),E())}catch(a){console.log(a),f("Jobposting","Error creating jobposting","danger")}},B=async s=>{try{const a=await T(`/jobposting/${s}`);if(a.status===200){f("Jobposting",`Jobposting for ${s} retrieved`,"success"),I(!0),w(!0);const c={jpf_id:a.data.data._id,jpfTitle:a.data.data.title,jpfType:a.data.data.type,jpfDesc:a.data.data.description,jpfSalaryMin:a.data.data.salary_min,jpfSalaryMax:a.data.data.salary_max,jpfLoc:a.data.data.location,jpfBnft:a.data.data.benefits,jpfReq:a.data.data.requirements,jpfSchedStart:C(a.data.data.schedule_start),jpfSchedEnd:C(a.data.data.schedule_end),jpfStatus:a.data.status};E(c),window.scrollTo(0,0)}else f("Jobposting","Error getting jobposting","danger")}catch(a){console.log(a),f("Jobposting","Error getting jobposting","danger")}},oe=()=>{I(!1),w(!1),E({jpf_id:"",jpfTitle:"",jpfType:"",jpfDesc:"",jpfSalaryMin:0,jpfSalaryMax:1,jpfLoc:"",jpfBnft:"",jpfReq:"",jpfSchedStart:new Date,jpfSchedEnd:new Date,jpfStatus:"active"})},pe=s=>{X(s.target.checked)},v=async(s,a)=>{try{u(!0);const c=P?await T(`/jobposting/search?query=${J}&page=${s}&limit=${a}`):await T(`/jobposting?page=${s}&limit=${a}`);c.status===200||c.status===201?(Z(c.data.data),k(c.data.currentPage),te(c.data.totalPages),u(!1)):(f("Jobposting","Error getting jobposting","danger"),console.log("Error: ",c.data),u(!1),b(!1))}catch(c){console.log(c)}},je=i.object({jpSearchInput:i.string().min(1,{message:"Search query is required"})}),{register:me,handleSubmit:fe,formState:{searchError:qe}}=A({resolver:$(je)}),xe=async s=>{try{b(!0),u(!0),L(s.jpSearchInput),v(1,S)}catch(a){console.log(a),u(!1),b(!1)}},he=()=>{b(!1),L(""),v(1,S)};return r.useEffect(()=>{const s=setTimeout(()=>{v(M,S)},500);return()=>clearTimeout(s)},[M,S,P,J]),e.jsx(e.Fragment,{children:e.jsxs(F,{className:"d-flex flex-column gap-3 mb-3",children:[e.jsx(n,{children:e.jsxs(h,{children:[e.jsx("h1",{children:"Job Postings"}),e.jsx("small",{className:"text-muted",children:"In this page, you can view all the job posting data, create new job postings, and edit existing job postings."})]})}),e.jsx(n,{children:e.jsx(F,{children:e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:x?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:x?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[x&&e.jsx(g,{content:"Reset Fields",placement:"top",children:e.jsx(m,{type:"button",onClick:()=>oe(),className:"btn btn-danger w-30",children:e.jsx(l,{icon:H})})}),x&&e.jsx(g,{content:"Print (unavailable)",placement:"top",children:e.jsx(m,{type:"button",className:"btn btn-info w-30",children:e.jsx(l,{icon:Se})})}),e.jsx(g,{content:y?"Collapse":"Expand",placement:"top",children:e.jsx(m,{type:"button",onClick:()=>w(!y),className:"btn btn-primary w-30",children:y?e.jsx(l,{icon:ve}):e.jsx(l,{icon:Ce})})})]})]})}),e.jsx(we,{visible:y,children:e.jsx(O,{children:e.jsxs(W,{onSubmit:ce(de),children:[e.jsx(n,{className:"visually-hidden",children:e.jsx("div",{children:e.jsx(j,{type:"text",id:"jpf_id",...d("jpf_id")})})}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfTitle",children:"Job Title"}),e.jsx(j,{type:"text",id:"jpfTitle",placeholder:"e.g. Software Engineer",...d("jpfTitle"),invalid:!!t.jpfTitle}),t.jpfTitle&&e.jsx(o,{invalid:!0,children:t.jpfTitle.message})]})}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfType",children:"Job Type"}),e.jsx(j,{type:"text",id:"jpfType",placeholder:"e.g. Full-time",...d("jpfType"),invalid:!!t.jpfType}),t.jpfType&&e.jsx(o,{invalid:!0,children:t.jpfType.message})]})}),e.jsx(n,{children:e.jsx("strong",{children:"Salary"})}),e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSalaryMin",children:"Minimum"}),e.jsx(j,{type:"number",id:"jpfSalaryMin",placeholder:"0",...d("jpfSalaryMin",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMin}),t.jpfSalaryMin&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMin.message})]})}),e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSalaryMax",children:"Maximum"}),e.jsx(j,{type:"number",id:"jpfSalaryMax",placeholder:"1",...d("jpfSalaryMax",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMax}),t.jpfSalaryMax&&e.jsx(o,{invalid:!0,children:t.jpfSalaryMax.message})]})})]}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfLoc",children:"Location"}),e.jsx(j,{type:"text",id:"jpfLoc",placeholder:"e.g. Manila",...d("jpfLoc"),invalid:!!t.jpfLoc}),t.jpfLoc&&e.jsx(o,{invalid:!0,children:t.jpfLoc.message})]})}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfDesc",children:"Description"}),e.jsx(_,{id:"jpfDesc",placeholder:"e.g. Job description details...",...d("jpfDesc"),invalid:!!t.jpfDesc}),t.jpfDesc&&e.jsx(o,{invalid:!0,children:t.jpfDesc.message})]})}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfBnft",children:"Benefits"}),e.jsx(_,{id:"jpfBnft",placeholder:"e.g. Dental Care",...d("jpfBnft"),invalid:!!t.jpfBnft}),t.jpfBnft&&e.jsx(o,{invalid:!0,children:t.jpfBnft.message})]})}),e.jsx(n,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfReq",children:"Requirements"}),e.jsx(_,{id:"jpfReq",placeholder:"e.g. Identification Documents",...d("jpfReq"),invalid:!!t.jpfReq}),t.jpfReq&&e.jsx(o,{invalid:!0,children:t.jpfReq.message})]})}),e.jsxs(n,{children:[e.jsx("strong",{children:"Deployment Schedule"}),e.jsx("p",{className:"text-muted small",children:"These parameters determine the duration of the job posting."})]}),e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSchedStart",children:"Start"}),e.jsx(j,{type:"date",id:"jpfSchedStart",defaultValue:C(ne),...d("jpfSchedStart",{valueAsDate:!0}),invalid:!!t.jpfSchedStart}),t.jpfSchedStart&&e.jsx(o,{invalid:!0,children:t.jpfSchedStart.message})]})}),e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"jpfSchedEnd",children:"Expire"}),e.jsx(j,{type:"date",id:"jpfSchedEnd",defaultValue:C(ie),...d("jpfSchedEnd",{valueAsDate:!0}),invalid:!!t.jpfSchedEnd}),t.jpfSchedEnd&&e.jsx(o,{invalid:!0,children:t.jpfSchedEnd.message})]})})]}),e.jsx("hr",{}),e.jsx(n,{children:e.jsxs("div",{className:"ml-5 mb-3 d-flex justify-content-end",children:[e.jsx(Me,{type:"checkbox",id:"invalidCheck",label:"I've reviewed the job posting and checked that all is correct. ",checked:q,onChange:pe}),e.jsx(o,{invalid:!0,children:"You must agree before submitting."})]})}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(m,{color:"primary",type:"submit",disabled:!q,className:"mb-3 w-25",children:x?"Update":"Add"})})})]})})})]})})}),e.jsx(n,{className:"d-flex gap-2 justify-content-between align-items-center",children:e.jsx(F,{children:e.jsx(W,{onSubmit:fe(xe),className:"d-flex flex-row gap-2 justify-content-end align-items-center",children:e.jsxs(Ee,{children:[e.jsx(j,{type:"text",id:"jpSearchInput",placeholder:"...",...me("jpSearchInput"),invalid:!!t.jpSearchInput}),e.jsx(g,{content:"Search",placement:"top",children:e.jsx(m,{type:"submit",className:"btn btn-primary",children:e.jsx(l,{icon:Ne})})}),e.jsx(g,{content:"Reset",placement:"top",children:e.jsx(m,{onClick:()=>he(),type:"button",className:"btn btn-primary",children:e.jsx(l,{icon:H})})})]})})})}),e.jsxs(n,{children:[ee?e.jsx("div",{className:"pt-3 text-center",children:e.jsx(ge,{color:"primary",variant:"grow"})}):e.jsx("div",{children:ae==="grid"?e.jsx(n,{xs:{cols:1},md:{cols:3},className:"g-3",children:R.map(s=>s?e.jsx(h,{children:e.jsxs(K,{className:"mb-3 h-100",children:[e.jsx(Q,{className:"fw-bold text-uppercase text-primary",children:e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]})}),e.jsx(O,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-between",children:[e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(l,{icon:G}),e.jsx("p",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(l,{icon:z}),e.jsxs("p",{children:[N(s.schedule_start)," -"," ",N(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(l,{icon:U}),e.jsxs("p",{children:[D(s.salary_min)," -"," ",D(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:Y(s.description,150)})]})]})}),e.jsx(Te,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(m,{onClick:()=>B(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(l,{icon:V}),"Edit"]})})})]})},s._id):e.jsx("div",{children:"Loading"},Math.random()))}):e.jsx("ul",{className:"list-group list-group-flush",children:R.map(s=>s?e.jsxs("li",{className:"list-group-item",children:[e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-bg-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]}),e.jsxs("div",{children:[e.jsx(l,{icon:G,className:"me-2"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{children:[e.jsx(l,{icon:z,className:"me-2"}),e.jsxs("span",{children:[N(s.schedule_start)," -"," ",N(s.schedule_end)]})]}),e.jsxs("div",{children:[e.jsx(l,{icon:U,className:"me-2"}),e.jsxs("span",{children:[D(s.salary_min)," - ",D(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:Y(s.description,150)})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(m,{onClick:()=>B(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(l,{icon:V}),"Edit"]})})})]},s._id):null)})}),e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(De,{currentPage:M,totalPages:se,onPageChange:k})})]})]})})};export{Oe as default};
