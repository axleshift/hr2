import{r as e}from"./react-router-dom-BnDDw25P.js";import{F as i,A as n,B as r}from"./index.es-CQWNrdDz.js";import{j as t,a,g as l,x as s,v as o,p as d,A as c,F as m,k as h,w as u}from"./index-idxjfpO7.js";import{t as p,f as v,b as f}from"./index-DCO1bnrX.js";import b from"./EventForm-smaw0pay.js";import{u as y}from"./react-hook-form-DB8hWBdy.js";import{z as g}from"./zod-B0zZW6rS.js";import{s as w}from"./@hookform/resolvers/zod-1wp20Skh.js";import{J as C}from"./JobOfferForm-B8dJwS-l.js";import{C as j,a as x,b as S}from"./CModalHeader-CdUpBEI3.js";import{C as N}from"./CModalTitle-Ccg3gLsQ.js";import{C as q,a as k}from"./CRow-DEvZ4-I-.js";import{C as E,b as I,a as O}from"./CFormLabel-DfytgIE9.js";import{C as F}from"./CFormInput-DlBYdvLv.js";import{C as T}from"./CFormSelect-FCYyv5dO.js";import{C as A}from"./CFormRange-Dv1JNhk3.js";import{C as R}from"./CFormTextarea-DTox_qbu.js";import{C as V}from"./CContainer-HvLLCUu_.js";import{C as z}from"./CInputGroup-D6uFn-TN.js";import{C as J,a as P}from"./CCardBody-BkAZIxub.js";import{C as _,a as D,b as $,c as L,d as M,e as G}from"./CTable-BPy7g7FN.js";import{C as H}from"./CTooltip-BYrF9prw.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./AppPagination-C6YUkUGB.js";import"./CTabList-Djf28u4z.js";import"./DefaultLayout-BuWzCyjW.js";import"./index.esm-CNiLTC84.js";import"./isRTL-D5ORmfro.js";import"./ConfirmationDialog-BOkCSt8-.js";import"./CCardHeader-D-6_OVlZ.js";import"./CFormCheck-ClI9EWhj.js";const Q=g.object({date:g.string().nonempty("Date is required"),job:g.string().min(3,{message:"Job is required"}),type:g.enum(["Phone","Video","In-Person"]),general:g.object({communication:g.number().min(1).max(5).default(1),technical:g.number().min(1).max(5).default(1),problemSolving:g.number().min(1).max(5).default(1),culturalFit:g.number().min(1).max(5).default(1),workExperienceRelevance:g.number().min(1).max(5).default(1),leadership:g.number().min(1).max(5).default(1)}),questions:g.array(g.object({question:g.string().min(1,{message:"A question is required."}),remark:g.string().optional()})).optional(),salaryExpectation:g.coerce.number().min(1).default(1),strength:g.string().optional(),weakness:g.string().optional(),recommendation:g.enum(["yes","no","need further review"]),finalComments:g.string().optional()}),B=({isVisible:i,onClose:n,state:r,interview:d})=>{var c,m,h,u,p;const[v,f]=e.useState(!1),[b,g]=e.useState({}),[V,z]=e.useState("view"),[J,P]=e.useState(!1),[_,D]=e.useState("create"),[$,L]=e.useState(!1),{register:M,handleSubmit:G,reset:H,setValue:B,watch:W,formState:{errors:Y},control:Z}=y({resolver:async(e,i,n)=>await w(Q)(e,i,n)});return e.useEffect((()=>{P("edit"!==r)}),[r]),e.useEffect((()=>{if(v&&d){let e="";if(d.date){e=new Date(d.date).toISOString().split("T")[0]}const i={...d,date:e};g(d),H(i)}}),[v,d,H]),e.useEffect((()=>{i&&f(i)}),[i]),t(j,{visible:v,onClose:()=>{n(),f(!1)},backdrop:"static",size:"xl",children:[a(x,{children:a(N,{children:"edit"===V?"Edit Interview":"Interview Form"})}),t(S,{children:[a(q,{children:a(k,{children:t(E,{onSubmit:G((async e=>{try{"edit"===V?await s(`/applicant/interview/${b._id}`,e):await o("/applicant/interview",e);n()}catch(i){}})),children:[t(q,{className:"mb-3",children:[t(k,{children:[a(I,{children:"Date"}),a(F,{type:"date",...M("date"),readOnly:J,invalid:Y.date}),Y.date&&a(O,{children:Y.date.message})]}),t(k,{children:[a(I,{children:"Interview Type"}),t(T,{disabled:J,...M("type"),invalid:Y.type,children:[a("option",{value:"",children:"Select Type"}),a("option",{value:"Phone",children:"Phone"}),a("option",{value:"Video",children:"Video"}),a("option",{value:"In-Person",children:"In-Person"})]}),Y.type&&a(O,{children:Y.type.message})]}),t(k,{children:[a(I,{children:"Interviewer"}),a(F,{readOnly:J,defaultValue:`${null==(c=d.interviewer)?void 0:c.lastname}, ${null==(m=d.interviewer)?void 0:m.firstname}`})]})]}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a("h5",{children:"General Evaluation"}),["communication","technical","problemSolving","culturalFit","workExperienceRelevance","leadership"].map((e=>{var i,n,r,l;return t("div",{children:[a("label",{className:"text-capitalize",children:e.replace(/([A-Z])/g," $1")}),a(A,{min:1,max:5,disabled:J,...M(`general.${e}`),invalid:null==(i=null==Y?void 0:Y.general)?void 0:i[e]}),(null==(n=null==Y?void 0:Y.general)?void 0:n[e])&&a(O,{children:null==(l=null==(r=null==Y?void 0:Y.general)?void 0:r[e])?void 0:l.message})]},e)}))]})}),a(q,{className:"mb-3",children:t(k,{children:[a(F,{label:"Position / Job Applied For",readOnly:J,...M("job"),invalid:Y.job}),Y.job&&a(O,{children:Y.job.message})]})}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a("h5",{children:"Interview Questions"}),null==(h=W("questions"))?void 0:h.map(((e,i)=>{var n,r,l,s,o,d,c;return t("div",{children:[a(q,{className:"mb-3",children:t(k,{children:[a(I,{children:"Question"}),a(F,{readOnly:J,...M(`questions.${i}.question`),invalid:null==(r=null==(n=null==Y?void 0:Y.questions)?void 0:n[i])?void 0:r.question}),(null==(s=null==(l=null==Y?void 0:Y.questions)?void 0:l[i])?void 0:s.question)&&a(O,{children:null==(c=null==(d=null==(o=null==Y?void 0:Y.questions)?void 0:o[i])?void 0:d.question)?void 0:c.message})]})}),a(q,{className:"mb-3",children:t(k,{children:[a(I,{children:"Remark"}),a(R,{readOnly:J,...M(`questions.${i}.remark`)})]})})]},i)}))]})}),t(q,{className:"mb-3",children:[t(k,{xs:"12",sm:"6",children:[a(I,{children:"Salary Expectation"}),a(F,{type:"number",readOnly:J,...M("salaryExpectation"),invalid:Y.salaryExpectation}),Y.salaryExpectation&&a(O,{children:Y.salaryExpectation.message})]}),t(k,{xs:"12",sm:"6",children:[a(I,{children:"Recommendation"}),t(T,{disabled:J,...M("recommendation"),invalid:Y.recommendation,children:[a("option",{value:"yes",children:"Yes"}),a("option",{value:"no",children:"No"}),a("option",{value:"need further review",children:"Need further review"})]}),Y.recommendation&&a(O,{children:Y.recommendation.message})]})]}),a(q,{className:"mb-3",children:t(k,{children:[a(I,{children:"Strength"}),a(R,{readOnly:J,...M("strength")})]})}),a(q,{className:"mb-3",children:t(k,{children:[a(I,{children:"Weakness"}),a(R,{readOnly:J,...M("weakness")})]})}),a(q,{className:"mb-3",children:t(k,{xs:"12",children:[a(I,{children:"Final Comments"}),a(R,{readOnly:J,...M("finalComments")})]})})]})})}),a(q,{children:a(k,{className:"d-flex justify-content-end",children:a(l,{color:"warning",size:"sm",disabled:null==(u=d.applicant)?void 0:u.isJobOffer,onClick:()=>{D("create"),L(!0)},children:(null==(p=d.applicant)?void 0:p.isJobOffer)?"Job offer already Exists":"Issue a Job Offer"})})}),a(q,{children:a(k,{children:a(C,{isVisible:$,state:_,onClose:()=>{L(!1)},interview:b})})})]})]})};B.propTypes={isVisible:d.bool.isRequired,onClose:d.func.isRequired,state:d.string,interview:d.object.isRequired};const W=()=>{const{userInformation:s}=e.useContext(c),[o,d]=e.useState([]),[y,g]=e.useState(!1),[w,C]=e.useState(!1),[j,x]=e.useState("view"),[S,N]=e.useState({}),[I,O]=e.useState(1),[T,A]=e.useState(9),[R,Q]=e.useState(0),[W,Y]=e.useState(0),[Z,K]=e.useState([]),[U,X]=e.useState(!1),[ee,ie]=e.useState(1),[ne,re]=e.useState(9),[te,ae]=e.useState(0),[le,se]=e.useState(0),[oe,de]=e.useState(!1),[ce,me]=e.useState({}),[he,ue]=e.useState("view"),[pe,ve]=e.useState({}),[fe,be]=e.useState({}),ye=async()=>{try{g(!0);const e=await u("/facilities/events/upcoming");200===e.status&&(d(e.data.data),g(!1))}catch(e){g(!1)}},ge=async()=>{try{X(!0);const e=await u("/applicant/interview/recent");200===e.status&&K(e.data.data)}catch(e){}finally{X(!1)}};return e.useEffect((()=>{const e=setTimeout((()=>{ye(),ge()}),500);return()=>clearTimeout(e)}),[I,R,W]),a(m,{children:t(V,{children:[a(q,{className:"mb-3",children:t(k,{children:[a("h2",{children:"Interviews & Other Events"}),t("small",{children:["In this page, you can ",a("span",{className:"text-info",children:"view"})," and"," ",a("span",{className:"text-warning",children:"edit"})," the list of upcoming interviews and events."]})]})}),a(q,{className:"mb-3",children:a(k,{children:a(E,{children:t(z,{children:[a(F,{type:"search",placeholder:"Search...","aria-label":"Search"}),a(l,{type:"button",color:"primary",children:a(i,{icon:n})}),a(l,{type:"button",color:"primary",onClick:()=>{ye()},children:a(i,{icon:r})})]})})})}),a(q,{className:"mb-3",children:a(k,{children:a(J,{children:a(P,{children:t(_,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[a(D,{children:t($,{children:[a(L,{children:"#"}),a(L,{children:"Event"}),a(L,{children:"Author"}),a(L,{children:"Type"}),a(L,{children:"Date"}),a(L,{children:"Timeslot"}),a(L,{children:"Participants"}),a(L,{children:"Approved"}),a(L,{children:"Actions"})]})}),a(M,{children:y?a($,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:a(h,{variant:"grow",size:"sm"})})})}):0===o.length?a($,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:"No upcoming events found"})})}):o.map((e=>{var i,n,r;return t($,{children:[a(H,{placement:"top",content:e._id,children:a(G,{children:p(e._id,10)})}),a(G,{children:e.name}),t(G,{children:[e.author.lastname,", ",e.author.firstname]}),a(G,{children:e.type}),a(G,{children:v(e.date)}),t(G,{children:[f(null==(i=e.timeslot)?void 0:i.start)," - ",f(null==(n=e.timeslot)?void 0:n.end)," "]}),a(G,{children:a("div",{className:"d-flex justify-content-center",children:null==(r=e.participants)?void 0:r.length})}),a(G,{children:e.isApproved.status?a("span",{className:"text-success",children:"Approved"}):a("small",{className:"text-danger",children:"Requires Approval"})}),a(G,{children:t("div",{className:"d-flex gap-2 flex-row",children:[a(l,{color:"info",size:"sm",onClick:()=>{x("view"),C(!0),N(e.timeslot)},children:"View"}),("admin"===s.role||"manager"===s.role)&&a(l,{color:"warning",size:"sm",onClick:()=>{x("edit"),C(!0),N(e.timeslot)},children:"Manage"})]})})]},e._id)}))})]})})})})}),a("hr",{}),a(q,{children:a(k,{children:a("h2",{children:"Recent Interviews"})})}),a(q,{className:"mb-3",children:a(k,{children:a(J,{children:a(P,{children:t(_,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[a(D,{children:t($,{children:[a(L,{children:"#"}),a(L,{children:"Applicant"}),a(L,{children:"Interviewer"}),a(L,{children:"Type"}),a(L,{children:"Date"}),a(L,{children:"Recommendation"}),a(L,{children:"Action"})]})}),a(M,{children:U?a($,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:a(h,{variant:"grow",size:"sm"})})})}):0===Z.length?a($,{children:a(G,{colSpan:"12",children:a("div",{className:"d-flex justify-content-center",children:"No recent interviews found"})})}):Z.map((e=>{var i,n,r,s;return t($,{children:[a(H,{placement:"top",content:e._id,children:a(G,{children:p(e._id,10)})}),t(G,{children:[null==(i=e.applicant)?void 0:i.lastname,", ",null==(n=e.applicant)?void 0:n.firstname]}),t(G,{children:[null==(r=e.interviewer)?void 0:r.lastname,", ",null==(s=e.interviewer)?void 0:s.firstname]}),a(G,{children:e.type}),a(G,{children:v(e.date)}),a(G,{className:"text-capitalize",children:e.recommendation}),a(G,{children:a(l,{color:"warning",size:"sm",onClick:()=>{me(e),ue("view"),de(!0)},children:"Manage"})})]},e._id)}))})]})})})})}),a(q,{children:a(k,{children:a(b,{isVisible:w,onClose:()=>{x("view"),C(!1),ye(),ge()},state:j,slot:S})})}),a(q,{children:a(k,{children:a(B,{isVisible:oe,onClose:()=>de(!1),state:he,interview:ce})})})]})})};export{W as default};
