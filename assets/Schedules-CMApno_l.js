import{A as e}from"./AppPagination-DHwVwpgj.js";import{F as t,f as a,T as i,S as s,M as n,O as r,U as l,V as c,A as d,W as o,H as m,X as h}from"./index.es-DOS6LnW0.js";import{C as u}from"./Calendar-CCbMzOU7.js";import{R as p,r as f}from"./react-router-dom-BnDDw25P.js";import{j as g,a as b,g as v,k as y,p as C,m as S,F as w,w as N,y as x,v as D,x as j}from"./index-CDLNWkH1.js";import{u as T}from"./react-hook-form-DGCwHb0C.js";import{s as I}from"./@hookform/resolvers/zod-B5rlnuQ9.js";import{z as k}from"./zod-B0zZW6rS.js";import{C as E,a as A,b as q}from"./CModalHeader-BPWZasYS.js";import{C as F}from"./CModalTitle-CsGDx1ZU.js";import{C as R,a as M,b as V}from"./CFormLabel-CMB5m-Mb.js";import{C as L,a as $}from"./CRow-Dv7ylWmi.js";import{C as O}from"./CInputGroup-C27gicSC.js";import{C as P}from"./CInputGroupText-DDvQEynS.js";import{C as Y}from"./CFormInput-Cpt_AbLV.js";import{C as _}from"./CModalFooter-BHClG5Je.js";import{U,c as z,f as G,t as H}from"./index-BVfmz2P_.js";import{C as B,b as W,c as X,d as J,e as Q}from"./DefaultLayout-Bslh-jLE.js";import{C as K}from"./CTooltip-SIOmR3yQ.js";import{C as Z}from"./CFormTextarea-B0-u4bLx.js";import{C as ee}from"./CFormCheck-eVgFPiBg.js";import{C as te}from"./CContainer-C8s0HPSv.js";import{C as ae,a as ie}from"./CCardBody-BPxuaxuA.js";import{C as se,a as ne,b as re,c as le,d as ce,e as de}from"./CTable-DT2N_H1o.js";import{C as oe}from"./CButtonGroup-BamaSsju.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./index.esm-JfIxWHlD.js";import"./isRTL-D5ORmfro.js";const me=({isVisible:e,onClose:t,handleTimeSubmit:a,isLoading:i})=>{const[s,n]=p.useState(!1),[r,l]=p.useState(!1),c=k.object({start:k.string().min(1,{message:"Start time is required"}),end:k.string().min(1,{message:"End time is required"})}),{register:d,handleSubmit:o,formState:{errors:m}}=T({resolver:I(c)});return f.useEffect((()=>{n(e),l(i)}),[e,i]),g(E,{visible:e,onClose:()=>{t(),n(!1)},size:"sm",children:[b(A,{children:b(F,{children:"Add Timeslot"})}),b(q,{children:g(R,{onSubmit:o(a),children:[b(L,{children:b($,{children:g(O,{className:"mb-3",children:[b(P,{children:"Start Time"}),b(Y,{type:"time",...d("start"),invalid:!!m.start}),m.start&&b(M,{invalid:!0,children:m.start.message})]})})}),b(L,{children:b($,{children:g(O,{className:"mb-3",children:[b(P,{children:"End Time"}),b(Y,{type:"time",...d("end"),invalid:!!m.end}),m.end&&b(M,{invalid:!0,children:m.end.message})]})})}),g(_,{children:[b(v,{type:"submit",className:"btn btn-primary",children:r?b(y,{color:"primary"}):"Add Time"}),b(v,{color:"secondary",onClick:t,children:"Cancel"})]})]})})]})};me.propTypes={isVisible:C.bool.isRequired,onClose:C.func.isRequired,handleTimeSubmit:C.func.isRequired,isLoading:C.bool.isRequired};const he=({isVisible:e,onClose:d,isDarkMode:o,interviewData:m})=>{const h=new Date((new Date).setDate((new Date).getDate()-1)),{addToast:p}=f.useContext(S),[y,C]=f.useState(U(new Date)),[H,te]=f.useState(!1),[ae,ie]=f.useState(!1),[se,ne]=f.useState({}),[re,le]=f.useState({}),[ce,de]=f.useState(""),[oe,he]=f.useState([]),[ue,pe]=f.useState([]),[fe,ge]=f.useState(!1),[be,ve]=f.useState(null),[ye,Ce]=f.useState(!1),[Se,we]=f.useState([new Date(2024,10,15),new Date(2024,10,20)]),[Ne,xe]=f.useState([new Date(2024,10,1),new Date(2024,10,5)]),[De,je]=f.useState(1),[Te,Ie]=f.useState(9),[ke,Ee]=f.useState(1),Ae=k.object({title:k.string().min(1,{message:"Title is required"}),date:k.preprocess((e=>new Date(e)),k.date().min(h,{message:"Date should be today or later"})),timeslotId:k.string().optional(),start:k.string().min(1,{message:"Start time is required"}),end:k.string().min(1,{message:"End time is required"}),location:k.string().optional(),capacity:k.preprocess((e=>parseInt(e)),k.number().min(1,{message:"Capacity should be at least 1"})),additionalInfo:k.string().optional()}),{register:qe,handleSubmit:Fe,reset:Re,formState:{errors:Me}}=T({resolver:async(e,t,a)=>await I(Ae)(e,t,a)}),Ve=k.object({start:k.string().min(1,{message:"Start time is required"}),end:k.string().min(1,{message:"End time is required"})}).refine((async e=>{const[t,a]=e.start.split(":").map(Number),[i,s]=e.end.split(":").map(Number);return 60*t+a<60*i+s}),{message:"Start time should be before end time",path:["start"]}),{register:Le,handleSubmit:$e,formState:{errors:Oe}}=T({resolver:async(e,t,a)=>await I(Ve)(e,t,a)}),Pe=async e=>{try{const t=await N(`/interview/slots?date=${e}`);if(200===t.status){const e=t.data;he(e.data);const a=e.data.filter((e=>e.isAvailable));pe(a)}else p("Error","Failed to fetch time slots","danger")}catch(t){he([]),pe([])}},Ye=()=>{Re({applicantId:"",applicantName:"",date:new Date,start:null,end:null}),d()};return f.useEffect((()=>{Pe(U(y))}),[y]),f.useEffect((()=>{m&&(ie(!0),C(new Date(m.date)),Re({title:m.title,timeslotId:m.timeslot._id,start:z(m.timeslot.start),end:z(m.timeslot.end),location:m.location,additionalInfo:m.additionalInfo}))}),[m]),g(w,{children:[g(E,{visible:e,onClose:Ye,size:"lg",children:[b(A,{children:b(F,{children:ae?"Edit Interview":"Schedule Interview"})}),g(q,{children:[b("div",{className:"mb-5",children:b(u,{onChange:e=>{C(new Date(e))},defaultValue:y,className:o?"calendar dark-mode":"calendar",tileClassName:({date:e,view:t})=>"month"===t&&Se.find((t=>t.getDate()===e.getDate()))?"not-available":Ne.find((t=>t.getDate()===e.getDate()))?"has-events":""})}),g(R,{onSubmit:Fe((async e=>{try{const t={date:y,title:e.title,timeslotRef_id:e.timeslotId,additionalInfo:e.additionalInfo,location:e.location,capacity:e.capacity},a=ae?await j(`/interview/schedule/${m._id}`,t):await D("/interview/schedule",t);200===a.status||201===a.status?(p("Success","Interview scheduled successfully","success"),Ye()):p("Calendar | Schedule Form",a.message.message,"danger")}catch(t){p("Error","Failed to schedule interview","danger")}})),children:[b(L,{children:g($,{children:[g(O,{className:"mb-3",children:[b(P,{children:b(t,{icon:a})}),b(Y,{type:"text",placeholder:"Title",...qe("title"),invalid:!!Me.title})]}),Me.title&&b(M,{invalid:!0,children:Me.title.message})]})}),oe&&0!==oe.length?g(w,{children:[b(L,{children:b($,{children:b(V,{children:"Time Slots"})})}),b(L,{children:b($,{className:"d-flex flex-wrap gap-2 justify-content-start",children:oe.map(((e,a)=>b("div",{className:"mb-3",children:g(B,{color:e.isAvailable?"success":"danger",children:[z(e.start)," -"," ",z(e.end)," ",b(K,{content:e.isAvailable?"Available":"Not Available",placement:"top",children:b(t,{icon:e.isAvailable?i:s})}),b(K,{content:"Delete Time Slot",placement:"top",children:b(v,{onClick:()=>(async e=>{try{200===(await x(`/interview/slot/${e}`)).status?(p("Success","Time slot deleted successfully","success"),Pe(y)):p("Error","Something went wrong. Unable to delete time slot.","danger")}catch(t){}})(e._id),className:"btn",children:b(t,{icon:n})})})]})},a)))})})]}):b(L,{className:"text-danger",children:b($,{children:b(V,{children:"Click a Date to view its timeslot, if none.. add one."})})}),b(L,{children:b($,{className:"d-flex justify-content-end align-items-center",children:b(K,{content:"Add Time Slot",placement:"top",children:b(v,{onClick:()=>ge(!0),className:"btn btn-success mb-3",children:b(t,{icon:r})})})})}),g(L,{children:[b($,{md:4,children:g(O,{className:"mb-3",children:[b(P,{children:"Date"}),b(Y,{type:"text",...qe("date"),invalid:!!Me.date,value:G(y),readOnly:!0,className:"visually-hidden"}),b(Y,{type:"text",invalid:!!Me.date,value:G(y),readOnly:!0}),Me.date&&b(M,{invalid:!0,children:Me.date.message})]})}),b($,{md:8,children:g(O,{className:"mb-3",children:[b(P,{children:b(t,{icon:l})}),b(Y,{type:"text",placeholder:"Start Time",readOnly:!0,...qe("start"),invalid:!!Me.start}),Me.start&&b(M,{invalid:!0,children:Me.start.message}),b(Y,{type:"text",placeholder:"End Time",readOnly:!0,...qe("end"),invalid:!!Me.end}),Me.end&&b(M,{invalid:!0,children:Me.end.message}),b(K,{content:"Set Time Slot",placement:"top",children:g(W,{children:[b(X,{color:"primary",children:"Time"}),b(J,{children:ue.map(((e,t)=>g(Q,{onClick:()=>{ve(e),Re({timeslotId:e._id,start:z(e.start),end:z(e.end)})},disabled:0===ue.length,children:[z(e.start)," -"," ",z(e.end)]},t)))})]})})]})})]}),b(L,{children:b($,{children:g(O,{className:"mb-3",children:[b(P,{children:"Location"}),b(Y,{type:"text",placeholder:"Location",...qe("location"),invalid:!!Me.location}),Me.location&&b(M,{invalid:!0,children:Me.location.message})]})})}),b(L,{children:b($,{children:g(O,{className:"mb-3",children:[b(P,{children:"Capacity"}),b(Y,{type:"number",placeholder:"capacity ",...qe("capacity"),invalid:!!Me.capacity,defaultValue:1}),Me.capacity&&b(M,{invalid:!0,children:Me.capacity.message})]})})}),b(L,{children:b($,{children:g(O,{className:"mb-3",children:[b(P,{children:b(t,{icon:c})}),b(Z,{type:"text",placeholder:"Additional Information",...qe("additionalInfo"),invalid:!!Me.additionalInfo}),Me.additionalInfo&&b(M,{invalid:!0,children:Me.additionalInfo.message})]})})}),b(L,{children:g($,{className:"d-flex justify-content-end",children:[b(ee,{type:"checkbox",id:"invalidCheck",label:"I confirm everything is correct.",checked:H,onChange:()=>te(!H)}),b(M,{invalid:!0,children:"You must agree before submitting."})]})}),g(_,{children:[b(v,{type:"submit",disabled:!H,className:"btn btn-primary",children:ae?"Update":"Schedule"}),b(v,{color:"secondary",onClick:Ye,children:"Cancel"})]})]})]})]}),b(me,{isVisible:fe,onClose:()=>{ge(!1)},handleTimeSubmit:async e=>{Ce(!0);try{const t={date:y,timeslot:{start:e.start,end:e.end}},a=await D("/interview/slots/",t);200===a.status||201===a.status?(p("Success","Time slot added successfully","success"),Pe(y),Ce(!1)):p("Calendar | Timeslots",a.message.message,"danger")}catch(t){Ce(!1)}},isLoading:ye})]})};he.propTypes={isVisible:C.bool.isRequired,onClose:C.func.isRequired,isDarkMode:C.bool.isRequired,interviewData:C.object};const ue=({theme:a})=>{const i="dark"===a,{addToast:s}=f.useContext(S),[l,c]=f.useState(!1),[p,C]=f.useState([new Date,new Date]),[D,j]=f.useState(U(new Date)),[T,I]=f.useState(new Date),[k,E]=f.useState([]),[A,q]=f.useState(!1),[F,M]=f.useState([new Date(2024,10,15),new Date(2024,10,20)]),[V,P]=f.useState([new Date(2024,10,1),new Date(2024,10,5)]),[_,W]=f.useState(!1),[X,J]=f.useState(1),[Q,Z]=f.useState(9),[ee,me]=f.useState(1),[ue,pe]=f.useState([]),[fe,ge]=f.useState(null),[be,ve]=f.useState([{color:"danger",text:"Not Available"},{color:"warning",text:"Has Events"},{color:"primary",text:"Selected Date"}]),ye=async e=>{q(!0);try{const t=await N(`/interview/all?date=${e}&page=${X}&limit=${Q}`);200===t.status||201===t.status?(pe(t.data.data),E(t.data.slots),me(t.data.totalPages),q(!1)):(q(!1),pe([]),E([]),s("Calendar | Schedules",t.message.message,"danger"))}catch(t){const a=`Failed to fetch interview schedules for ${G(e)}`;s("Error",a,"error"),q(!1)}};return f.useEffect((()=>{const e=setTimeout((()=>{ye(D)}),1e3);return()=>clearTimeout(e)}),[D]),f.useEffect((()=>{_&&fe&&W(!1)}),[X]),b(w,{children:g(te,{className:"d-flex flex-column gap-3",children:[b(L,{children:g($,{children:[b("h2",{children:"Schedules"}),b("small",{children:"In this page, you can create and edit schedules for interviews, task, or any other events."})]})}),b(L,{children:b(te,{children:b(ae,{children:g(ie,{children:[b("div",{children:be.map(((e,t)=>b(B,{color:e.color,className:"me-2",children:e.text},t)))}),b("div",{children:b(u,{onChange:e=>{e.length>1?C(e):j(e)},selectRange:l,className:i?"calendar dark-mode":"calendar",tileClassName:({date:e,view:t})=>"month"===t&&F.find((t=>t.getDate()===e.getDate()))?"not-available":V.find((t=>t.getDate()===e.getDate()))?"has-events":"",defaultValue:l?[new Date(p[0]),new Date(p[1])]:new Date(D)})}),b("br",{}),b("div",{children:g(O,{children:[b(Y,{type:"text",placeholder:"start",value:G(D),readOnly:!0}),b(K,{content:"Create interview",placement:"top",children:b(v,{onClick:()=>W(!0),className:"btn btn-primary",children:b(t,{icon:r})})})]})})]})})})}),b(L,{children:b($,{children:b(R,{children:g(O,{children:[b(Y,{type:"text",placeholder:"Search"}),b(v,{color:"primary",children:b(t,{icon:d})})]})})})}),b(L,{children:b($,{children:b(ae,{children:b(ie,{children:g(se,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[b(ne,{children:g(re,{children:[b(le,{className:"text-center",children:b(t,{icon:o})}),b(le,{className:"text-center",children:"Date"}),b(le,{className:"text-center",children:"Time"}),b(le,{className:"text-center",children:"Location"}),b(le,{className:"text-center",children:"Capacity"}),b(le,{className:"text-center",children:"Action"})]})}),b(ce,{children:A?b(re,{children:b(de,{colSpan:"6",className:"text-center",children:b(y,{color:"primary",variant:"grow"})})}):0===ue.length?b(re,{children:g(de,{colSpan:"6",className:"text-center",children:["No data available for"," ",b("span",{className:"text-info",children:G(D,"MMM d, YYYY")})]})}):ue.map(((e,a)=>g(re,{children:[b(de,{className:"text-center",children:e.title}),b(de,{className:"text-center",children:G(e.date)}),g(de,{className:"text-center",children:[z(e.timeslot.start)," -"," ",z(e.timeslot.end)]}),b(de,{className:"text-center",children:e.location?H(e.location,20):"N/A"}),b(de,{className:"text-center",children:e.capacity?H(e.capacity,20):"N/A"}),b(de,{className:"text-center",children:g(oe,{children:[g(v,{onClick:()=>{ge(e),W(!0)},className:"btn btn-primary",children:[b(K,{content:"Edit",placement:"top",children:b(t,{icon:m})})," "]}),g(v,{onClick:()=>(async e=>{try{200===(await x(`/interview/schedule/${e}`)).status?(s("Success","Successfully deleted interview schedule","success"),ye(D)):s("Error","Failed to delete interview schedule","error")}catch(t){s("Error","Failed to delete interview schedule","error")}})(e._id),className:"btn btn-danger",children:[b(K,{content:"Delete",placement:"top",children:b(t,{icon:n})})," "]}),b(v,{className:"btn btn-warning",children:b(K,{content:"Cancel",placement:"top",children:b(t,{icon:h})})})]})})]},a)))})]})})})})}),b(L,{children:b($,{children:b("div",{className:"d-flex justify-content-center align-items-center",children:b(e,{currentPage:X,totalPages:ee,onPageChange:J})})})}),b(L,{children:b(he,{isVisible:_,onClose:()=>W(!1),isDarkMode:i,interviewData:fe})})]})})};ue.propTypes={theme:C.string};export{ue as default};
