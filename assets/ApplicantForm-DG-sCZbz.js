import{C as e}from"./Calendar-DshA2L6-.js";import{l as t,f as a,i as l,v as n,P as r}from"./index-DXFVtbD_.js";import{R as c,r as s}from"./react-router-dom-BnDDw25P.js";import{U as m,f as i,t as o,c as d}from"./index-BxAblS3e.js";import{A as E}from"./AppPagination-vWC6_7LU.js";import{F as u,I as p}from"./index.es-DFhey9wz.js";import{C as f,a as N,b as x}from"./CModalHeader-CKCWLB_J.js";import{C as h}from"./CModalTitle-RZUDuE-6.js";import{C as v}from"./CContainer-CzB7k1pT.js";import{C,a as g}from"./CRow-DSqRsHFr.js";import{a as y,C as b}from"./CFormInput-BzSWZSHN.js";import{C as S,a as j,b as w,c as _}from"./CTabList-C9bvSHUL.js";import{a as D}from"./DefaultLayout-k-e4BEYF.js";import{C as k}from"./CInputGroup-8Ah49MHR.js";import{C as A}from"./CTooltip-BHXnOH2f.js";import{C as T,a as I,b as M,c as P,d as F,e as K}from"./CTable-CpB37DUJ.js";const R=({isVisible:r,onClose:R,isDarkMode:z,applicantData:Y})=>{const{addToast:H}=c.useContext(t),[L,V]=s.useState({}),[q,O]=s.useState(!1),[$,W]=s.useState(m(new Date)),[G,Q]=s.useState([]),[U,X]=s.useState([]),[B,J]=s.useState([]),[Z,ee]=s.useState([]),[te,ae]=s.useState(1),[le,ne]=s.useState(10),[re,ce]=s.useState(1),se=e=>e.sort(((e,t)=>{const a=new Date(e.date)-new Date(t.date);if(0!==a)return a;const l=e.timeslot.start.split(":").map(Number),n=t.timeslot.start.split(":").map(Number);return 60*l[0]+l[1]-(60*n[0]+n[1])})),me=e=>{J((t=>({...t,[e]:!t[e]})))};return s.useEffect((()=>{(async e=>{O(!0);try{const t=await n(`/interview/all?date=${e}&page=${te}&limit=${le}`);if(200===t.status){const e=se(t.data.data);Q(e),J(new Array(t.data.data.length).fill(!1)),ae(t.data.currentPage),ce(t.data.totalPages),O(!1)}else O(!1),H("Calendar | Scheduling Form",t.message.message,"danger")}catch(t){O(!1)}})($)}),[$,te,le]),s.useEffect((()=>{Y&&V(Y)}),[Y]),c.createElement(f,{visible:r,onClose:()=>{R(),W(m(new Date)),ee([])},size:"xl"},c.createElement(N,null,c.createElement(h,null,c.createElement("div",null,"Schedule Interview for"," ",c.createElement("span",{className:"fw-bold"},null==Y?void 0:Y.lastname,", ",null==Y?void 0:Y.firstname)))),c.createElement(x,null,c.createElement(v,null,c.createElement(C,{className:"mb-3"},c.createElement(g,null,c.createElement("div",null,c.createElement(e,{onChange:e=>{W(e)},defaultValue:$,className:z?"calendar dark-mode":"calendar"})))),c.createElement(C,{className:"mb-3"},c.createElement(g,null,c.createElement(y,{type:"text",id:"date",name:"date",placeholder:"Date",value:i($),readOnly:!0}))),c.createElement(C,{className:"mb-3"},c.createElement(g,null,c.createElement("h2",null,"Events"),c.createElement("small",null,"Pick an event to schedule an interview for"," ",c.createElement("span",{className:"text-info"},null==Y?void 0:Y.lastname,", ",null==Y?void 0:Y.firstname)))),c.createElement(C,{className:"mb-3"},c.createElement(g,null,c.createElement(S,{activeItemKey:"events"},c.createElement(j,{variant:"underline-border"},c.createElement(w,{itemKey:"events"},"Events"),c.createElement(w,{itemKey:"applicant"},"Applicantâ€˜s Events")),c.createElement(D,null,c.createElement(_,{itemKey:"events"},c.createElement("div",{className:"my-3"},c.createElement(b,null,c.createElement(k,null,c.createElement(y,{type:"text",id:"search",name:"search",placeholder:"Search"}),c.createElement(A,{content:"Search for events",placement:"top"},c.createElement(a,{color:"primary"},c.createElement(u,{icon:p})))))),c.createElement(T,{align:"middle",responsive:!0},c.createElement(I,null,c.createElement(M,null,c.createElement(P,{className:"text-center"},"#"),c.createElement(P,{className:"text-center"},"Title"),c.createElement(P,{className:"text-center"},"Capacity"),c.createElement(P,{className:"text-center"},"Participants"),c.createElement(P,{className:"text-center"},"Timeslot"),c.createElement(P,{className:"text-center"},"Actions"))),c.createElement(F,null,q?c.createElement(M,null,c.createElement(K,{colSpan:"7",className:"text-center"},c.createElement(l,{color:"primary",variant:"grow"}))):0===G.length?c.createElement(M,null,c.createElement(K,{colSpan:"7",className:"text-center"},"No data found")):G.map(((e,t)=>e.participants.includes(Y._id)?null:c.createElement(c.Fragment,{key:e._id},c.createElement(M,null,c.createElement(K,{className:"text-center"},o(e._id,3)),c.createElement(K,{className:"text-center"},e.title),c.createElement(K,{className:"text-center"},e.capacity),c.createElement(K,{className:"text-center"},e.participants.length),c.createElement(K,{className:"text-center"},c.createElement("small",null,d(e.timeslot.start)," -"," ",d(e.timeslot.end))),c.createElement(K,{className:"text-center"},c.createElement(k,null,c.createElement(a,{color:"primary",size:"sm",disabled:e.participants.length>=e.capacity||e.participants.includes(Y._id)||!!Z.find((t=>t._id===e._id)),onClick:()=>(async e=>{try{if(Z.find((t=>t._id===e._id)))return;const t=se([...Z,e]);ee(t)}catch(t){}})(e)},e.participants.length>=e.capacity?"Full":e.participants.includes(Y._id)||Z.find((t=>t._id===e._id))?"Added":"Add"),c.createElement(a,{color:"info",size:"sm",onClick:()=>me(t)},B[t]?"Hide":"Show")))),B[t]&&c.createElement(M,null,c.createElement(K,{colSpan:"7"},c.createElement("h6",null,"Addditional Information"),c.createElement("p",null,e.additionalInfo),c.createElement("h6",null,"Location"),c.createElement("p",null,e.location)))))))),c.createElement("div",{className:"d-flex justify-content-center align-items-center"},c.createElement(E,{currentPage:te,totalPages:re,onPageChange:ae}))),c.createElement(_,{itemKey:"applicant"},c.createElement(T,{align:"middle",responsive:!0},c.createElement(I,null,c.createElement(M,null,c.createElement(P,{className:"text-center"},"#"),c.createElement(P,{className:"text-center"},"Title"),c.createElement(P,{className:"text-center"},"Date"),c.createElement(P,{className:"text-center"},"Timeslot"),c.createElement(P,{className:"text-center"},"Actions"))),c.createElement(F,null,q?c.createElement(M,null,c.createElement(K,{colSpan:"7",className:"text-center"},c.createElement(l,{color:"primary",variant:"grow"}))):0===Z.length?c.createElement(M,null,c.createElement(K,{colSpan:"7",className:"text-center"},"No data found")):Z.map(((e,t)=>e.participants.includes(Y._id)?null:c.createElement(c.Fragment,{key:e._id},c.createElement(M,null,c.createElement(K,{className:"text-center"},o(e._id,3)),c.createElement(K,{className:"text-center"},e.title),c.createElement(K,{className:"text-center"},i(e.date,"MMMM DD, YYYY")),c.createElement(K,{className:"text-center"},c.createElement("small",null,d(e.timeslot.start)," -"," ",d(e.timeslot.end))),c.createElement(K,{className:"text-center"},c.createElement(k,null,c.createElement(a,{color:"danger",size:"sm",disabled:e.participants.length>=e.capacity,onClick:()=>(async e=>{try{ee((t=>t.filter((t=>t._id!==e._id))))}catch(t){}})(e)},"Remove"),c.createElement(a,{color:"info",size:"sm",onClick:()=>me(t)},B[t]?"Hide":"Show")))),B[t]&&c.createElement(M,null,c.createElement(K,{colSpan:"7"},c.createElement("h6",null,"Addditional Information"),c.createElement("p",null,e.additionalInfo),c.createElement("h6",null,"Location"),c.createElement("p",null,e.location)))))))),c.createElement("div",null,c.createElement("small",null,c.createElement("span",{className:"text-danger"},"Note:")," Events added here will be scheduled for the applicant once the form is submitted."),c.createElement("br",null),c.createElement("small",null,c.createElement("span",{className:"text-danger"},"Warning:")," Once closed, the events will be resetted. Make sure to submit the form before closing.")),c.createElement("div",{className:"d-flex justify-content-end"},c.createElement(a,{className:"btn btn-primary"},"Submit"))))))))))};R.propTypes={isVisible:r.bool.isRequired,onClose:r.func.isRequired,isDarkMode:r.bool.isRequired,applicantData:r.object};export{R as A};
