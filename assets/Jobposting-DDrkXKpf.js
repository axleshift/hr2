import{r as n,j as e,w as xe,x as he,y as E}from"./index-DJmP4oi1.js";import{z as r,u as $,t as H}from"./zod-DUXwhK-0.js";import{F as c,h as ue,i as ge,j as ye,k as Se,l as U,m as V,n as z,o as Y}from"./index-eE9MX41S.js";import{A as be}from"./DefaultLayout-B3wRVOO4.js";import{f as b,a as v,b as C,t as G}from"./index-B7W5ZAKh.js";import{C as D}from"./CContainer-Bi4TmV07.js";import{C as i,a as h}from"./CRow-C4bqXax5.js";import{C as T,a as F}from"./CCardBody-CsRVGBr3.js";import{C as _}from"./CCardHeader-fZYpQjk6.js";import{a as m}from"./CButton-BokoXM6Y.js";import{C as ve}from"./CTooltip-SjvLySxl.js";import{C as Ce}from"./CCollapse-BxLZ-LAq.js";import{C as K}from"./CForm-CXAWI-AN.js";import{C as p}from"./CFormInput-CXMpxMYz.js";import{C as j}from"./CFormLabel-ByYPne7n.js";import{C as d}from"./CFormControlValidation-CkCCXccc.js";import{C as q}from"./CFormTextarea-DHUpeXtL.js";import{C as De}from"./CFormCheck-owRGvpf4.js";import{C as O}from"./CCardFooter-D3-cekKp.js";import"./index.esm-ChogiBHI.js";import"./cil-user-Dlmw-Gem.js";import"./getRTLPlacement-DNCpgelB.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";import"./CFormControlWrapper-4INfD17j.js";const Xe=()=>{const[u,N]=n.useState(!1),[I,Q]=n.useState(!1),[f,R]=n.useState(!1);n.useState("active");const[L,W]=n.useState([]);n.useState([]);const[X,x]=n.useState(!1),[k,g]=n.useState(!1),[P,B]=n.useState(""),[w,A]=n.useState(1),[y,Ne]=n.useState(9),[Z,ee]=n.useState(1),[se,we]=n.useState("grid"),te=new Date,ae=new Date(new Date().setDate(new Date().getDate()+1)),re=new Date(new Date().setDate(new Date().getDate()-1)),ie=r.object({jpf_id:r.string().optional(),jpfTitle:r.string().min(1,{message:"Job Title is required"}),jpfType:r.string().min(1,{message:"Job Type is required"}),jpfDesc:r.string().min(1,{message:"Job Description is required"}),jpfSalaryMin:r.number().min(1,{message:"Minimum Salary is required"}).default(0),jpfSalaryMax:r.number().min(1,{message:"Maximum Salary is required"}).default(1),jpfLoc:r.string().min(1,{message:"Location is required"}),jpfBnft:r.string().min(1,{message:"Benefit is required"}),jpfReq:r.string().min(1,{message:"Requirement is required"}),jpfSchedStart:r.preprocess(s=>new Date(s),r.date().min(re,{message:"Start Date must be today or later"})),jpfSchedEnd:r.preprocess(s=>new Date(s),r.date().min(new Date,{message:"End Date must be in the future"})),jpfStatus:r.string().optional()}).refine(s=>s.jpfSchedEnd>s.jpfSchedStart,{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}).refine(s=>s.jpfSalaryMin<s.jpfSalaryMax,{message:"Minimum Salary must be less than Maximum Salary",path:["jpfSalaryMax"]}),{register:o,reset:M,handleSubmit:ne,formState:{errors:t}}=$({resolver:H(ie)}),le=async s=>{try{const a={title:s.jpfTitle||"none",type:s.jpfType||"none",salary_min:s.jpfSalaryMin||0,salary_max:s.jpfSalaryMax||1,location:s.jpfLoc||"none",description:s.jpfDesc||"none",requirements:s.jpfReq||"none",responsibilities:s.jpfResp||"none",benefits:s.jpfBnft||"none",schedule_start:s.jpfSchedStart,schedule_end:s.jpfSchedEnd,status:s.jpfStatus||"active"},l=f?await xe(`/jobposting/${s.jpf_id}`,a):await he("/jobposting",a);l.status===201&&(alert(l.data.message),S(1),M())}catch(a){console.log(a),alert("Error creating jobposting")}},J=async s=>{try{const a=await E(`/jobposting/${s}`);if(a.status===200){alert(a.data.message),R(!0),N(!0);const l={jpf_id:a.data.data._id,jpfTitle:a.data.data.title,jpfType:a.data.data.type,jpfDesc:a.data.data.description,jpfSalaryMin:a.data.data.salary_min,jpfSalaryMax:a.data.data.salary_max,jpfLoc:a.data.data.location,jpfBnft:a.data.data.benefits,jpfReq:a.data.data.requirements,jpfSchedStart:b(a.data.data.schedule_start),jpfSchedEnd:b(a.data.data.schedule_end),jpfStatus:a.data.status};M(l),window.scrollTo(0,0)}else alert("Error getting jobposting")}catch(a){console.log(a),alert("Error getting jobposting")}},ce=()=>{R(!1),N(!1),M({jpf_id:"",jpfTitle:"",jpfType:"",jpfDesc:"",jpfSalaryMin:0,jpfSalaryMax:1,jpfLoc:"",jpfBnft:"",jpfReq:"",jpfSchedStart:new Date,jpfSchedEnd:new Date,jpfStatus:"active"})},de=s=>{Q(s.target.checked)},S=async(s,a)=>{try{x(!0);const l=k?await E(`/jobposting/search?query=${P}&page=${s}&limit=${a}`):await E(`/jobposting?page=${s}&limit=${a}`);l.status===200?(W(l.data.data),A(l.data.currentPage),ee(l.data.totalPages),x(!1)):(alert("Error getting jobposting"),console.log("Error: ",l.data),x(!1),g(!1))}catch(l){console.log(l)}},oe=r.object({jpSearchInput:r.string().min(1,{message:"Search query is required"})}),{register:je,handleSubmit:pe,formState:{searchError:Me}}=$({resolver:H(oe)}),me=async s=>{try{g(!0),x(!0),B(s.jpSearchInput),S(1,y)}catch(a){console.log(a),x(!1),g(!1)}},fe=()=>{g(!1),B(""),S(1,y)};return n.useEffect(()=>{const s=setTimeout(()=>{S(w,y)},500);return()=>clearTimeout(s)},[w,y,k,P]),e.jsx(e.Fragment,{children:e.jsxs(D,{className:"d-flex flex-column gap-3 mb-3",children:[e.jsx(i,{children:e.jsx(D,{children:e.jsxs(T,{children:[e.jsx(_,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:f?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:f?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[f&&e.jsx(m,{type:"button",onClick:()=>ce(),className:"btn btn-danger w-30",children:e.jsx(c,{icon:ue})}),e.jsx(ve,{content:u?"Collapse":"Expand",placement:"top",children:e.jsx(m,{type:"button",onClick:()=>N(!u),className:"btn btn-primary w-30",children:u?e.jsx(c,{icon:ge}):e.jsx(c,{icon:ye})})})]})]})}),e.jsx(Ce,{visible:u,children:e.jsx(F,{children:e.jsxs(K,{onSubmit:ne(le),children:[e.jsx(i,{className:"visually-hidden",children:e.jsx("div",{children:e.jsx(p,{type:"text",id:"jpf_id",...o("jpf_id")})})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfTitle",children:"Job Title"}),e.jsx(p,{type:"text",id:"jpfTitle",placeholder:"e.g. Software Engineer",...o("jpfTitle"),invalid:!!t.jpfTitle}),t.jpfTitle&&e.jsx(d,{invalid:!0,children:t.jpfTitle.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfType",children:"Job Type"}),e.jsx(p,{type:"text",id:"jpfType",placeholder:"e.g. Full-time",...o("jpfType"),invalid:!!t.jpfType}),t.jpfType&&e.jsx(d,{invalid:!0,children:t.jpfType.message})]})}),e.jsx(i,{children:e.jsx("strong",{children:"Salary"})}),e.jsxs(i,{children:[e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfSalaryMin",children:"Minimum"}),e.jsx(p,{type:"number",id:"jpfSalaryMin",placeholder:"0",...o("jpfSalaryMin",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMin}),t.jpfSalaryMin&&e.jsx(d,{invalid:!0,children:t.jpfSalaryMin.message})]})}),e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfSalaryMax",children:"Maximum"}),e.jsx(p,{type:"number",id:"jpfSalaryMax",placeholder:"1",...o("jpfSalaryMax",{valueAsNumber:!0}),invalid:!!t.jpfSalaryMax}),t.jpfSalaryMax&&e.jsx(d,{invalid:!0,children:t.jpfSalaryMax.message})]})})]}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfLoc",children:"Location"}),e.jsx(p,{type:"text",id:"jpfLoc",placeholder:"e.g. Manila",...o("jpfLoc"),invalid:!!t.jpfLoc}),t.jpfLoc&&e.jsx(d,{invalid:!0,children:t.jpfLoc.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfDesc",children:"Description"}),e.jsx(q,{id:"jpfDesc",placeholder:"e.g. Job description details...",...o("jpfDesc"),invalid:!!t.jpfDesc}),t.jpfDesc&&e.jsx(d,{invalid:!0,children:t.jpfDesc.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfBnft",children:"Benefits"}),e.jsx(q,{id:"jpfBnft",placeholder:"e.g. Dental Care",...o("jpfBnft"),invalid:!!t.jpfBnft}),t.jpfBnft&&e.jsx(d,{invalid:!0,children:t.jpfBnft.message})]})}),e.jsx(i,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfReq",children:"Requirements"}),e.jsx(q,{id:"jpfReq",placeholder:"e.g. Identification Documents",...o("jpfReq"),invalid:!!t.jpfReq}),t.jpfReq&&e.jsx(d,{invalid:!0,children:t.jpfReq.message})]})}),e.jsxs(i,{children:[e.jsx("strong",{children:"Deployment Schedule"}),e.jsx("p",{className:"text-muted small",children:"These parameters determine the duration of the job posting."})]}),e.jsxs(i,{children:[e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfSchedStart",children:"Start"}),e.jsx(p,{type:"date",id:"jpfSchedStart",defaultValue:b(te),...o("jpfSchedStart",{valueAsDate:!0}),invalid:!!t.jpfSchedStart}),t.jpfSchedStart&&e.jsx(d,{invalid:!0,children:t.jpfSchedStart.message})]})}),e.jsx(h,{children:e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{htmlFor:"jpfSchedEnd",children:"Expire"}),e.jsx(p,{type:"date",id:"jpfSchedEnd",defaultValue:b(ae),...o("jpfSchedEnd",{valueAsDate:!0}),invalid:!!t.jpfSchedEnd}),t.jpfSchedEnd&&e.jsx(d,{invalid:!0,children:t.jpfSchedEnd.message})]})})]}),e.jsx("hr",{}),e.jsx(i,{children:e.jsxs("div",{className:"ml-5 mb-3 d-flex justify-content-end",children:[e.jsx(De,{type:"checkbox",id:"invalidCheck",label:"I've reviewed the job posting and checked that all is correct. ",checked:I,onChange:de}),e.jsx(d,{invalid:!0,children:"You must agree before submitting."})]})}),e.jsx(i,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(m,{color:"primary",type:"submit",disabled:!I,className:"mb-3 w-25",children:f?"Update":"Add"})})})]})})})]})})}),e.jsx(i,{children:e.jsx(D,{children:e.jsxs(T,{children:[e.jsx(_,{children:e.jsxs(K,{onSubmit:pe(me),className:"d-flex flex-row gap-2 justify-content-end align-items-center",children:[e.jsxs("div",{children:[e.jsx(p,{type:"text",id:"jpSearchInput",placeholder:"...",...je("jpSearchInput"),invalid:!!t.jpSearchInput}),t.jpSearchInput&&e.jsx(d,{invalid:!0,children:t.jpSearchInput.message})]}),e.jsx(m,{type:"submit",className:"btn btn-primary",children:"Search"}),e.jsx(m,{onClick:()=>fe(),type:"button",className:"btn btn-primary",children:e.jsx(c,{icon:Se})})]})}),e.jsx(F,{children:X?e.jsx("div",{children:"Loading"}):e.jsx("div",{children:se==="grid"?e.jsx(D,{children:e.jsx(i,{xs:{cols:1},md:{cols:3},className:"g-3",children:L.map(s=>s?e.jsx(h,{children:e.jsxs(T,{className:"mb-3 h-100",children:[e.jsx(_,{className:"fw-bold text-uppercase text-primary",children:e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]})}),e.jsx(F,{children:e.jsxs("div",{className:"d-flex flex-column justify-content-between",children:[e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:U}),e.jsx("p",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:V}),e.jsxs("p",{children:[v(s.schedule_start)," -"," ",v(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:z}),e.jsxs("p",{children:[C(s.salary_min)," -"," ",C(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:G(s.description,150)})]})]})}),e.jsx(O,{children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(m,{onClick:()=>J(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(c,{icon:Y}),"Edit"]})})})]})},s._id):e.jsx("div",{children:"Loading"},Math.random()))})}):e.jsx("ul",{className:"list-group list-group-flush",children:L.map(s=>s?e.jsxs("li",{className:"list-group-item",children:[e.jsxs("div",{children:[e.jsx("span",{className:s.status==="active"?"badge rounded-pill text text-bg-success":"badge rounded-pill text text-danger",children:s.status==="active"?"Active":"Inactive"}),e.jsx("p",{className:"fw-bold text-uppercase text-primary",children:s.title})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:U}),e.jsx("div",{children:s.location})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:V}),e.jsxs("p",{children:[v(s.schedule_start)," -"," ",v(s.schedule_end)]})]}),e.jsxs("div",{className:"d-flex flex-row gap-2 justify-content-start",children:[e.jsx(c,{icon:z}),e.jsxs("p",{children:[C(s.salary_min)," -"," ",C(s.salary_max)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"fw-bold text-uppercase",children:"Description"}),e.jsx("p",{children:G(s.description,150)})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsxs(m,{onClick:()=>J(s._id),className:"btn btn-outline-primary d-flex flex-row gap-2 justify-content-center align-items-center",children:[e.jsx(c,{icon:Y}),"Edit"]})})})]},s._id):null)})})}),e.jsx(O,{className:"d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(be,{currentPage:w,totalPages:Z||1,onPageChange:A})})]})})})]})})};export{Xe as default};
