import{r,j as e,B as v,y as ee,z as se,E as te}from"./index-BILMsKTo.js";import{z as n,u as A,t as D}from"./zod-Dv97kSk9.js";import{C as d,c as ae}from"./index-40hnlwZV.js";import{A as re}from"./AppPagination-Cd506738.js";import{F as m,h as k,i as ne,j as ce,s as oe,o as ie}from"./index.es-Cs0yAkp1.js";import{C as h}from"./CContainer-vopIotYD.js";import{C as c}from"./CRow-BX8gVDCd.js";import{C as w,a as E}from"./CCardBody-DoHIuWVo.js";import{C as B}from"./CCardHeader-DqyPIYgf.js";import{a as l}from"./CButton-ZiVDrpO6.js";import{C as le}from"./CCollapse-CO5fDDlg.js";import{C as M,a as y,c as C}from"./CFormInput-BgrsJ1gl.js";import{C as g}from"./CCol-BeGkzhs0.js";import{C as H}from"./CCardFooter-S8Ge84cl.js";import{C as de}from"./CButtonGroup-DR_s3adC.js";import"./DefaultLayout-TZi4EdfB.js";import"./index.esm-Bi4py5Td.js";const Pe=()=>{const[F,U]=r.useState([]),[o,b]=r.useState(!1),[x,p]=r.useState(!0),[I,_]=r.useState(""),[P,q]=r.useState(!1),[j,R]=r.useState(1),[S,me]=r.useState(9),[z,G]=r.useState(0),u=async()=>{try{const s=P?await v(`/tags/search?query=${I}&page=${j}&limit=${S}`):await v(`/tags/all?page=${j}&limit=${S}`);s.status===200?(U(s.data.data),G(s.data.totalPages),R(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},J=n.object({id:n.string().optional(),name:n.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:n.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),description:n.string().optional()}),{register:N,reset:T,handleSubmit:L,formState:{errors:a}}=A({resolver:D(J)}),K=async s=>{try{const t=F.find($=>$.name===s.name&&$.category===s.category);if(!o&&t){console.log("Tag already exist");return}console.log(s);const i=o?await ee(`/tags/${s.id}`,s):await se("/tags",s);i.status===200||i.status===201?(alert(i.data.message),T({id:"",name:"",category:""}),b(!1),p(!0),u()):console.log(i)}catch{}},O=async s=>{try{b(!0),p(!0);const t=await v(`/tags/${s}`);if(t.status===200){const i={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category};T(i)}}catch{}},Q=async s=>{try{if(!confirm("Are you sure you want to delete this tag?"))return;(await te(`/tags/${s}`)).status===200&&u()}catch{}},V=()=>{T({id:"",name:"",category:""}),b(!1),p(!0)},W=n.object({searchInput:n.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:X,reset:he,handleSubmit:Y,formState:{errors:f}}=A({resolver:D(W)}),Z=async s=>{try{console.log(s),_(s.searchInput),q(!0),u()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{u()},300);return()=>clearTimeout(s)},[j,S,P,I]),e.jsxs(h,{className:"d-flex flex-column gap-3",children:[e.jsx(c,{children:e.jsx(h,{children:e.jsxs(w,{children:[e.jsx(B,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:o?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:o?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[o&&e.jsx(d,{content:"Reset form",placement:"top",children:e.jsx(l,{onClick:()=>V(),className:"btn btn-danger",children:e.jsx(m,{icon:k})})}),e.jsx(d,{content:x?"Collapse":"Expand",placement:"top",children:e.jsx(l,{onClick:()=>p(!x),className:"btn btn-primary",children:e.jsx(m,{icon:x?ne:ce})})})]})]})}),e.jsx(le,{visible:x,children:e.jsx(E,{children:e.jsx(M,{onSubmit:L(K),children:e.jsxs(h,{className:"d-flex flex-column gap-2",children:[e.jsx(c,{children:e.jsxs(g,{children:[e.jsx(y,{type:"hidden",id:"id",...N("id"),invalid:!!a.id}),a&&a.id&&e.jsx(C,{className:"text-danger",children:a.id.message}),e.jsx(y,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...N("name"),invalid:!!a.name}),a&&a.name&&e.jsx(C,{className:"text-danger",children:a.name.message})]})}),e.jsx(c,{children:e.jsxs(g,{children:[e.jsx(y,{type:"text",id:"category",placeholder:"Category",label:"Category",...N("category"),invalid:!!a.category}),a&&a.category&&e.jsx(C,{className:"text-danger",children:a.category.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(l,{color:"primary",type:"submit",className:"mb-3 w-25",children:o?"Update":"Submit"})})]})})})})]})})}),e.jsx(c,{children:e.jsx(h,{children:e.jsxs(w,{children:[e.jsx(B,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(M,{onSubmit:Y(Z),className:"d-flex flex-row gap-2",children:[e.jsxs("div",{children:[e.jsx(y,{placeholder:"...",id:"searcInput",...X("searchInput"),invalid:!!f.searchInput}),f&&f.searchInput&&e.jsx(C,{className:"text-danger",children:f.searchInput.message})]}),e.jsx(d,{content:"Search tags",placement:"top",children:e.jsx(l,{type:"submit",className:"btn btn-primary",children:e.jsx(m,{icon:oe})})})]})})]})}),e.jsx(E,{children:e.jsx(h,{children:e.jsx(c,{children:F.map((s,t)=>e.jsx(g,{md:4,className:"mb-3",children:e.jsxs(w,{className:"h-100",children:[e.jsx(E,{children:e.jsx(c,{children:e.jsxs(g,{children:[e.jsx("h5",{children:ae(s.name)}),e.jsx("p",{children:s.category})]})})}),e.jsx(H,{children:e.jsx(c,{children:e.jsx(g,{children:e.jsxs(de,{children:[e.jsx(d,{content:"Edit tag",placement:"top",children:e.jsx(l,{color:"primary",onClick:()=>O(s._id),children:e.jsx(m,{icon:ie})})}),e.jsx(d,{content:"Delete tag",placement:"top",children:e.jsx(l,{color:"danger",onClick:()=>Q(s._id),children:e.jsx(m,{icon:k})})})]})})})})]})},t))})})}),e.jsx(H,{className:"d-flex justify-content-center",children:e.jsx(re,{currentPage:j,totalPages:z||1,onPageChange:R})})]})})})]})};export{Pe as default};
