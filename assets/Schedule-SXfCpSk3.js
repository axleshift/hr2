import{r as l,o as z,q as _,k as e,g as C,l as B,G}from"./index-Do00Xf1q.js";import{z as j,u as J,t as O}from"./zod-aoyOoU2S.js";import{A as q}from"./AppPagination-BPy9TJBn.js";import{F as Q,Q as U}from"./index.es-BzpiLWIz.js";import{f as r}from"./index-VIXCwCyV.js";import{C as N}from"./CContainer-d0ABidlq.js";import{C as v,a as D}from"./CRow-D1hWq1zB.js";import{C as H,b as y,a as M}from"./CFormInput-CecjJPAh.js";import{C as K}from"./CButtonGroup-s4pxcX5S.js";import{C as V}from"./CTooltip-Dl4soOsb.js";const me=()=>{const{addToast:d}=l.useContext(z);l.useState(!1);const[x,f]=l.useState([]),[k,o]=l.useState(!0),[s,w]=l.useState({start:new Date,end:new Date,today:new Date(new Date().setDate(new Date().getDate()-1)),tomorrow:new Date(new Date().setDate(new Date().getDate()+1)),nextWeek:new Date(new Date().setDate(new Date().getDate()+7))}),[i,P]=l.useState({active:!1,inactive:!1,all:!0});l.useState({active:0,inactive:0,all:0});const[h,m]=l.useState(1),[b,X]=l.useState(9),[F,p]=l.useState(0),[E,u]=l.useState(0),[S,$]=l.useState([{color:"success",text:"active",isChecked:i.active},{color:"danger",text:"inactive",isChecked:i.inactive},{color:"warning",text:"both",isChecked:i.all}]),L=j.object({jpfSchedStart:j.date().optional(),jpfSchedEnd:j.date().optional()}).refine(t=>t.jpfSchedEnd>t.jpfSchedStart,{message:"End Date must be after Start Date",path:["jpfSchedEnd"]}),{register:Z,handleSubmit:W,formState:{errors:ee}}=J({resolver:O(L)}),Y=async(t,n)=>{try{o(!0);const c=Object.keys(i).find(T=>i[T]===!0),a=await G(`/jobposting/scheduled?start=${s.today}&end=${s.nextWeek}&page=${t}&limit=${n}&sort=desc&filter=${c}`);a.status===200?(f(a.data.data),m(a.data.currentPage),p(a.data.totalPages),u(a.data.total),o(!1)):(d("Error","Failed to fetch scheduled job postings","error"),o(!1)),a.status===200?(f(a.data.data),m(a.data.currentPage),p(a.data.totalPages),u(a.data.total),o(!1)):(d("Error","Failed to fetch scheduled job postings","error"),o(!1)),a.status===200?(f(a.data.data),m(a.data.currentPage),p(a.data.totalPages),u(a.data.total),o(!1)):(d("Error","Failed to fetch scheduled job postings","error"),o(!1))}catch(c){console.log(c),o(!1)}},A=_(),I=t=>{A(`/recruitment/jobposter/${t}`),d("Review","Redirecting to Job Poster","info")},R=t=>{console.log("Legend: ",t);let n={active:!1,inactive:!1,all:!1};switch(t){case"active":n={active:!0,inactive:!1,all:!1};break;case"inactive":n={active:!1,inactive:!0,all:!1};break;case"both":n={active:!1,inactive:!1,all:!0};break;default:console.warn("Unknown legend:",t)}P(n),$(c=>c.map(g=>({...g,isChecked:g.text===t})))};return l.useEffect(()=>{Y(h,b)},[s,h,b,i,S]),e.jsx(e.Fragment,{children:e.jsxs(N,{children:[e.jsx(v,{children:e.jsxs(N,{children:[e.jsx("h1",{children:"Scheduled Job Postings"}),e.jsxs("small",{className:"text-muted",children:["You can view all scheduled job postings here. The system will not post the job posting until its given approval. by Default, the system will display all scheduled job postings from ",e.jsx("span",{className:"text-info fw-bold",children:"today"})," to"," ",e.jsx("span",{className:"text-danger fw-bold",children:"next week."})]}),e.jsx(H,{onSubmit:W(Y),children:e.jsxs(v,{className:"d-flex gap-2 align-items-end",children:[e.jsxs(D,{children:[e.jsx(y,{htmlFor:"jpfSchedStart",children:"Start Date"}),e.jsx(M,{type:"date",id:"jpfSchedStart",name:"jpfSchedStart",value:r(s.today),onChange:t=>w({...s,today:t.target.value})})]}),e.jsxs(D,{children:[e.jsx(y,{htmlFor:"jpfSchedEnd",children:"End Date"}),e.jsx(M,{type:"date",id:"jpfSchedEnd",name:"jpfSchedEnd",value:r(s.nextWeek),onChange:t=>w({...s,nextWeek:t.target.value})})]})]})}),e.jsx("div",{children:e.jsxs(K,{className:"d-flex flex-row gap-2 mt-3",children:[e.jsx("small",{className:"text-muted",children:"Filters:"}),e.jsx("small",{className:"text-muted",children:"Filters:"}),S.map((t,n)=>e.jsx("span",{className:"d-flex flex-row gap-2 d-flex align-items-center",children:e.jsxs("span",{className:"d-flex flex-row gap-2 d-flex align-items-center",children:[e.jsx(C,{onClick:()=>R(t.text),className:t.isChecked?`btn btn-${t.color}`:"btn btn-outline-secondary"}),e.jsx("small",{className:"text-capitalize text-muted",children:t.text})]},n)},n))]})}),k?e.jsx("div",{className:"pt-3 text-center",children:e.jsx(B,{color:"primary",variant:"grow"})}):e.jsxs("div",{children:[x&&x.length>0?e.jsxs("small",{className:"text-capitalize text-muted mt-3",children:["Fetched total of ",E," job postings for",e.jsx("span",{className:"text-info mx-2",children:r(s.today,"MMM d, YYYY")}),"-",e.jsx("span",{className:"text-info mx-2",children:r(s.nextWeek,"MMM d, YYYY")})]}):e.jsxs("small",{className:"text-capitalize text-muted mt-3",children:["No scheduled jobpostings found for",e.jsx("span",{className:"text-info mx-2",children:r(s.today,"MMM d, YYYY")}),"-",e.jsx("span",{className:"text-info mx-2",children:r(s.nextWeek,"MMM d, YYYY")}),e.jsx("span",{className:"text-info mx-2",children:r(s.today,"MMM d, YYYY")}),"-",e.jsx("span",{className:"text-info mx-2",children:r(s.nextWeek,"MMM d, YYYY")})]}),e.jsx("ul",{className:"list-group",children:x.map((t,n)=>e.jsxs("li",{className:"list-group-item d-flex flex-row gap-2 justify-content-between align-items-center ",children:[e.jsx("div",{className:"d-flex flex-row gap-2",children:e.jsxs("div",{children:[e.jsx("strong",{children:t.title}),e.jsxs("div",{className:"text-muted d-flex flex-row gap-2 align-items-center",children:[e.jsx("div",{style:{width:"15px",height:"15px"},className:`rounded ${t.status==="active"?"bg-success":"bg-danger"}`}),e.jsxs("div",{children:[r(t.schedule_start,"MMM d, YYYY")," -"," ",r(t.schedule_end,"MMM d, YYYY")]})]})]})}),e.jsx(V,{content:"Review",placement:"top",children:e.jsx(C,{type:"button",onClick:()=>I(t._id),className:"btn btn-primary d-flex flex-row gap-2 align-items-center",children:e.jsx(Q,{icon:U})})})]},n))})]})]})}),e.jsx(v,{children:e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(q,{currentPage:h,totalPages:F,onPageChange:m})})})]})})};export{me as default};
