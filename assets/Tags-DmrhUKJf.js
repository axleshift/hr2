import{r,o as xe,A as ue,k as e,g as o,l as U,G as k,E as je,F as pe,I as fe}from"./index-CiV4mRcZ.js";import{z as i,u as B,t as G}from"./zod-BQFeo2Z_.js";import{A as ye}from"./AppPagination-CbuU39Nq.js";import{F as d,J as _,B as Ce,C as be,w as H,O as Se,P as Ne,Q as Pe,D as Te,I as we}from"./index.es-ba-Ohs3A.js";import{c as ve}from"./index-DROTT6wf.js";import{C as A}from"./CContainer-Do4jvznw.js";import{C as n,a as l}from"./CRow-DuUDi8eX.js";import{C as q,a as z}from"./CCardBody-BSH2F1wg.js";import{C as Ie}from"./CCardHeader-QVwXVPrs.js";import{C as m}from"./CTooltip-blDH3YDi.js";import{C as Ee}from"./CCollapse-DQXX3K80.js";import{C as O,a as j,c as x,b as Y}from"./CFormInput-DTJIjxRp.js";import{C as D}from"./CInputGroup-C2Au0wq3.js";import{C as Fe}from"./CCardFooter-scExt8SB.js";import{C as ke}from"./CButtonGroup-Bcv8H7hU.js";import{C as Ae,a as De,b as Me,c as Re,d as $e}from"./CModalTitle-B7A3NtIZ.js";import{C as Le}from"./CFormCheck-BMR-6tlK.js";import"./DefaultLayout-DjGsySbU.js";import"./index.esm-C8caOtPE.js";const ns=()=>{const{addToast:c}=r.useContext(xe),[P,J]=r.useState([]),[V,f]=r.useState(!1),[T,W]=r.useState({}),[h,w]=r.useState(!1),[y,C]=r.useState(!0),[Q,v]=r.useState(!1),[I,K]=r.useState(!1),[X,E]=r.useState(!1),[M,Z]=r.useState(""),[R,ee]=r.useState(!1),[b,$]=r.useState(1),[F,Ue]=r.useState(9),[se,te]=r.useState(0);r.useContext(ue);const S=async()=>{try{f(!0);const s=R?await k(`/tags/search?query=${M}&page=${b}&limit=${F}`):await k(`/tags/all?page=${b}&limit=${F}`);s.status===200?(J(s.data.data),te(s.data.totalPages),$(s.data.currentPage),f(!1),c("Success","Tags are successfully retrieved","success")):(console.log(s),f(!1),c("Error","An error occurred while fetching the tags","danger"))}catch(s){console.log(s),f(!1),c("Error","An error occurred while fetching the tags","danger")}},ae=i.object({id:i.string().optional(),name:i.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:i.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:i.preprocess(s=>s==="true"||s===!0,i.boolean()).optional().default(!1),isSystem:i.preprocess(s=>s==="true"||s===!0,i.boolean()).optional().default(!1),description:i.string().optional()}),{register:p,reset:g,handleSubmit:re,formState:{errors:a}}=B({resolver:G(ae)}),ne=async s=>{try{const t=P.find(L=>L.name===s.name&&L.category===s.category);if(!h&&t){console.log("Tag already exist");return}console.log(s);const u=h?await je(`/tags/${s.id}`,s):await pe("/tags",s);u.status===200||u.status===201?(h?c("Success","Tag is successfully updated","success"):c("Success","Tag is successfully added","success"),g({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),w(!1),C(!0),S()):c("Error","An error occurred while adding the tag","danger")}catch{c("Error","An error occurred while adding the tag","danger")}},ce=async s=>{try{w(!0),C(!0);const t=await k(`/tags/${s}`);if(t.status===200){const u={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};g(u),c("Success","Tag is successfully retrieved","success")}}catch{c("Error","An error occurred while fetching the tag","danger")}},oe=s=>{const t=P.find(u=>u._id===s);W(t),v(!0)},ie=async s=>{try{E(!0);const t=await fe(`/tags/${s}`);t.status===200?(c("Success","Tag has been deleted successfully","success"),S(),v(!1)):(console.log(t),c("Error",t.message.message,"danger"),E(!1))}catch{c("Error","An error occurred while deleting the tag","danger"),E(!1)}},le=()=>{g({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),w(!1),C(!0)},de=i.object({searchInput:i.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:me,reset:Be,handleSubmit:he,formState:{errors:N}}=B({resolver:G(de)}),ge=async s=>{try{console.log(s),Z(s.searchInput),ee(!0),S()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{S()},300);return()=>clearTimeout(s)},[b,F,R,M]),e.jsxs(A,{className:"d-flex flex-column gap-3",children:[e.jsx(n,{children:e.jsx(A,{children:e.jsxs(q,{children:[e.jsx(Ie,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:h?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:h?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[h&&e.jsx(m,{content:"Reset form",placement:"top",children:e.jsx(o,{onClick:()=>le(),className:"btn btn-danger",children:e.jsx(d,{icon:_})})}),e.jsx(m,{content:y?"Collapse":"Expand",placement:"top",children:e.jsx(o,{onClick:()=>C(!y),className:"btn btn-primary",children:e.jsx(d,{icon:y?Ce:be})})})]})]})}),e.jsx(Ee,{visible:y,children:e.jsx(z,{children:e.jsx(O,{onSubmit:re(ne),children:e.jsxs(A,{className:"d-flex flex-column gap-2",children:[e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(j,{type:"hidden",id:"id",...p("id"),invalid:!!a.id}),a&&a.id&&e.jsx(x,{className:"text-danger",children:a.id.message}),e.jsx(j,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...p("name"),invalid:!!a.name}),a&&a.name&&e.jsx(x,{className:"text-danger",children:a.name.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(j,{type:"text",id:"category",placeholder:"Category",label:"Category",...p("category"),invalid:!!a.category}),a&&a.category&&e.jsx(x,{className:"text-danger",children:a.category.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(Y,{children:"Protected?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...p("isProtected"),invalid:!!a.isProtected}),e.jsx(m,{content:"Protect",placement:"top",children:e.jsx(o,{onClick:()=>g({isProtected:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:H})})}),e.jsx(m,{content:"Unprotect",placement:"top",children:e.jsx(o,{onClick:()=>g({isProtected:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:Se})})})]}),a&&a.isProtected&&e.jsx(x,{className:"text-danger",children:a.isProtected.message})]})}),e.jsx(n,{children:e.jsxs(l,{children:[e.jsx(Y,{children:"System Tag ?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:!1,...p("isSystem"),invalid:!!a.isSystem}),e.jsx(m,{content:"Protect",placement:"top",children:e.jsx(o,{onClick:()=>g({isSystem:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:Ne})})}),e.jsx(m,{content:"Unprotect",placement:"top",children:e.jsx(o,{onClick:()=>g({isSystem:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:Pe})})})]}),a&&a.isSystem&&e.jsx(x,{className:"text-danger",children:a.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(o,{color:"primary",type:"submit",className:"mb-3 w-25",children:h?"Update":"Submit"})})]})})})})]})})}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("h1",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(O,{onSubmit:he(ge),children:[e.jsxs(D,{children:[e.jsx(j,{placeholder:"...",id:"searcInput",...me("searchInput"),invalid:!!N.searchInput}),e.jsx(m,{content:"Search tags",placement:"top",children:e.jsx(o,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:Te})})})]}),N&&N.searchInput&&e.jsx(x,{className:"text-danger",children:N.searchInput.message})]})})]})}),e.jsx(n,{children:V?e.jsx("div",{className:"pt-3 text-center",children:e.jsx(U,{color:"primary",variant:"grow"})}):P.map((s,t)=>e.jsx(l,{md:4,className:"mb-3",children:e.jsxs(q,{className:"h-100",children:[e.jsxs(z,{children:[e.jsx(n,{children:e.jsxs(l,{children:[e.jsx("h5",{children:ve(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(n,{children:e.jsxs(l,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(n,{children:e.jsxs(l,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsx(Fe,{children:e.jsx(n,{children:e.jsx(l,{children:e.jsxs(ke,{children:[e.jsx(m,{content:"Edit tag",placement:"top",children:e.jsx(o,{color:"primary",onClick:()=>ce(s._id),children:e.jsx(d,{icon:we})})}),e.jsx(m,{content:"Delete tag",placement:"top",children:e.jsx(o,{color:"danger",onClick:()=>oe(s._id),disabled:s.isProtected,children:e.jsx(d,{icon:s.isProtected?H:_})})})]})})})})]})},t))}),e.jsx(n,{children:e.jsx(l,{children:e.jsxs(Ae,{visible:Q,onClose:()=>v(!1),children:[e.jsx(De,{children:e.jsx(Me,{className:"text-danger",children:"Warning"})}),e.jsx(Re,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:T.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:T.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs($e,{children:[e.jsxs(l,{className:"d-flex justify-content-end",children:[e.jsx(Le,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:I,onChange:()=>K(!I)}),e.jsx(x,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(o,{onClick:()=>ie(T._id),disabled:!I,className:"btn btn-danger",children:X?e.jsx(U,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ye,{currentPage:b,totalPages:se||1,onPageChange:$})})})]})};export{ns as default};
