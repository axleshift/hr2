import{q as _,R as a,o as z,k as e,g,l as E,G as P}from"./index-Do00Xf1q.js";import{F as b,G as H,H as L,P as V}from"./index.es-BzpiLWIz.js";import{t as N,d as A,f as J}from"./index-VIXCwCyV.js";import{A as O}from"./AppPagination-BPy9TJBn.js";import{z as w,u as Q,t as K}from"./zod-aoyOoU2S.js";import{C as U}from"./CContainer-d0ABidlq.js";import{C as j,a as S}from"./CRow-D1hWq1zB.js";import{C as W,a as X,c as Z}from"./CFormInput-CecjJPAh.js";import{C as ee}from"./CInputGroup-DAPCj5pk.js";import{C as l}from"./CTooltip-Dl4soOsb.js";import{C as se,a as te}from"./CCardBody-BYA-vFkB.js";import{C as ae,a as re,b as p,c,d as ne,e as r}from"./CTable-OnVTJ65J.js";import{a as u}from"./DefaultLayout-CxZzcknF.js";import{C as ce}from"./CButtonGroup-s4pxcX5S.js";import"./index.esm-Dbg3Sr3c.js";const Ae=()=>{const I=_(),{addToast:v}=a.useContext(z),[y,R]=a.useState([]),[T,i]=a.useState(!1),[o,F]=a.useState(1),[D,$]=a.useState(1),[d,le]=a.useState(10),[oe,x]=a.useState(!1),[f,ie]=a.useState(""),C=async(s="",h,m)=>{i(!0);try{const t=s===""||s===null||s===void 0?await P(`/jobposter/all?page=${h}&limit=${m}`):await P(`/jobposter/all?query=${s}&page=${h}&limit=${m}`);if(t.status===200){console.log("Data:",t.data),R(t.data.data),$(t.data.totalPages),i(!1),x(!1);return}else v("Info",`No data found for '${s}'`,"info"),i(!1),x(!1)}catch(t){v("Danger","Failed to fetch data","Error"),console.error(t),i(!1),x(!1)}},k=w.object({query:w.string().min(3,{message:"Search query must be at least 3 characters"})}),{register:Y,reset:de,handleSubmit:q,formState:{error:n}}=Q({resolver:async(s,h,m)=>{const t=await K(k)(s,h,m);return console.log("Validation result:",t),t}}),B=async s=>{x(!0),C(s.query,o,d)},M=()=>{C(f,o,d)},G=s=>{I(`/recruitment/jobposter/${s.ref_id}`)};return a.useEffect(()=>{C(f,o,d)},[f,o,d]),e.jsx(e.Fragment,{children:e.jsxs(U,{children:[e.jsx(j,{className:"mb-3",children:e.jsxs(S,{children:[e.jsx("h1",{children:"Jobpost Tracker"}),e.jsx("small",{className:"text-muted",children:"In this page, you can view all the jobpost tracker data in various platforms."})]})}),e.jsx(j,{className:"mb-3",children:e.jsx(S,{children:e.jsx(W,{onSubmit:q(B),children:e.jsxs(ee,{children:[e.jsx(X,{type:"text",placeholder:"Search...",...Y("query"),invalid:!!(n!=null&&n.query)}),(n==null?void 0:n.query)&&e.jsx(Z,{className:"text-danger",children:n.query.message}),e.jsx(l,{content:"Search",placement:"top",children:e.jsx(g,{type:"submit",className:"btn btn-primary",children:e.jsx(b,{icon:H})})}),e.jsx(l,{content:"Refresh",placement:"top",children:e.jsx(g,{onClick:M,className:"btn btn-primary",children:e.jsx(b,{icon:L})})})]})})})}),e.jsx(j,{children:e.jsx(S,{children:e.jsx(se,{children:e.jsx(te,{children:e.jsxs(ae,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(re,{children:e.jsxs(p,{children:[e.jsx(c,{children:e.jsx("div",{className:"text-center",children:e.jsx("strong",{children:"#"})})}),e.jsx(c,{children:e.jsx("div",{className:"text-center",children:"Platform"})}),e.jsx(c,{children:e.jsx("div",{className:"text-center",children:"Approved"})}),e.jsx(c,{children:e.jsx("div",{className:"text-center",children:"Posted"})}),e.jsx(c,{children:e.jsx("div",{className:"text-center",children:"Expires At"})}),e.jsx(c,{children:"Content "}),e.jsx(c,{children:e.jsx("div",{className:"text-center",children:"Actions"})})]})}),e.jsx(ne,{children:T?e.jsx(p,{children:e.jsx(r,{colSpan:"8",className:"text-center",children:e.jsx(E,{color:"primary",variant:"grow"})})}):y.length===0?e.jsx(p,{children:e.jsx(r,{colSpan:"8",children:e.jsx("div",{className:"text-center",children:"No data"})})}):y.map(s=>e.jsxs(p,{children:[e.jsx(r,{children:e.jsx(l,{content:s._id,placement:"top",children:e.jsx("div",{className:"text-capitalize text-center",children:N(s._id,2)})})}),e.jsx(r,{children:e.jsx("div",{className:"text-capitalize text-center",children:s.platform})}),e.jsx(r,{className:"text-center",children:s.isApproved?e.jsx(u,{color:"success",children:"YES"}):e.jsx(u,{color:"danger",children:"NO"})}),e.jsx(r,{className:"text-center",children:s.isPosted?e.jsx(u,{color:"success",children:"YES"}):e.jsx(u,{color:"danger",children:"NO"})}),e.jsx(r,{className:"text-center",children:e.jsx(l,{content:A(s.expiresAt)+" days left",placement:"top",children:e.jsx("span",{className:A(s.expiresAt)>0?"text-info":"text-danger",children:J(s.expiresAt,"MMM d, YYYY")})})}),e.jsx(r,{children:e.jsx(l,{content:N(s.content,100),placement:"top",children:e.jsx("small",{children:N(s.content,50)})})}),e.jsx(r,{className:"text-center",children:e.jsx(ce,{children:e.jsx(l,{content:"View",placement:"top",children:e.jsx(g,{color:"info",onClick:()=>G(s),children:e.jsx(b,{icon:V})})})})})]},s._id))})]})})})})}),e.jsx(j,{children:e.jsx("div",{className:"mt-3 d-flex flex-row gap-2 justify-content-center align-items-center",children:e.jsx(O,{currentPage:o,totalPages:D,onPageChange:F})})})]})})};export{Ae as default};
