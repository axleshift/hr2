import{r as e}from"./react-router-dom-BnDDw25P.js";import{z as t}from"./zod-B0zZW6rS.js";import{u as a}from"./react-hook-form-DGCwHb0C.js";import{s as r}from"./@hookform/resolvers/zod-B5rlnuQ9.js";import{m as s,A as n,j as c,a as i,g as o,k as d,w as l,x as m,v as h,y as g}from"./index-BLIRSM9P.js";import{A as u}from"./AppPagination-BPJYwJ0G.js";import{F as p,M as y,J as f,K as b,u as C,_ as x,A as S,H as N}from"./index.es-CRPXNOK7.js";import{C as j}from"./CContainer-DmhTe4Fw.js";import{C as v,a as w}from"./CRow-D4E3xY6G.js";import{C as P,a as T}from"./CCardBody-MsfTf8qo.js";import{C as k}from"./CCardHeader-9R6NHvXM.js";import{C as I}from"./CTooltip-BGyzVSoB.js";import{C as A}from"./CCollapse-SfI5nDF9.js";import{C as E,a as $,b as F}from"./CFormLabel-Dv4O2zgG.js";import{C as M}from"./CFormInput-D99XWR3b.js";import{C as _}from"./CInputGroup-DGxo5biC.js";import{C as z}from"./CButtonGroup-D-BeYFAw.js";import{C as D,a as H,b as L}from"./CModalHeader-CuEQaytQ.js";import{C as V}from"./CModalTitle-U4wRIAgW.js";import{C as Y}from"./CModalFooter-BPgBJ4Z7.js";import{C as q}from"./CFormCheck-CoeiyBlt.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./isRTL-D5ORmfro.js";import"./DefaultLayout-DxUH6aq5.js";import"./index.esm-BBTc8KRx.js";const G=()=>{const{addToast:G}=e.useContext(s),[J,O]=e.useState([]),[R,U]=e.useState(!1),[W,B]=e.useState({}),[K,Q]=e.useState(!1),[X,Z]=e.useState(!0),[ee,te]=e.useState(!1),[ae,re]=e.useState(!1),[se,ne]=e.useState(!1),[ce,ie]=e.useState(""),[oe,de]=e.useState(!1),[le,me]=e.useState(1),[he,ge]=e.useState(9),[ue,pe]=e.useState(0),{userInformation:ye}=e.useContext(n),fe=async()=>{try{U(!0);const e=oe?await l(`/tags/search?query=${ce}&page=${le}&limit=${he}`):await l(`/tags/all?page=${le}&limit=${he}`);200===e.status?(O(e.data.data),pe(e.data.totalPages),me(e.data.currentPage),U(!1),G("Success","Tags are successfully retrieved","success")):(U(!1),G("Error","An error occurred while fetching the tags","danger"))}catch(e){U(!1),G("Error","An error occurred while fetching the tags","danger")}},be=t.object({id:t.string().optional(),name:t.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:t.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),isSystem:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),description:t.string().optional()}),{register:Ce,reset:xe,watch:Se,handleSubmit:Ne,formState:{errors:je,defaultValues:ve}}=a({resolver:r(be)});Se("isProtected");const we=Se("isSystem"),Pe=t.object({searchInput:t.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:Te,reset:ke,handleSubmit:Ie,formState:{errors:Ae}}=a({resolver:r(Pe)});return e.useEffect((()=>{const e=setTimeout((()=>{fe()}),300);return()=>clearTimeout(e)}),[le,he,oe,ce]),c(j,{className:"d-flex flex-column gap-3",children:[i(v,{children:i(j,{children:c(P,{children:[i(k,{children:c("div",{className:"d-flex justify-content-between align-items-center",children:[c("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[i("strong",{children:"Jobposting Form"}),i("span",{className:K?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:K?"Edit Mode":"Create Mode"})]}),c("div",{className:"d-flex flex-row gap-2",children:[K&&i(I,{content:"Reset form",placement:"top",children:i(o,{onClick:()=>(xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),void Z(!0)),className:"btn btn-danger",children:i(p,{icon:y})})}),i(I,{content:X?"Collapse":"Expand",placement:"top",children:i(o,{onClick:()=>Z(!X),className:"btn btn-primary",children:i(p,{icon:X?f:b})})})]})]})}),i(A,{visible:X,children:i(T,{children:i(E,{onSubmit:Ne((async e=>{try{const t=J.find((t=>t.name===e.name&&t.category===e.category));if(!K&&t)return;const a=K?await m(`/tags/${e.id}`,e):await h("/tags",e);200===a.status||201===a.status?(G("Success",K?"Tag is successfully updated":"Tag is successfully added","success"),xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),Z(!0),fe()):G("Error","An error occurred while adding the tag","danger")}catch(t){G("Error","An error occurred while adding the tag","danger")}})),children:c(j,{className:"d-flex flex-column gap-2",children:[i(v,{children:c(w,{children:[i(M,{type:"hidden",id:"id",...Ce("id"),invalid:!!je.id}),je&&je.id&&i($,{className:"text-danger",children:je.id.message}),i(M,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...Ce("name"),invalid:!!je.name}),je&&je.name&&i($,{className:"text-danger",children:je.name.message})]})}),i(v,{children:c(w,{children:[i(M,{type:"text",id:"category",placeholder:"Category",label:"Category",...Ce("category"),invalid:!!je.category}),je&&je.category&&i($,{className:"text-danger",children:je.category.message})]})}),i(v,{children:c(w,{children:[i(F,{children:"Protected?"}),c(_,{children:[i(M,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...Ce("isProtected"),invalid:!!je.isProtected}),i(I,{content:"Protect",placement:"top",children:i(o,{onClick:()=>xe({isProtected:!0}),className:"btn btn-primary",children:i(p,{icon:C})})}),i(I,{content:"Unprotect",placement:"top",children:i(o,{onClick:()=>xe({isProtected:!1}),className:"btn btn-warning",children:i(p,{icon:x})})})]}),je&&je.isProtected&&i($,{className:"text-danger",children:je.isProtected.message})]})}),i(v,{children:c(w,{children:[i(F,{children:"System Tag ?"}),c(_,{children:[i(M,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:we,...Ce("isSystem"),invalid:!!je.isSystem}),i(I,{content:"Protect",placement:"top",children:i(o,{onClick:()=>xe({isSystem:!0}),className:"btn btn-primary",children:i(p,{icon:C})})}),i(I,{content:"Unprotect",placement:"top",children:i(o,{onClick:()=>xe({isSystem:!1}),className:"btn btn-secondary",children:i(p,{icon:x})})})]}),je&&je.isSystem&&i($,{className:"text-danger",children:je.isSystem.message})]})}),i("div",{className:"d-flex justify-content-end",children:i(o,{color:"primary",type:"submit",className:"mb-3 w-25",children:K?"Update":"Submit"})})]})})})})]})})}),i(v,{children:c("div",{className:"d-flex justify-content-between",children:[i("div",{className:"d-flex justify-content-between align-items-center",children:i("h1",{children:"All Tags"})}),i("div",{children:c(E,{onSubmit:Ie((async e=>{try{ie(e.searchInput),de(!0),fe()}catch(t){}})),children:[c(_,{children:[i(M,{placeholder:"...",id:"searcInput",...Te("searchInput"),invalid:!!Ae.searchInput}),i(I,{content:"Search tags",placement:"top",children:i(o,{type:"submit",className:"btn btn-primary",children:i(p,{icon:S})})})]}),Ae&&Ae.searchInput&&i($,{className:"text-danger",children:Ae.searchInput.message})]})})]})}),i(v,{children:R?i("div",{className:"pt-3 text-center",children:i(d,{color:"primary",variant:"grow"})}):J.map(((e,t)=>i(w,{md:4,className:"mb-3",children:i(P,{className:"h-100",children:c(T,{children:[i(v,{className:"mb-3",children:c(w,{children:[i("h5",{className:"text-capitalize",children:e.name}),i("small",{className:"text-muted",children:e.category})]})}),i(v,{children:c(w,{children:[i("small",{children:"Protected:"})," ",i("small",{children:e.isProtected?"Yes":"No"}),i("br",{}),i("small",{children:"System:"})," ",i("small",{children:e.isSystem?"Yes":"No"})]})}),i(v,{children:i(w,{className:"d-flex justify-content-end",children:c(z,{children:[i(I,{content:"Edit tag",placement:"top",children:i(o,{color:"primary",onClick:()=>(async e=>{try{Q(!0),Z(!0);const t=await l(`/tags/${e}`);if(200===t.status){const e={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};xe(e),G("Success","Tag is successfully retrieved","success")}}catch(t){G("Error","An error occurred while fetching the tag","danger")}})(e._id),children:i(p,{icon:N})})}),i(I,{content:"Delete tag",placement:"top",children:i(o,{color:"danger",onClick:()=>(e=>{const t=J.find((t=>t._id===e));B(t),te(!0)})(e._id),disabled:e.isProtected,children:i(p,{icon:e.isProtected?C:y})})})]})})})]})})},t)))}),i(v,{children:i(w,{children:c(D,{visible:ee,onClose:()=>te(!1),children:[i(H,{children:i(V,{className:"text-danger",children:"Warning"})}),i(L,{children:c("div",{children:[i("p",{children:"Are you sure you want to delete this tag?"}),c("p",{children:["Name: ",i("strong",{children:W.name}),i("br",{}),"Category: ",i("strong",{children:W.category})]}),c("p",{children:[i("strong",{children:"Note:"})," This action cannot be undone."]}),i("p",{children:"There's no way to recover the tag once it's deleted."}),i("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),i("p",{children:i("strong",{children:"What this action does:"})}),i("p",{children:"It removes the tag from the system and removes the tag from any content."}),i("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),c(Y,{children:[c(w,{className:"d-flex justify-content-end",children:[i(q,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:ae,onChange:()=>re(!ae)}),i($,{invalid:!0,children:"You must agree before submitting."})]}),i(o,{onClick:()=>(async e=>{try{ne(!0);const t=await g(`/tags/${e}`);200===t.status?(G("Success","Tag has been deleted successfully","success"),fe(),te(!1)):(G("Error",t.message.message,"danger"),ne(!1))}catch(t){G("Error","An error occurred while deleting the tag","danger"),ne(!1)}})(W._id),disabled:!ae,className:"btn btn-danger",children:se?i(d,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),i(v,{children:i("div",{className:"d-flex justify-content-center",children:i(u,{currentPage:le,totalPages:ue||1,onPageChange:me})})})]})};export{G as default};
