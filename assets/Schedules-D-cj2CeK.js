import{A as e}from"./AppPagination-vWC6_7LU.js";import{F as t,f as a,_ as l,Z as n,T as s,W as r,$ as c,a0 as i,I as m,a1 as o,O as d,A as u}from"./index.es-DFhey9wz.js";import{C as E}from"./Calendar-DshA2L6-.js";import{R as p,r as g}from"./react-router-dom-BnDDw25P.js";import{f,i as b,P as y,l as v,v as S,r as C,w as h,x as w}from"./index-DXFVtbD_.js";import{u as N}from"./react-hook-form-DGCwHb0C.js";import{s as D}from"./@hookform/resolvers/zod-B5rlnuQ9.js";import{z as x}from"./zod-B0zZW6rS.js";import{C as j,a as T,b as k}from"./CModalHeader-CKCWLB_J.js";import{C as I}from"./CModalTitle-RZUDuE-6.js";import{C as A,a as F,b as q,c as R}from"./CFormInput-BzSWZSHN.js";import{C as V,a as L}from"./CRow-DSqRsHFr.js";import{C as M}from"./CInputGroup-8Ah49MHR.js";import{C as $}from"./CInputGroupText-B_3Av2bq.js";import{C as _}from"./CModalFooter-D79q550G.js";import{U as O,c as P,f as Y,t as z}from"./index-BxAblS3e.js";import{C as G,b as H,c as U,d as B,e as W}from"./DefaultLayout-k-e4BEYF.js";import{C as Z}from"./CTooltip-BHXnOH2f.js";import{C as K}from"./CFormTextarea-CmPGLOeR.js";import{C as Q}from"./CFormCheck-BuOCTX0n.js";import{C as X}from"./CContainer-CzB7k1pT.js";import{C as J,a as ee}from"./CCardBody-D4Qo47mg.js";import{C as te,a as ae,b as le,c as ne,d as se,e as re}from"./CTable-CpB37DUJ.js";import{C as ce}from"./CButtonGroup-BpxNmVVV.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./index.esm-JaDbXk68.js";import"./isRTL-D5ORmfro.js";import"./getTransitionDurationFromElement-2nBpLMKS.js";const ie=({isVisible:e,onClose:t,handleTimeSubmit:a,isLoading:l})=>{const[n,s]=p.useState(!1),[r,c]=p.useState(!1),i=x.object({start:x.string().min(1,{message:"Start time is required"}),end:x.string().min(1,{message:"End time is required"})}),{register:m,handleSubmit:o,formState:{errors:d}}=N({resolver:D(i)});return g.useEffect((()=>{s(e),c(l)}),[e,l]),p.createElement(j,{visible:e,onClose:()=>{t(),s(!1)},size:"sm"},p.createElement(T,null,p.createElement(I,null,"Add Timeslot")),p.createElement(k,null,p.createElement(A,{onSubmit:o(a)},p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,"Start Time"),p.createElement(F,{type:"time",...m("start"),invalid:!!d.start}),d.start&&p.createElement(q,{invalid:!0},d.start.message)))),p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,"End Time"),p.createElement(F,{type:"time",...m("end"),invalid:!!d.end}),d.end&&p.createElement(q,{invalid:!0},d.end.message)))),p.createElement(_,null,p.createElement(f,{type:"submit",className:"btn btn-primary"},r?p.createElement(b,{color:"primary"}):"Add Time"),p.createElement(f,{color:"secondary",onClick:t},"Cancel")))))};ie.propTypes={isVisible:y.bool.isRequired,onClose:y.func.isRequired,handleTimeSubmit:y.func.isRequired,isLoading:y.bool.isRequired};const me=({isVisible:e,onClose:m,isDarkMode:o,interviewData:d})=>{const u=new Date((new Date).setDate((new Date).getDate()-1)),{addToast:b}=g.useContext(v),[y,z]=g.useState(O(new Date)),[X,J]=g.useState(!1),[ee,te]=g.useState(!1),[ae,le]=g.useState({}),[ne,se]=g.useState({}),[re,ce]=g.useState(""),[me,oe]=g.useState([]),[de,ue]=g.useState([]),[Ee,pe]=g.useState(!1),[ge,fe]=g.useState(null),[be,ye]=g.useState(!1),[ve,Se]=g.useState([new Date(2024,10,15),new Date(2024,10,20)]),[Ce,he]=g.useState([new Date(2024,10,1),new Date(2024,10,5)]),[we,Ne]=g.useState(1),[De,xe]=g.useState(9),[je,Te]=g.useState(1),ke=x.object({title:x.string().min(1,{message:"Title is required"}),date:x.preprocess((e=>new Date(e)),x.date().min(u,{message:"Date should be today or later"})),timeslotId:x.string().optional(),start:x.string().min(1,{message:"Start time is required"}),end:x.string().min(1,{message:"End time is required"}),location:x.string().optional(),capacity:x.preprocess((e=>parseInt(e)),x.number().min(1,{message:"Capacity should be at least 1"})),additionalInfo:x.string().optional()}),{register:Ie,handleSubmit:Ae,reset:Fe,formState:{errors:qe}}=N({resolver:async(e,t,a)=>await D(ke)(e,t,a)}),Re=x.object({start:x.string().min(1,{message:"Start time is required"}),end:x.string().min(1,{message:"End time is required"})}).refine((async e=>{const[t,a]=e.start.split(":").map(Number),[l,n]=e.end.split(":").map(Number);return 60*t+a<60*l+n}),{message:"Start time should be before end time",path:["start"]}),{register:Ve,handleSubmit:Le,formState:{errors:Me}}=N({resolver:async(e,t,a)=>await D(Re)(e,t,a)}),$e=async e=>{try{const t=await S(`/interview/slots?date=${e}`);if(200===t.status){const e=t.data;oe(e.data);const a=e.data.filter((e=>e.isAvailable));ue(a)}else b("Error","Failed to fetch time slots","danger")}catch(t){oe([]),ue([])}},_e=()=>{Fe({applicantId:"",applicantName:"",date:new Date,start:null,end:null}),m()};return g.useEffect((()=>{$e(O(y))}),[y]),g.useEffect((()=>{d&&(te(!0),z(new Date(d.date)),Fe({title:d.title,timeslotId:d.timeslot._id,start:P(d.timeslot.start),end:P(d.timeslot.end),location:d.location,additionalInfo:d.additionalInfo}))}),[d]),p.createElement(p.Fragment,null,p.createElement(j,{visible:e,onClose:_e,size:"lg"},p.createElement(T,null,p.createElement(I,null,ee?"Edit Interview":"Schedule Interview")),p.createElement(k,null,p.createElement("div",{className:"mb-5"},p.createElement(E,{onChange:e=>{z(new Date(e))},defaultValue:y,className:o?"calendar dark-mode":"calendar",tileClassName:({date:e,view:t})=>"month"===t&&ve.find((t=>t.getDate()===e.getDate()))?"not-available":Ce.find((t=>t.getDate()===e.getDate()))?"has-events":""})),p.createElement(A,{onSubmit:Ae((async e=>{try{const t={date:y,title:e.title,timeslotRef_id:e.timeslotId,additionalInfo:e.additionalInfo,location:e.location,capacity:e.capacity},a=ee?await h(`/interview/schedule/${d._id}`,t):await C("/interview/schedule",t);200===a.status||201===a.status?(b("Success","Interview scheduled successfully","success"),_e()):b("Calendar | Schedule Form",a.message.message,"danger")}catch(t){b("Error","Failed to schedule interview","danger")}}))},p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,p.createElement(t,{icon:a})),p.createElement(F,{type:"text",placeholder:"Title",...Ie("title"),invalid:!!qe.title})),qe.title&&p.createElement(q,{invalid:!0},qe.title.message))),me&&0!==me.length?p.createElement(p.Fragment,null,p.createElement(V,null,p.createElement(L,null,p.createElement(R,null,"Time Slots"))),p.createElement(V,null,p.createElement(L,{className:"d-flex flex-wrap gap-2 justify-content-start"},me.map(((e,a)=>p.createElement("div",{key:a,className:"mb-3"},p.createElement(G,{color:e.isAvailable?"success":"danger"},P(e.start)," -"," ",P(e.end)," ",p.createElement(Z,{content:e.isAvailable?"Available":"Not Available",placement:"top"},p.createElement(t,{icon:e.isAvailable?l:n})),p.createElement(Z,{content:"Delete Time Slot",placement:"top"},p.createElement(f,{onClick:()=>(async e=>{try{200===(await w(`/interview/slot/${e}`)).status?(b("Success","Time slot deleted successfully","success"),$e(y)):b("Error","Something went wrong. Unable to delete time slot.","danger")}catch(t){}})(e._id),className:"btn"},p.createElement(t,{icon:s})))))))))):p.createElement(V,{className:"text-danger"},p.createElement(L,null,p.createElement(R,null,"Click a Date to view its timeslot, if none.. add one."))),p.createElement(V,null,p.createElement(L,{className:"d-flex justify-content-end align-items-center"},p.createElement(Z,{content:"Add Time Slot",placement:"top"},p.createElement(f,{onClick:()=>pe(!0),className:"btn btn-success mb-3"},p.createElement(t,{icon:r}))))),p.createElement(V,null,p.createElement(L,{md:4},p.createElement(M,{className:"mb-3"},p.createElement($,null,"Date"),p.createElement(F,{type:"text",...Ie("date"),invalid:!!qe.date,value:Y(y),readOnly:!0,className:"visually-hidden"}),p.createElement(F,{type:"text",invalid:!!qe.date,value:Y(y),readOnly:!0}),qe.date&&p.createElement(q,{invalid:!0},qe.date.message))),p.createElement(L,{md:8},p.createElement(M,{className:"mb-3"},p.createElement($,null,p.createElement(t,{icon:c})),p.createElement(F,{type:"text",placeholder:"Start Time",readOnly:!0,...Ie("start"),invalid:!!qe.start}),qe.start&&p.createElement(q,{invalid:!0},qe.start.message),p.createElement(F,{type:"text",placeholder:"End Time",readOnly:!0,...Ie("end"),invalid:!!qe.end}),qe.end&&p.createElement(q,{invalid:!0},qe.end.message),p.createElement(Z,{content:"Set Time Slot",placement:"top"},p.createElement(H,null,p.createElement(U,{color:"primary"},"Time"),p.createElement(B,null,de.map(((e,t)=>p.createElement(W,{key:t,onClick:()=>{fe(e),Fe({timeslotId:e._id,start:P(e.start),end:P(e.end)})},disabled:0===de.length},P(e.start)," -"," ",P(e.end)))))))))),p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,"Location"),p.createElement(F,{type:"text",placeholder:"Location",...Ie("location"),invalid:!!qe.location}),qe.location&&p.createElement(q,{invalid:!0},qe.location.message)))),p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,"Capacity"),p.createElement(F,{type:"number",placeholder:"capacity ",...Ie("capacity"),invalid:!!qe.capacity,defaultValue:1}),qe.capacity&&p.createElement(q,{invalid:!0},qe.capacity.message)))),p.createElement(V,null,p.createElement(L,null,p.createElement(M,{className:"mb-3"},p.createElement($,null,p.createElement(t,{icon:i})),p.createElement(K,{type:"text",placeholder:"Additional Information",...Ie("additionalInfo"),invalid:!!qe.additionalInfo}),qe.additionalInfo&&p.createElement(q,{invalid:!0},qe.additionalInfo.message)))),p.createElement(V,null,p.createElement(L,{className:"d-flex justify-content-end"},p.createElement(Q,{type:"checkbox",id:"invalidCheck",label:"I confirm everything is correct.",checked:X,onChange:()=>J(!X)}),p.createElement(q,{invalid:!0},"You must agree before submitting."))),p.createElement(_,null,p.createElement(f,{type:"submit",disabled:!X,className:"btn btn-primary"},ee?"Update":"Schedule"),p.createElement(f,{color:"secondary",onClick:_e},"Cancel"))))),p.createElement(ie,{isVisible:Ee,onClose:()=>{pe(!1)},handleTimeSubmit:async e=>{ye(!0);try{const t={date:y,timeslot:{start:e.start,end:e.end}},a=await C("/interview/slots/",t);200===a.status||201===a.status?(b("Success","Time slot added successfully","success"),$e(y),ye(!1)):b("Calendar | Timeslots",a.message.message,"danger")}catch(t){ye(!1)}},isLoading:be}))};me.propTypes={isVisible:y.bool.isRequired,onClose:y.func.isRequired,isDarkMode:y.bool.isRequired,interviewData:y.object};const oe=({theme:a})=>{const l="dark"===a,{addToast:n}=g.useContext(v),[c,i]=g.useState(!1),[y,C]=g.useState([new Date,new Date]),[h,N]=g.useState(O(new Date)),[D,x]=g.useState(new Date),[j,T]=g.useState([]),[k,I]=g.useState(!1),[q,R]=g.useState([new Date(2024,10,15),new Date(2024,10,20)]),[$,_]=g.useState([new Date(2024,10,1),new Date(2024,10,5)]),[H,U]=g.useState(!1),[B,W]=g.useState(1),[K,Q]=g.useState(9),[ie,oe]=g.useState(1),[de,ue]=g.useState([]),[Ee,pe]=g.useState(null),[ge,fe]=g.useState([{color:"danger",text:"Not Available"},{color:"warning",text:"Has Events"},{color:"primary",text:"Selected Date"}]),be=async e=>{I(!0);try{const t=await S(`/interview/all?date=${e}&page=${B}&limit=${K}`);200===t.status||201===t.status?(ue(t.data.data),T(t.data.slots),oe(t.data.totalPages),I(!1)):(I(!1),ue([]),T([]),n("Calendar | Schedules",t.message.message,"danger"))}catch(t){const a=`Failed to fetch interview schedules for ${Y(e)}`;n("Error",a,"error"),I(!1)}};return g.useEffect((()=>{const e=setTimeout((()=>{be(h)}),1e3);return()=>clearTimeout(e)}),[h]),g.useEffect((()=>{H&&Ee&&U(!1)}),[B]),p.createElement(p.Fragment,null,p.createElement(X,{className:"d-flex flex-column gap-3"},p.createElement(V,null,p.createElement(L,null,p.createElement("h2",null,"Schedules"),p.createElement("small",null,"In this page, you can create and edit schedules for interviews, task, or any other events."))),p.createElement(V,null,p.createElement(X,null,p.createElement(J,null,p.createElement(ee,null,p.createElement("div",null,ge.map(((e,t)=>p.createElement(G,{key:t,color:e.color,className:"me-2"},e.text)))),p.createElement("div",null,p.createElement(E,{onChange:e=>{e.length>1?C(e):N(e)},selectRange:c,className:l?"calendar dark-mode":"calendar",tileClassName:({date:e,view:t})=>"month"===t&&q.find((t=>t.getDate()===e.getDate()))?"not-available":$.find((t=>t.getDate()===e.getDate()))?"has-events":"",defaultValue:c?[new Date(y[0]),new Date(y[1])]:new Date(h)})),p.createElement("br",null),p.createElement("div",null,p.createElement(M,null,p.createElement(F,{type:"text",placeholder:"start",value:Y(h),readOnly:!0}),p.createElement(Z,{content:"Create interview",placement:"top"},p.createElement(f,{onClick:()=>U(!0),className:"btn btn-primary"},p.createElement(t,{icon:r}))))))))),p.createElement(V,null,p.createElement(L,null,p.createElement(A,null,p.createElement(M,null,p.createElement(F,{type:"text",placeholder:"Search"}),p.createElement(f,{color:"primary"},p.createElement(t,{icon:m})))))),p.createElement(V,null,p.createElement(L,null,p.createElement(J,null,p.createElement(ee,null,p.createElement(te,{align:"middle",hover:!0,responsive:!0,striped:!0},p.createElement(ae,null,p.createElement(le,null,p.createElement(ne,{className:"text-center"},p.createElement(t,{icon:o})),p.createElement(ne,{className:"text-center"},"Date"),p.createElement(ne,{className:"text-center"},"Time"),p.createElement(ne,{className:"text-center"},"Location"),p.createElement(ne,{className:"text-center"},"Capacity"),p.createElement(ne,{className:"text-center"},"Action"))),p.createElement(se,null,k?p.createElement(le,null,p.createElement(re,{colSpan:"6",className:"text-center"},p.createElement(b,{color:"primary",variant:"grow"}))):0===de.length?p.createElement(le,null,p.createElement(re,{colSpan:"6",className:"text-center"},"No data available for"," ",p.createElement("span",{className:"text-info"},Y(h,"MMM d, YYYY")))):de.map(((e,a)=>p.createElement(le,{key:a},p.createElement(re,{className:"text-center"},e.title),p.createElement(re,{className:"text-center"},Y(e.date)),p.createElement(re,{className:"text-center"},P(e.timeslot.start)," -"," ",P(e.timeslot.end)),p.createElement(re,{className:"text-center"},e.location?z(e.location,20):"N/A"),p.createElement(re,{className:"text-center"},e.capacity?z(e.capacity,20):"N/A"),p.createElement(re,{className:"text-center"},p.createElement(ce,null,p.createElement(f,{onClick:()=>{pe(e),U(!0)},className:"btn btn-primary"},p.createElement(Z,{content:"Edit",placement:"top"},p.createElement(t,{icon:d}))," "),p.createElement(f,{onClick:()=>(async e=>{try{200===(await w(`/interview/schedule/${e}`)).status?(n("Success","Successfully deleted interview schedule","success"),be(h)):n("Error","Failed to delete interview schedule","error")}catch(t){n("Error","Failed to delete interview schedule","error")}})(e._id),className:"btn btn-danger"},p.createElement(Z,{content:"Delete",placement:"top"},p.createElement(t,{icon:s}))," "),p.createElement(f,{className:"btn btn-warning"},p.createElement(Z,{content:"Cancel",placement:"top"},p.createElement(t,{icon:u})))))))))))))),p.createElement(V,null,p.createElement(L,null,p.createElement("div",{className:"d-flex justify-content-center align-items-center"},p.createElement(e,{currentPage:B,totalPages:ie,onPageChange:W})))),p.createElement(V,null,p.createElement(me,{isVisible:H,onClose:()=>U(!1),isDarkMode:l,interviewData:Ee}))))};oe.propTypes={theme:y.string};export{oe as default};
