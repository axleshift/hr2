import{r as e}from"./react-router-dom-BnDDw25P.js";import{z as t}from"./zod-B0zZW6rS.js";import{u as a}from"./react-hook-form-DB8hWBdy.js";import{s as r}from"./@hookform/resolvers/zod-1wp20Skh.js";import{m as s,A as n,j as c,a as i,g as o,k as d,w as l,x as m,v as h,y as g}from"./index-DVAAnj-9.js";import{A as u}from"./AppPagination-D5Gejofw.js";import{F as p,N as y,K as f,L as C,v as b,a4 as x,B as S,I as j}from"./index.es-DNrzUf6T.js";import{C as N}from"./CContainer-C-7WEMUq.js";import{C as v,a as w}from"./CRow-Dujfgc-X.js";import{C as P,a as T}from"./CCardBody-D-rMfn6F.js";import{C as k}from"./CCardHeader-P4bzxz2C.js";import{C as I}from"./CTooltip-BemHtZwS.js";import{C as A}from"./CCollapse-OstKnTbo.js";import{C as E,a as z,b as $}from"./CFormLabel-C3ZNjviW.js";import{C as F}from"./CFormInput-DlNfdHmF.js";import{C as _}from"./CInputGroup-DvwMqNE_.js";import{C as L}from"./CButtonGroup-DW_RYc2c.js";import{C as M,a as D,b as R}from"./CModalHeader-D3Pijq-f.js";import{C as U}from"./CModalTitle-DWg7cv10.js";import{C as V}from"./CModalFooter-BM6mduy6.js";import{C as Y}from"./CFormCheck-DxhrmDYV.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./isRTL-D5ORmfro.js";import"./DefaultLayout-BQRtu9S-.js";import"./index.esm-CRpYSObv.js";const q=()=>{const{addToast:q}=e.useContext(s),[B,G]=e.useState([]),[H,O]=e.useState(!1),[J,K]=e.useState({}),[W,Q]=e.useState(!1),[X,Z]=e.useState(!0),[ee,te]=e.useState(!1),[ae,re]=e.useState(!1),[se,ne]=e.useState(!1),[ce,ie]=e.useState(""),[oe,de]=e.useState(!1),[le,me]=e.useState(1),[he,ge]=e.useState(9),[ue,pe]=e.useState(0),{userInformation:ye}=e.useContext(n),fe=async()=>{try{O(!0);const e=oe?await l(`/tags/search?query=${ce}&page=${le}&limit=${he}`):await l(`/tags/all?page=${le}&limit=${he}`);200===e.status?(G(e.data.data),pe(e.data.totalPages),me(e.data.currentPage),O(!1),q("Success","Tags are successfully retrieved","success")):(O(!1),q("Error","An error occurred while fetching the tags","danger"))}catch(e){O(!1),q("Error","An error occurred while fetching the tags","danger")}},Ce=t.object({id:t.string().optional(),name:t.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:t.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),isSystem:t.preprocess((e=>"true"===e||!0===e),t.boolean()).optional().default(!1),description:t.string().optional()}),{register:be,reset:xe,watch:Se,handleSubmit:je,formState:{errors:Ne,defaultValues:ve}}=a({resolver:r(Ce)});Se("isProtected");const we=Se("isSystem"),Pe=t.object({searchInput:t.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:Te,reset:ke,handleSubmit:Ie,formState:{errors:Ae}}=a({resolver:r(Pe)});return e.useEffect((()=>{const e=setTimeout((()=>{fe()}),300);return()=>clearTimeout(e)}),[le,he,oe,ce]),c(N,{className:"d-flex flex-column gap-3",children:[i(v,{children:i(N,{children:c(P,{children:[i(k,{children:c("div",{className:"d-flex justify-content-between align-items-center",children:[c("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[i("strong",{children:"Jobposting Form"}),i("span",{className:W?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:W?"Edit Mode":"Create Mode"})]}),c("div",{className:"d-flex flex-row gap-2",children:[W&&i(I,{content:"Reset form",placement:"top",children:i(o,{onClick:()=>(xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),void Z(!0)),className:"btn btn-danger",children:i(p,{icon:y})})}),i(I,{content:X?"Collapse":"Expand",placement:"top",children:i(o,{onClick:()=>Z(!X),className:"btn btn-primary",children:i(p,{icon:X?f:C})})})]})]})}),i(A,{visible:X,children:i(T,{children:i(E,{onSubmit:je((async e=>{try{const t=B.find((t=>t.name===e.name&&t.category===e.category));if(!W&&t)return;const a=W?await m(`/tags/${e.id}`,e):await h("/tags",e);200===a.status||201===a.status?(q("Success",W?"Tag is successfully updated":"Tag is successfully added","success"),xe({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),Q(!1),Z(!0),fe()):q("Error","An error occurred while adding the tag","danger")}catch(t){q("Error","An error occurred while adding the tag","danger")}})),children:c(N,{className:"d-flex flex-column gap-2",children:[i(v,{children:c(w,{children:[i(F,{type:"hidden",id:"id",...be("id"),invalid:!!Ne.id}),Ne&&Ne.id&&i(z,{className:"text-danger",children:Ne.id.message}),i(F,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...be("name"),invalid:!!Ne.name}),Ne&&Ne.name&&i(z,{className:"text-danger",children:Ne.name.message})]})}),i(v,{children:c(w,{children:[i(F,{type:"text",id:"category",placeholder:"Category",label:"Category",...be("category"),invalid:!!Ne.category}),Ne&&Ne.category&&i(z,{className:"text-danger",children:Ne.category.message})]})}),i(v,{children:c(w,{children:[i($,{children:"Protected?"}),c(_,{children:[i(F,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...be("isProtected"),invalid:!!Ne.isProtected}),i(I,{content:"Protect",placement:"top",children:i(o,{onClick:()=>xe({isProtected:!0}),color:"primary",children:i(p,{icon:b})})}),i(I,{content:"Unprotect",placement:"top",children:i(o,{onClick:()=>xe({isProtected:!1}),color:"warning",children:i(p,{icon:x})})})]}),Ne&&Ne.isProtected&&i(z,{className:"text-danger",children:Ne.isProtected.message})]})}),i(v,{className:"mb-3",children:c(w,{children:[i($,{children:"System Tag ?"}),c(_,{children:[i(F,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:we,...be("isSystem"),invalid:!!Ne.isSystem}),i(I,{content:"Protect",placement:"top",children:i(o,{onClick:()=>xe({isSystem:!0}),color:"primary",children:i(p,{icon:b})})}),i(I,{content:"Unprotect",placement:"top",children:i(o,{onClick:()=>xe({isSystem:!1}),color:"secondary",children:i(p,{icon:x})})})]}),Ne&&Ne.isSystem&&i(z,{className:"text-danger",children:Ne.isSystem.message})]})}),i("div",{className:"d-flex justify-content-end",children:i(o,{color:"primary",type:"submit",children:W?"Update":"Submit"})})]})})})})]})})}),i(v,{children:c("div",{className:"d-flex justify-content-between",children:[i("div",{className:"d-flex justify-content-between align-items-center",children:i("h1",{children:"All Tags"})}),i("div",{children:c(E,{onSubmit:Ie((async e=>{try{ie(e.searchInput),de(!0),fe()}catch(t){}})),children:[c(_,{children:[i(F,{placeholder:"...",id:"searcInput",...Te("searchInput"),invalid:!!Ae.searchInput}),i(I,{content:"Search tags",placement:"top",children:i(o,{type:"submit",color:"primary",size:"sm",children:i(p,{icon:S})})})]}),Ae&&Ae.searchInput&&i(z,{className:"text-danger",children:Ae.searchInput.message})]})})]})}),i(v,{children:H?i("div",{className:"pt-3 text-center",children:i(d,{color:"primary",variant:"grow"})}):B.map(((e,t)=>i(w,{md:4,className:"mb-3",children:i(P,{className:"h-100",children:c(T,{children:[i(v,{className:"mb-3",children:c(w,{children:[i("h5",{className:"text-capitalize",children:e.name}),i("small",{className:"text-muted",children:e.category})]})}),i(v,{children:c(w,{children:[i("small",{children:"Protected:"})," ",i("small",{children:e.isProtected?"Yes":"No"}),i("br",{}),i("small",{children:"System:"})," ",i("small",{children:e.isSystem?"Yes":"No"})]})}),i(v,{children:i(w,{className:"d-flex justify-content-end",children:c(L,{children:[i(I,{content:"Edit tag",placement:"top",children:i(o,{color:"primary",size:"sm",onClick:()=>(async e=>{try{Q(!0),Z(!0);const t=await l(`/tags/${e}`);if(200===t.status){const e={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};xe(e),q("Success","Tag is successfully retrieved","success")}}catch(t){q("Error","An error occurred while fetching the tag","danger")}})(e._id),children:i(p,{icon:j})})}),i(I,{content:"Delete tag",placement:"top",children:i(o,{color:"danger",size:"sm",onClick:()=>(e=>{const t=B.find((t=>t._id===e));K(t),te(!0)})(e._id),disabled:e.isProtected,children:i(p,{icon:e.isProtected?b:y})})})]})})})]})})},t)))}),i(v,{children:i(w,{children:c(M,{visible:ee,onClose:()=>te(!1),children:[i(D,{children:i(U,{className:"text-danger",children:"Warning"})}),i(R,{children:c("div",{children:[i("p",{children:"Are you sure you want to delete this tag?"}),c("p",{children:["Name: ",i("strong",{children:J.name}),i("br",{}),"Category: ",i("strong",{children:J.category})]}),c("p",{children:[i("strong",{children:"Note:"})," This action cannot be undone."]}),i("p",{children:"There's no way to recover the tag once it's deleted."}),i("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),i("p",{children:i("strong",{children:"What this action does:"})}),i("p",{children:"It removes the tag from the system and removes the tag from any content."}),i("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),c(V,{children:[c(w,{className:"d-flex justify-content-end",children:[i(Y,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:ae,onChange:()=>re(!ae)}),i(z,{invalid:!0,children:"You must agree before submitting."})]}),i(o,{onClick:()=>(async e=>{try{ne(!0);const t=await g(`/tags/${e}`);200===t.status?(q("Success","Tag has been deleted successfully","success"),fe(),te(!1)):(q("Error",t.message.message,"danger"),ne(!1))}catch(t){q("Error","An error occurred while deleting the tag","danger"),ne(!1)}})(J._id),disabled:!ae,size:"sm",children:se?i(d,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),i(v,{children:i("div",{className:"d-flex justify-content-center",children:i(u,{currentPage:le,totalPages:ue||1,onPageChange:me})})})]})};export{q as default};
