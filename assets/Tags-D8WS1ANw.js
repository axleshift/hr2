import{r,o as me,A as he,k as e,g as c,l as xe,G as k,E as ge,F as ue,I as je}from"./index-8dmFFJ_i.js";import{z as o,u as U,t as G}from"./zod-w4xg3E0H.js";import{A as pe}from"./AppPagination-Dg2q7CGb.js";import{F as d,t as L,m as fe,n as ye,k as _,x as Ce,y as be,z as Se,o as Ne,s as Pe}from"./index.es-BY3aiGxY.js";import{C as m,c as Te}from"./index-TUeKpTRY.js";import{C as F}from"./CContainer-DYk49lQp.js";import{C as n,a as i}from"./CRow-BNC0kilN.js";import{C as z,a as B}from"./CCardBody-6MR8J0sZ.js";import{C as ve}from"./CCardHeader-DcdlUJ7o.js";import{C as we}from"./CCollapse-DOg9hZxg.js";import{C as H,a as j,c as g,b as q}from"./CFormInput-B0ldU7KH.js";import{C as D}from"./CInputGroup-DJqzcEZc.js";import{C as Ie}from"./CCardFooter-CJpjg98G.js";import{C as Ee}from"./CButtonGroup-X1A2YeKA.js";import{C as ke,a as Fe,b as De,c as Ae,d as Me}from"./CModalTitle-DwWTV6Ds.js";import{C as Re}from"./CFormCheck-B7jgu3E-.js";import"./DefaultLayout-DS1H8VXZ.js";import"./index.esm-BtpFi0sf.js";const ts=()=>{const{addToast:l}=r.useContext(me),[N,Y]=r.useState([]),[P,O]=r.useState({}),[h,T]=r.useState(!1),[f,y]=r.useState(!0),[V,v]=r.useState(!1),[w,W]=r.useState(!1),[J,I]=r.useState(!1),[A,K]=r.useState(""),[M,Q]=r.useState(!1),[C,R]=r.useState(1),[E,$e]=r.useState(9),[X,Z]=r.useState(0);r.useContext(he);const b=async()=>{try{const s=M?await k(`/tags/search?query=${A}&page=${C}&limit=${E}`):await k(`/tags/all?page=${C}&limit=${E}`);s.status===200?(Y(s.data.data),Z(s.data.totalPages),R(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},ee=o.object({id:o.string().optional(),name:o.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:o.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),isSystem:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),description:o.string().optional()}),{register:p,reset:x,handleSubmit:se,formState:{errors:a}}=U({resolver:G(ee)}),te=async s=>{try{const t=N.find($=>$.name===s.name&&$.category===s.category);if(!h&&t){console.log("Tag already exist");return}console.log(s);const u=h?await ge(`/tags/${s.id}`,s):await ue("/tags",s);u.status===200||u.status===201?(h?l("Success","Tag is successfully updated","success"):l("Success","Tag is successfully added","success"),x({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),T(!1),y(!0),b()):l("Error","An error occurred while adding the tag","danger")}catch{l("Error","An error occurred while adding the tag","danger")}},ae=async s=>{try{T(!0),y(!0);const t=await k(`/tags/${s}`);if(t.status===200){const u={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};x(u),l("Success","Tag is successfully retrieved","success")}}catch{l("Error","An error occurred while fetching the tag","danger")}},re=s=>{const t=N.find(u=>u._id===s);O(t),v(!0)},ne=async s=>{try{I(!0);const t=await je(`/tags/${s}`);t.status===200?(l("Success","Tag has been deleted successfully","success"),b(),v(!1)):(console.log(t),l("Error",t.message.message,"danger"),I(!1))}catch{l("Error","An error occurred while deleting the tag","danger"),I(!1)}},ce=()=>{x({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),T(!1),y(!0)},oe=o.object({searchInput:o.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:ie,reset:Ue,handleSubmit:le,formState:{errors:S}}=U({resolver:G(oe)}),de=async s=>{try{console.log(s),K(s.searchInput),Q(!0),b()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{b()},300);return()=>clearTimeout(s)},[C,E,M,A]),e.jsxs(F,{className:"d-flex flex-column gap-3",children:[e.jsx(n,{children:e.jsx(F,{children:e.jsxs(z,{children:[e.jsx(ve,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:h?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:h?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[h&&e.jsx(m,{content:"Reset form",placement:"top",children:e.jsx(c,{onClick:()=>ce(),className:"btn btn-danger",children:e.jsx(d,{icon:L})})}),e.jsx(m,{content:f?"Collapse":"Expand",placement:"top",children:e.jsx(c,{onClick:()=>y(!f),className:"btn btn-primary",children:e.jsx(d,{icon:f?fe:ye})})})]})]})}),e.jsx(we,{visible:f,children:e.jsx(B,{children:e.jsx(H,{onSubmit:se(te),children:e.jsxs(F,{className:"d-flex flex-column gap-2",children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(j,{type:"hidden",id:"id",...p("id"),invalid:!!a.id}),a&&a.id&&e.jsx(g,{className:"text-danger",children:a.id.message}),e.jsx(j,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...p("name"),invalid:!!a.name}),a&&a.name&&e.jsx(g,{className:"text-danger",children:a.name.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(j,{type:"text",id:"category",placeholder:"Category",label:"Category",...p("category"),invalid:!!a.category}),a&&a.category&&e.jsx(g,{className:"text-danger",children:a.category.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"Protected?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...p("isProtected"),invalid:!!a.isProtected}),e.jsx(m,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>x({isProtected:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:_})})}),e.jsx(m,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>x({isProtected:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:Ce})})})]}),a&&a.isProtected&&e.jsx(g,{className:"text-danger",children:a.isProtected.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"System Tag ?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:!1,...p("isSystem"),invalid:!!a.isSystem}),e.jsx(m,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>x({isSystem:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:be})})}),e.jsx(m,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>x({isSystem:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:Se})})})]}),a&&a.isSystem&&e.jsx(g,{className:"text-danger",children:a.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(c,{color:"primary",type:"submit",className:"mb-3 w-25",children:h?"Update":"Submit"})})]})})})})]})})}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(H,{onSubmit:le(de),children:[e.jsxs(D,{children:[e.jsx(j,{placeholder:"...",id:"searcInput",...ie("searchInput"),invalid:!!S.searchInput}),e.jsx(m,{content:"Search tags",placement:"top",children:e.jsx(c,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:Ne})})})]}),S&&S.searchInput&&e.jsx(g,{className:"text-danger",children:S.searchInput.message})]})})]})}),e.jsx(n,{children:N.map((s,t)=>e.jsx(i,{md:4,className:"mb-3",children:e.jsxs(z,{className:"h-100",children:[e.jsxs(B,{children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx("h5",{children:Te(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(n,{children:e.jsxs(i,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(n,{children:e.jsxs(i,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsx(Ie,{children:e.jsx(n,{children:e.jsx(i,{children:e.jsxs(Ee,{children:[e.jsx(m,{content:"Edit tag",placement:"top",children:e.jsx(c,{color:"primary",onClick:()=>ae(s._id),children:e.jsx(d,{icon:Pe})})}),e.jsx(m,{content:"Delete tag",placement:"top",children:e.jsx(c,{color:"danger",onClick:()=>re(s._id),disabled:s.isProtected,children:e.jsx(d,{icon:s.isProtected?_:L})})})]})})})})]})},t))}),e.jsx(n,{children:e.jsx(i,{children:e.jsxs(ke,{visible:V,onClose:()=>v(!1),children:[e.jsx(Fe,{children:e.jsx(De,{className:"text-danger",children:"Warning"})}),e.jsx(Ae,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:P.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:P.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs(Me,{children:[e.jsxs(i,{className:"d-flex justify-content-end",children:[e.jsx(Re,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:w,onChange:()=>W(!w)}),e.jsx(g,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(c,{onClick:()=>ne(P._id),disabled:!w,className:"btn btn-danger",children:J?e.jsx(xe,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(pe,{currentPage:C,totalPages:X||1,onPageChange:R})})})]})};export{ts as default};
