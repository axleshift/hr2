import{r,o as me,A as he,k as e,g as c,l as xe,G as k,E as ge,F as ue,I as je}from"./index-KHm1mH3k.js";import{z as o,u as U,t as G}from"./zod-CFmHbypN.js";import{A as pe}from"./AppPagination-BiYQEyzY.js";import{F as l,t as L,m as fe,n as ye,k as _,x as Ce,y as be,z as Se,o as Ne,s as Pe}from"./index.es-sQhn--Jt.js";import{C as d,c as Te}from"./index-C1B4Sn2j.js";import{C as F}from"./CContainer-DKpHU2Ko.js";import{C as n,a as i}from"./CRow-CN5wgcX7.js";import{C as z,a as B}from"./CCardBody-DGq9anN6.js";import{C as ve}from"./CCardHeader-Cn3wuz5R.js";import{C as we}from"./CCollapse-CUodyUvt.js";import{C as H,a as j,c as x,b as q}from"./CFormInput-B6-RLuCh.js";import{C as D}from"./CInputGroup-C05_q-JA.js";import{C as Ie}from"./CCardFooter-CvrIBZyH.js";import{C as Ee}from"./CButtonGroup-D1f9Y4fr.js";import{C as ke,a as Fe,b as De,c as Ae,d as Me}from"./CModalTitle-OzQzWWmi.js";import{C as Re}from"./CFormCheck-g4jB9WVA.js";import"./DefaultLayout-vsFCcCNx.js";import"./index.esm-Vk_vAEPA.js";const ts=()=>{const{addToast:m}=r.useContext(me),[N,Y]=r.useState([]),[P,O]=r.useState({}),[g,T]=r.useState(!1),[f,y]=r.useState(!0),[V,v]=r.useState(!1),[w,W]=r.useState(!1),[J,I]=r.useState(!1),[A,K]=r.useState(""),[M,Q]=r.useState(!1),[C,R]=r.useState(1),[E,$e]=r.useState(9),[X,Z]=r.useState(0);r.useContext(he);const b=async()=>{try{const s=M?await k(`/tags/search?query=${A}&page=${C}&limit=${E}`):await k(`/tags/all?page=${C}&limit=${E}`);s.status===200?(Y(s.data.data),Z(s.data.totalPages),R(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},ee=o.object({id:o.string().optional(),name:o.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:o.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),isSystem:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),description:o.string().optional()}),{register:p,reset:h,handleSubmit:se,formState:{errors:a}}=U({resolver:G(ee)}),te=async s=>{try{const t=N.find($=>$.name===s.name&&$.category===s.category);if(!g&&t){console.log("Tag already exist");return}console.log(s);const u=g?await ge(`/tags/${s.id}`,s):await ue("/tags",s);u.status===200||u.status===201?(m("Success","Tag has been added successfully","success"),h({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),T(!1),y(!0),b()):m("Error","An error occurred while adding the tag","danger")}catch{m("Error","An error occurred while adding the tag","danger")}},ae=async s=>{try{T(!0),y(!0);const t=await k(`/tags/${s}`);if(t.status===200){const u={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};h(u),m("Success","Tag is successfully retrieved","success")}}catch{m("Error","An error occurred while fetching the tag","danger")}},re=s=>{const t=N.find(u=>u._id===s);O(t),v(!0)},ne=async s=>{try{I(!0);const t=await je(`/tags/${s}`);t.status===200?(m("Success","Tag has been deleted successfully","success"),b(),v(!1)):(console.log(t),m("Error",t.message.message,"danger"),I(!1))}catch{m("Error","An error occurred while deleting the tag","danger"),I(!1)}},ce=()=>{h({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),T(!1),y(!0)},oe=o.object({searchInput:o.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:ie,reset:Ue,handleSubmit:le,formState:{errors:S}}=U({resolver:G(oe)}),de=async s=>{try{console.log(s),K(s.searchInput),Q(!0),b()}catch(t){console.log(t)}};return r.useEffect(()=>{const s=setTimeout(()=>{b()},300);return()=>clearTimeout(s)},[C,E,M,A]),e.jsxs(F,{className:"d-flex flex-column gap-3",children:[e.jsx(n,{children:e.jsx(F,{children:e.jsxs(z,{children:[e.jsx(ve,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:g?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:g?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[g&&e.jsx(d,{content:"Reset form",placement:"top",children:e.jsx(c,{onClick:()=>ce(),className:"btn btn-danger",children:e.jsx(l,{icon:L})})}),e.jsx(d,{content:f?"Collapse":"Expand",placement:"top",children:e.jsx(c,{onClick:()=>y(!f),className:"btn btn-primary",children:e.jsx(l,{icon:f?fe:ye})})})]})]})}),e.jsx(we,{visible:f,children:e.jsx(B,{children:e.jsx(H,{onSubmit:se(te),children:e.jsxs(F,{className:"d-flex flex-column gap-2",children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(j,{type:"hidden",id:"id",...p("id"),invalid:!!a.id}),a&&a.id&&e.jsx(x,{className:"text-danger",children:a.id.message}),e.jsx(j,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...p("name"),invalid:!!a.name}),a&&a.name&&e.jsx(x,{className:"text-danger",children:a.name.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(j,{type:"text",id:"category",placeholder:"Category",label:"Category",...p("category"),invalid:!!a.category}),a&&a.category&&e.jsx(x,{className:"text-danger",children:a.category.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"Protected?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...p("isProtected"),invalid:!!a.isProtected}),e.jsx(d,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>h({isProtected:!0}),className:"btn btn-primary",children:e.jsx(l,{icon:_})})}),e.jsx(d,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>h({isProtected:!1}),className:"btn btn-warning",children:e.jsx(l,{icon:Ce})})})]}),a&&a.isProtected&&e.jsx(x,{className:"text-danger",children:a.isProtected.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"System Tag ?"}),e.jsxs(D,{children:[e.jsx(j,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:!1,...p("isSystem"),invalid:!!a.isSystem}),e.jsx(d,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>h({isSystem:!0}),className:"btn btn-primary",children:e.jsx(l,{icon:be})})}),e.jsx(d,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>h({isSystem:!1}),className:"btn btn-warning",children:e.jsx(l,{icon:Se})})})]}),a&&a.isSystem&&e.jsx(x,{className:"text-danger",children:a.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(c,{color:"primary",type:"submit",className:"mb-3 w-25",children:g?"Update":"Submit"})})]})})})})]})})}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(H,{onSubmit:le(de),children:[e.jsxs(D,{children:[e.jsx(j,{placeholder:"...",id:"searcInput",...ie("searchInput"),invalid:!!S.searchInput}),e.jsx(d,{content:"Search tags",placement:"top",children:e.jsx(c,{type:"submit",className:"btn btn-primary",children:e.jsx(l,{icon:Ne})})})]}),S&&S.searchInput&&e.jsx(x,{className:"text-danger",children:S.searchInput.message})]})})]})}),e.jsx(n,{children:N.map((s,t)=>e.jsx(i,{md:4,className:"mb-3",children:e.jsxs(z,{className:"h-100",children:[e.jsxs(B,{children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx("h5",{children:Te(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(n,{children:e.jsxs(i,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(n,{children:e.jsxs(i,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsx(Ie,{children:e.jsx(n,{children:e.jsx(i,{children:e.jsxs(Ee,{children:[e.jsx(d,{content:"Edit tag",placement:"top",children:e.jsx(c,{color:"primary",onClick:()=>ae(s._id),children:e.jsx(l,{icon:Pe})})}),e.jsx(d,{content:"Delete tag",placement:"top",children:e.jsx(c,{color:"danger",onClick:()=>re(s._id),disabled:s.isProtected,children:e.jsx(l,{icon:s.isProtected?_:L})})})]})})})})]})},t))}),e.jsx(n,{children:e.jsx(i,{children:e.jsxs(ke,{visible:V,onClose:()=>v(!1),children:[e.jsx(Fe,{children:e.jsx(De,{className:"text-danger",children:"Warning"})}),e.jsx(Ae,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:P.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:P.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs(Me,{children:[e.jsxs(i,{className:"d-flex justify-content-end",children:[e.jsx(Re,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:w,onChange:()=>W(!w)}),e.jsx(x,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(c,{onClick:()=>ne(P._id),disabled:!w,className:"btn btn-danger",children:J?e.jsx(xe,{color:"primary",variant:"grow"}):"Delete"})]})]})})}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(pe,{currentPage:C,totalPages:X||1,onPageChange:R})})})]})};export{ts as default};
