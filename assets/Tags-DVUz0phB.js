import{r,o as ce,A as oe,k as e,g as c,F as w,D as ie,E as le,H as de}from"./index-DIjRQuvx.js";import{z as o,u as R,t as $}from"./zod-DAqs4cGS.js";import{C as l,c as me}from"./index-RGJrIaL-.js";import{A as he}from"./AppPagination-THJPj0S3.js";import{F as d,t as U,m as xe,n as ge,k as H,x as ue,y as je,z as pe,o as fe,s as ye}from"./index.es-lDbdmS5E.js";import{C as v}from"./CContainer-nhpqq4Jr.js";import{C as n,a as i}from"./CRow-hiuBwMDS.js";import{C as z,a as B}from"./CCardBody-CtHXrmca.js";import{C as Ce}from"./CCardHeader-Da34N1ym.js";import{C as be}from"./CCollapse-Vv_s1MBR.js";import{C as G,a as u,c as h,b as q}from"./CFormInput-B17eqCni.js";import{C as I}from"./CInputGroup-BXTkm8Et.js";import{C as Se}from"./CCardFooter-DIlv6u5D.js";import{C as Ne}from"./CButtonGroup-BwyN_AV1.js";import{C as Pe,a as Te,b as we,c as ve,d as Ie}from"./CModalTitle-C7fYqRa2.js";import{C as ke}from"./CFormCheck-Br0j5aCa.js";import"./DefaultLayout-C9-GFgMm.js";import"./index.esm-LMKvgGlb.js";const Ke=()=>{const{addToast:x}=r.useContext(ce),[k,L]=r.useState([]),[g,N]=r.useState(!1),[p,f]=r.useState(!0),[Y,E]=r.useState(!1),[P,_]=r.useState(!1),[F,O]=r.useState(""),[A,V]=r.useState(!1),[y,D]=r.useState(1),[T,Ee]=r.useState(9),[W,J]=r.useState(0);r.useContext(oe);const C=async()=>{try{const s=A?await w(`/tags/search?query=${F}&page=${y}&limit=${T}`):await w(`/tags/all?page=${y}&limit=${T}`);s.status===200?(L(s.data.data),J(s.data.totalPages),D(s.data.currentPage)):console.log(s)}catch(s){console.log(s)}},K=o.object({id:o.string().optional(),name:o.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:o.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),isSystem:o.preprocess(s=>s==="true"||s===!0,o.boolean()).optional().default(!1),description:o.string().optional()}),{register:j,reset:m,handleSubmit:Q,formState:{errors:t}}=R({resolver:$(K)}),X=async s=>{try{const a=k.find(M=>M.name===s.name&&M.category===s.category);if(!g&&a){console.log("Tag already exist");return}console.log(s);const S=g?await ie(`/tags/${s.id}`,s):await le("/tags",s);S.status===200||S.status===201?(x("Success","Tag has been added successfully","success"),m({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),N(!1),f(!0),C()):x("Error","An error occurred while adding the tag","danger")}catch{x("Error","An error occurred while adding the tag","danger")}},Z=async s=>{try{N(!0),f(!0);const a=await w(`/tags/${s}`);if(a.status===200){const S={id:a.data.data._id,name:a.data.data.name,category:a.data.data.category,isProtected:a.data.data.isProtected||!1,isSystem:a.data.data.isSystem||!1};m(S),x("Success","Tag is successfully retrieved","success")}}catch{x("Error","An error occurred while fetching the tag","danger")}},ee=async s=>{try{if(!confirm("Are you sure you want to delete this tag?"))return;(await de(`/tags/${s}`)).status===200&&C()}catch{x("Error","An error occurred while deleting the tag","danger")}},se=()=>{m({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),N(!1),f(!0)},te=o.object({searchInput:o.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:ae,reset:Fe,handleSubmit:re,formState:{errors:b}}=R({resolver:$(te)}),ne=async s=>{try{console.log(s),O(s.searchInput),V(!0),C()}catch(a){console.log(a)}};return r.useEffect(()=>{const s=setTimeout(()=>{C()},300);return()=>clearTimeout(s)},[y,T,A,F]),e.jsxs(v,{className:"d-flex flex-column gap-3",children:[e.jsx(n,{children:e.jsx(v,{children:e.jsxs(z,{children:[e.jsx(Ce,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center",children:[e.jsx("strong",{children:"Jobposting Form"}),e.jsx("span",{className:g?"badge rounded-pill text text-danger":"badge rounded-pill text text-success",children:g?"Edit Mode":"Create Mode"})]}),e.jsxs("div",{className:"d-flex flex-row gap-2",children:[g&&e.jsx(l,{content:"Reset form",placement:"top",children:e.jsx(c,{onClick:()=>se(),className:"btn btn-danger",children:e.jsx(d,{icon:U})})}),e.jsx(l,{content:p?"Collapse":"Expand",placement:"top",children:e.jsx(c,{onClick:()=>f(!p),className:"btn btn-primary",children:e.jsx(d,{icon:p?xe:ge})})})]})]})}),e.jsx(be,{visible:p,children:e.jsx(B,{children:e.jsx(G,{onSubmit:Q(X),children:e.jsxs(v,{className:"d-flex flex-column gap-2",children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(u,{type:"hidden",id:"id",...j("id"),invalid:!!t.id}),t&&t.id&&e.jsx(h,{className:"text-danger",children:t.id.message}),e.jsx(u,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...j("name"),invalid:!!t.name}),t&&t.name&&e.jsx(h,{className:"text-danger",children:t.name.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(u,{type:"text",id:"category",placeholder:"Category",label:"Category",...j("category"),invalid:!!t.category}),t&&t.category&&e.jsx(h,{className:"text-danger",children:t.category.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"Protected?"}),e.jsxs(I,{children:[e.jsx(u,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...j("isProtected"),invalid:!!t.isProtected}),e.jsx(l,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>m({isProtected:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:H})})}),e.jsx(l,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>m({isProtected:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:ue})})})]}),t&&t.isProtected&&e.jsx(h,{className:"text-danger",children:t.isProtected.message})]})}),e.jsx(n,{children:e.jsxs(i,{children:[e.jsx(q,{children:"System Tag ?"}),e.jsxs(I,{children:[e.jsx(u,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:!1,...j("isSystem"),invalid:!!t.isSystem}),e.jsx(l,{content:"Protect",placement:"top",children:e.jsx(c,{onClick:()=>m({isSystem:!0}),className:"btn btn-primary",children:e.jsx(d,{icon:je})})}),e.jsx(l,{content:"Unprotect",placement:"top",children:e.jsx(c,{onClick:()=>m({isSystem:!1}),className:"btn btn-warning",children:e.jsx(d,{icon:pe})})})]}),t&&t.isSystem&&e.jsx(h,{className:"text-danger",children:t.isSystem.message})]})}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(c,{color:"primary",type:"submit",className:"mb-3 w-25",children:g?"Update":"Submit"})})]})})})})]})})}),e.jsx(n,{children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("strong",{children:"All Tags"})}),e.jsx("div",{children:e.jsxs(G,{onSubmit:re(ne),children:[e.jsxs(I,{children:[e.jsx(u,{placeholder:"...",id:"searcInput",...ae("searchInput"),invalid:!!b.searchInput}),e.jsx(l,{content:"Search tags",placement:"top",children:e.jsx(c,{type:"submit",className:"btn btn-primary",children:e.jsx(d,{icon:fe})})})]}),b&&b.searchInput&&e.jsx(h,{className:"text-danger",children:b.searchInput.message})]})})]})}),e.jsx(n,{children:k.map((s,a)=>e.jsx(i,{md:4,className:"mb-3",children:e.jsxs(z,{className:"h-100",children:[e.jsxs(B,{children:[e.jsx(n,{children:e.jsxs(i,{children:[e.jsx("h5",{children:me(s.name)}),e.jsx("p",{children:s.category})]})}),e.jsx(n,{children:e.jsxs(i,{children:["Protected: ",s.isProtected?"Yes":"No"]})}),e.jsx(n,{children:e.jsxs(i,{children:["System Tag: ",s.isSystem?"Yes":"No"]})})]}),e.jsxs(Se,{children:[e.jsx(n,{children:e.jsx(i,{children:e.jsxs(Ne,{children:[e.jsx(l,{content:"Edit tag",placement:"top",children:e.jsx(c,{color:"primary",onClick:()=>Z(s._id),children:e.jsx(d,{icon:ye})})}),e.jsx(l,{content:"Delete tag",placement:"top",children:e.jsx(c,{color:"danger",onClick:()=>E(!0),disabled:s.isProtected,children:e.jsx(d,{icon:s.isProtected?H:U})})})]})})}),e.jsx(n,{children:e.jsx(i,{children:e.jsxs(Pe,{visible:Y,onClose:()=>E(!1),children:[e.jsx(Te,{children:e.jsx(we,{children:"Warning"})}),e.jsx(ve,{children:e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this tag?"}),e.jsxs("p",{children:["Name: ",e.jsx("strong",{children:s.name}),e.jsx("br",{}),"Category: ",e.jsx("strong",{children:s.category})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," This action cannot be undone."]}),e.jsx("p",{children:"There's no way to recover the tag once it's deleted."}),e.jsx("p",{children:"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."}),e.jsx("p",{children:e.jsx("strong",{children:"What this action does:"})}),e.jsx("p",{children:"It removes the tag from the system and removes the tag from any content."}),e.jsx("p",{children:"if the tag is used in any content, it will no longer be associated with that content."})]})}),e.jsxs(Ie,{children:[e.jsxs(i,{className:"d-flex justify-content-end",children:[e.jsx(ke,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:P,onChange:()=>_(!P)}),e.jsx(h,{invalid:!0,children:"You must agree before submitting."})]}),e.jsx(c,{onClick:()=>ee(s._id),disabled:!P,className:"btn btn-danger",children:"Delete"})]})]})})})]})]})},a))}),e.jsx(n,{children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(he,{currentPage:y,totalPages:W||1,onPageChange:D})})})]})};export{Ke as default};
