import{r as e,R as t}from"./react-router-dom-BnDDw25P.js";import{z as a}from"./zod-B0zZW6rS.js";import{u as n}from"./react-hook-form-DGCwHb0C.js";import{s as r}from"./@hookform/resolvers/zod-B5rlnuQ9.js";import{l,A as s,f as c,i as m,v as o,w as i,r as d,x as u}from"./index-DXFVtbD_.js";import{A as g}from"./AppPagination-vWC6_7LU.js";import{F as E,T as p,Q as y,R as f,B as h,a3 as b,I as C,O as x}from"./index.es-DFhey9wz.js";import{b as S}from"./index-BxAblS3e.js";import{C as N}from"./CContainer-CzB7k1pT.js";import{C as j,a as v}from"./CRow-DSqRsHFr.js";import{C as w,a as P}from"./CCardBody-D4Qo47mg.js";import{C as T}from"./CCardHeader-BKG7arGz.js";import{C as k}from"./CTooltip-BHXnOH2f.js";import{C as I}from"./CCollapse-J66RzVaA.js";import{C as A,a as $,b as F,c as R}from"./CFormInput-BzSWZSHN.js";import{C as _}from"./CInputGroup-8Ah49MHR.js";import{C as D}from"./CButtonGroup-BpxNmVVV.js";import{C as M,a as z,b as O}from"./CModalHeader-CKCWLB_J.js";import{C as U}from"./CModalTitle-RZUDuE-6.js";import{C as V}from"./CModalFooter-D79q550G.js";import{C as Y}from"./CFormCheck-BuOCTX0n.js";import"./react-BF1r7_8g.js";import"./react-dom-DgB6LS8R.js";import"./isRTL-D5ORmfro.js";import"./getTransitionDurationFromElement-2nBpLMKS.js";import"./DefaultLayout-k-e4BEYF.js";import"./index.esm-JaDbXk68.js";const q=()=>{const{addToast:q}=e.useContext(l),[B,G]=e.useState([]),[H,L]=e.useState(!1),[W,Q]=e.useState({}),[J,K]=e.useState(!1),[X,Z]=e.useState(!0),[ee,te]=e.useState(!1),[ae,ne]=e.useState(!1),[re,le]=e.useState(!1),[se,ce]=e.useState(""),[me,oe]=e.useState(!1),[ie,de]=e.useState(1),[ue,ge]=e.useState(9),[Ee,pe]=e.useState(0),{userInformation:ye}=e.useContext(s),fe=async()=>{try{L(!0);const e=me?await o(`/tags/search?query=${se}&page=${ie}&limit=${ue}`):await o(`/tags/all?page=${ie}&limit=${ue}`);200===e.status?(G(e.data.data),pe(e.data.totalPages),de(e.data.currentPage),L(!1),q("Success","Tags are successfully retrieved","success")):(L(!1),q("Error","An error occurred while fetching the tags","danger"))}catch(e){L(!1),q("Error","An error occurred while fetching the tags","danger")}},he=a.object({id:a.string().optional(),name:a.string().min(3,{message:"Tag name must be at least 3 characters long"}).max(50,{message:"Tag name must not exceed 50 characters"}),category:a.string().min(3,{message:"Category name must be at least 3 characters long"}).max(50,{message:"Category name must not exceed 50 characters"}),isProtected:a.preprocess((e=>"true"===e||!0===e),a.boolean()).optional().default(!1),isSystem:a.preprocess((e=>"true"===e||!0===e),a.boolean()).optional().default(!1),description:a.string().optional()}),{register:be,reset:Ce,watch:xe,handleSubmit:Se,formState:{errors:Ne,defaultValues:je}}=n({resolver:r(he)});xe("isProtected");const ve=xe("isSystem"),we=a.object({searchInput:a.string().min(3,{message:"Search query must be at least 3 characters long"})}),{register:Pe,reset:Te,handleSubmit:ke,formState:{errors:Ie}}=n({resolver:r(we)});return e.useEffect((()=>{const e=setTimeout((()=>{fe()}),300);return()=>clearTimeout(e)}),[ie,ue,me,se]),t.createElement(N,{className:"d-flex flex-column gap-3"},t.createElement(j,null,t.createElement(N,null,t.createElement(w,null,t.createElement(T,null,t.createElement("div",{className:"d-flex justify-content-between align-items-center"},t.createElement("div",{className:"d-flex gap-2 justify-content-between align-items-center"},t.createElement("strong",null,"Jobposting Form"),t.createElement("span",{className:J?"badge rounded-pill text text-danger":"badge rounded-pill text text-success"},J?"Edit Mode":"Create Mode")),t.createElement("div",{className:"d-flex flex-row gap-2"},J&&t.createElement(k,{content:"Reset form",placement:"top"},t.createElement(c,{onClick:()=>(Ce({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),K(!1),void Z(!0)),className:"btn btn-danger"},t.createElement(E,{icon:p}))),t.createElement(k,{content:X?"Collapse":"Expand",placement:"top"},t.createElement(c,{onClick:()=>Z(!X),className:"btn btn-primary"},t.createElement(E,{icon:X?y:f})))))),t.createElement(I,{visible:X},t.createElement(P,null,t.createElement(A,{onSubmit:Se((async e=>{try{const t=B.find((t=>t.name===e.name&&t.category===e.category));if(!J&&t)return;const a=J?await i(`/tags/${e.id}`,e):await d("/tags",e);200===a.status||201===a.status?(q("Success",J?"Tag is successfully updated":"Tag is successfully added","success"),Ce({id:"",name:"",category:"",isProtected:!1,isSystem:!1}),K(!1),Z(!0),fe()):q("Error","An error occurred while adding the tag","danger")}catch(t){q("Error","An error occurred while adding the tag","danger")}}))},t.createElement(N,{className:"d-flex flex-column gap-2"},t.createElement(j,null,t.createElement(v,null,t.createElement($,{type:"hidden",id:"id",...be("id"),invalid:!!Ne.id}),Ne&&Ne.id&&t.createElement(F,{className:"text-danger"},Ne.id.message),t.createElement($,{type:"text",id:"name",placeholder:"...",label:"Tag Name",...be("name"),invalid:!!Ne.name}),Ne&&Ne.name&&t.createElement(F,{className:"text-danger"},Ne.name.message))),t.createElement(j,null,t.createElement(v,null,t.createElement($,{type:"text",id:"category",placeholder:"Category",label:"Category",...be("category"),invalid:!!Ne.category}),Ne&&Ne.category&&t.createElement(F,{className:"text-danger"},Ne.category.message))),t.createElement(j,null,t.createElement(v,null,t.createElement(R,null,"Protected?"),t.createElement(_,null,t.createElement($,{type:"text",id:"protected",placeholder:"Protected",readOnly:!0,defaultValue:!1,...be("isProtected"),invalid:!!Ne.isProtected}),t.createElement(k,{content:"Protect",placement:"top"},t.createElement(c,{onClick:()=>Ce({isProtected:!0}),className:"btn btn-primary"},t.createElement(E,{icon:h}))),t.createElement(k,{content:"Unprotect",placement:"top"},t.createElement(c,{onClick:()=>Ce({isProtected:!1}),className:"btn btn-warning"},t.createElement(E,{icon:b})))),Ne&&Ne.isProtected&&t.createElement(F,{className:"text-danger"},Ne.isProtected.message))),t.createElement(j,null,t.createElement(v,null,t.createElement(R,null,"System Tag ?"),t.createElement(_,null,t.createElement($,{type:"text",id:"system",placeholder:"...",readOnly:!0,defaultValue:ve,...be("isSystem"),invalid:!!Ne.isSystem}),t.createElement(k,{content:"Protect",placement:"top"},t.createElement(c,{onClick:()=>Ce({isSystem:!0}),className:"btn btn-primary"},t.createElement(E,{icon:h}))),t.createElement(k,{content:"Unprotect",placement:"top"},t.createElement(c,{onClick:()=>Ce({isSystem:!1}),className:"btn btn-secondary"},t.createElement(E,{icon:b})))),Ne&&Ne.isSystem&&t.createElement(F,{className:"text-danger"},Ne.isSystem.message))),t.createElement("div",{className:"d-flex justify-content-end"},t.createElement(c,{color:"primary",type:"submit",className:"mb-3 w-25"},J?"Update":"Submit"))))))))),t.createElement(j,null,t.createElement("div",{className:"d-flex justify-content-between"},t.createElement("div",{className:"d-flex justify-content-between align-items-center"},t.createElement("h1",null,"All Tags")),t.createElement("div",null,t.createElement(A,{onSubmit:ke((async e=>{try{ce(e.searchInput),oe(!0),fe()}catch(t){}}))},t.createElement(_,null,t.createElement($,{placeholder:"...",id:"searcInput",...Pe("searchInput"),invalid:!!Ie.searchInput}),t.createElement(k,{content:"Search tags",placement:"top"},t.createElement(c,{type:"submit",className:"btn btn-primary"},t.createElement(E,{icon:C})))),Ie&&Ie.searchInput&&t.createElement(F,{className:"text-danger"},Ie.searchInput.message))))),t.createElement(j,null,H?t.createElement("div",{className:"pt-3 text-center"},t.createElement(m,{color:"primary",variant:"grow"})):B.map(((e,a)=>t.createElement(v,{key:a,md:4,className:"mb-3"},t.createElement(w,{className:"h-100"},t.createElement(P,null,t.createElement(j,{className:"mb-3"},t.createElement(v,null,t.createElement("h5",null,S(e.name)),t.createElement("small",{className:"text-muted"},e.category))),t.createElement(j,null,t.createElement(v,null,t.createElement("small",null,"Protected:")," ",t.createElement("small",null,e.isProtected?"Yes":"No"),t.createElement("br",null),t.createElement("small",null,"System:")," ",t.createElement("small",null,e.isSystem?"Yes":"No"))),t.createElement(j,null,t.createElement(v,{className:"d-flex justify-content-end"},t.createElement(D,null,t.createElement(k,{content:"Edit tag",placement:"top"},t.createElement(c,{color:"primary",onClick:()=>(async e=>{try{K(!0),Z(!0);const t=await o(`/tags/${e}`);if(200===t.status){const e={id:t.data.data._id,name:t.data.data.name,category:t.data.data.category,isProtected:t.data.data.isProtected||!1,isSystem:t.data.data.isSystem||!1};Ce(e),q("Success","Tag is successfully retrieved","success")}}catch(t){q("Error","An error occurred while fetching the tag","danger")}})(e._id)},t.createElement(E,{icon:x}))),t.createElement(k,{content:"Delete tag",placement:"top"},t.createElement(c,{color:"danger",onClick:()=>(e=>{const t=B.find((t=>t._id===e));Q(t),te(!0)})(e._id),disabled:e.isProtected},t.createElement(E,{icon:e.isProtected?h:p})))))))))))),t.createElement(j,null,t.createElement(v,null,t.createElement(M,{visible:ee,onClose:()=>te(!1)},t.createElement(z,null,t.createElement(U,{className:"text-danger"},"Warning")),t.createElement(O,null,t.createElement("div",null,t.createElement("p",null,"Are you sure you want to delete this tag?"),t.createElement("p",null,"Name: ",t.createElement("strong",null,W.name),t.createElement("br",null),"Category: ",t.createElement("strong",null,W.category)),t.createElement("p",null,t.createElement("strong",null,"Note:")," This action cannot be undone."),t.createElement("p",null,"There's no way to recover the tag once it's deleted."),t.createElement("p",null,"This is important because tags are used to categorize and organize content. Deleting a tag can result in the loss of important information and make it difficult to find and manage content."),t.createElement("p",null,t.createElement("strong",null,"What this action does:")),t.createElement("p",null,"It removes the tag from the system and removes the tag from any content."),t.createElement("p",null,"if the tag is used in any content, it will no longer be associated with that content."))),t.createElement(V,null,t.createElement(v,{className:"d-flex justify-content-end"},t.createElement(Y,{type:"checkbox",id:"invalidCheck",label:"I confirm that I understand the consequences of this action.",checked:ae,onChange:()=>ne(!ae)}),t.createElement(F,{invalid:!0},"You must agree before submitting.")),t.createElement(c,{onClick:()=>(async e=>{try{le(!0);const t=await u(`/tags/${e}`);200===t.status?(q("Success","Tag has been deleted successfully","success"),fe(),te(!1)):(q("Error",t.message.message,"danger"),le(!1))}catch(t){q("Error","An error occurred while deleting the tag","danger"),le(!1)}})(W._id),disabled:!ae,className:"btn btn-danger"},re?t.createElement(m,{color:"primary",variant:"grow"}):"Delete"))))),t.createElement(j,null,t.createElement("div",{className:"d-flex justify-content-center"},t.createElement(g,{currentPage:ie,totalPages:Ee||1,onPageChange:de}))))};export{q as default};
