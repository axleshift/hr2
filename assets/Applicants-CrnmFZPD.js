import{p as C,r as s,F as M,k as e,o as ne,g as q}from"./index-CKEON_Fj.js";import{F as j,o as le,l as oe,A as ce,j as ie,B as de}from"./index.es-CjtBc0ja.js";import{A as me}from"./AppPagination-C5TO0okL.js";import{z as O,u as he,t as ue}from"./zod-WPmh8o1j.js";import{C as xe}from"./TimeForm-MO5GShVe.js";import{a as pe,C as w}from"./index-Dj3wsXdG.js";import{C as fe,a as je,b as ge,c as Ce}from"./CModalTitle-DhwF-UYe.js";import{C as k}from"./CContainer-BHmDE-_2.js";import{C as h,a as E}from"./CRow-Dwqo7vhr.js";import{a as U,C as Se,c as Te}from"./CFormInput-DgVsO09q.js";import{C as ye}from"./CInputGroup-Dfa-stSR.js";import{a as G}from"./DefaultLayout-pwWA_snD.js";import{C as be,a as De}from"./CCardBody-BMsc5YCF.js";import{C as Pe,a as ve,b as H,c as g,d as Fe,e as m}from"./CTable-DLeQMY-f.js";import"./clsx-B-dksMZM.js";import"./CInputGroupText-C3fAp1k4.js";import"./index.esm-t8SBoqLC.js";const X=({isVisible:N,onClose:I,isDarkMode:i,applicantData:S})=>{const[T,u]=s.useState({}),[V,x]=s.useState(!1),[c,p]=s.useState(new Date),[R,y]=s.useState(new Date);s.useState([]);const[b,z]=s.useState(1),[f,l]=s.useState(10),[_,D]=s.useState(1),P=d=>{p(d)},v=s.useCallback(async d=>{x(!0);try{const r=await M(`/interview/all?date=${d}&page=${b}&limit=${f}`);if(r.status===404){y([]),x(!1);return}console.log(r.data),y(r.data.data),D(r.data.totalPages),x(!1)}catch(r){console.error(r),x(!1)}});return s.useEffect(()=>{v(c)},[c,b,f]),s.useEffect(()=>{S&&u(S)},[S]),e.jsxs(fe,{visible:N,onClose:I,size:"lg",children:[e.jsx(je,{children:e.jsx(ge,{children:"Applicant Schedule Create"})}),e.jsx(Ce,{children:e.jsxs(k,{children:[e.jsx(h,{children:e.jsx(E,{children:e.jsx("div",{className:"mb-3",children:e.jsx(xe,{onChange:P,defaultValue:c,className:i?"calendar dark-mode":"calendar"})})})}),e.jsx(h,{children:e.jsx(E,{children:e.jsx(U,{type:"text",id:"date",name:"date",placeholder:"Date",value:pe(c),readOnly:!0})})})]})})]})};X.propTypes={isVisible:C.bool.isRequired,onClose:C.func.isRequired,isDarkMode:C.bool.isRequired,applicantData:C.object};const Ae=({theme:N})=>{const I=N==="dark",{addToast:i}=s.useContext(ne),[S,T]=s.useState(!1),[u,V]=s.useState([]),[x,c]=s.useState(!1),[p,R]=s.useState([]),[y,b]=s.useState({}),[z,f]=s.useState(!1),[l,_]=s.useState([]),[D,P]=s.useState(!1),[v,d]=s.useState(""),[r,$]=s.useState(1),[F,we]=s.useState(9),[J,K]=s.useState(1),B=async(a,t,o)=>{try{c(!0);let n="";l.length>0&&(n=l.map(re=>`${re}`).join(","));const A=D?await M(`/applicant/search?query=${o}&page=${a}&limit=${t}&tags=${n}`):await M("/applicant/all");A.status===200?(console.log(A.data.data),R(A.data.data),K(A.data.totalPages),c(!1)):(i("Error","Failed to fetch data","danger"),c(!1))}catch{i("Error","Failed to fetch data","danger")}},Q=async a=>{try{f(!0);const t=p.find(o=>o._id===a);b(t)}catch{i("Error","Failed to fetch data","danger")}},W=async()=>{try{T(!0);const t=await M("/tags/category/applicant");t.status===200?(V(t.data.data),T(!1)):(i("Error","Failed to fetch data","danger"),T(!1))}catch{i("Error","Failed to fetch data","danger")}},Y=a=>{if(l.includes(a)){const o=l.filter(n=>n!==a);_(o)}else _([...l,a])},Z=O.object({searchTerm:O.string().min(1,"Search term is required")}),{register:ee,handleSubmit:ae,formState:{errors:L}}=he({resolver:async(a,t,o)=>{const n=await ue(Z)(a,t,o);return console.log("Validation result:",n),n}}),se=a=>{const{searchTerm:t}=a;R([]),d(t),P(!0),$(1),B(r,F,t)},te=()=>{d(""),P(!1),$(1),B(r,F)};return s.useEffect(()=>{W();const a=setTimeout(()=>{B(r,F,v)},300);return()=>clearTimeout(a)},[r,F,D,v]),e.jsx(e.Fragment,{children:e.jsxs(k,{className:"d-flex flex-column gap-3",children:[e.jsx(h,{children:e.jsxs(k,{className:"d-flex flex-column gap-3",children:[e.jsxs(Se,{onSubmit:ae(se),children:[e.jsxs(ye,{children:[e.jsx(U,{type:"text",placeholder:"Search",...ee("searchTerm"),invalid:!!L.searchTerm}),e.jsx(w,{placement:"top",content:"Search",children:e.jsx(q,{type:"submit",color:"primary",children:e.jsx(j,{icon:le})})}),e.jsx(w,{placement:"top",content:"Refresh",children:e.jsx(q,{color:"primary",onClick:()=>te(),children:e.jsx(j,{icon:oe})})})]}),L.searchTerm&&e.jsx(Te,{invalid:!0,children:L.searchTerm.message})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:u.map(a=>e.jsx(w,{content:l.includes(a._id)?"Remove":"Add",children:e.jsxs(G,{onClick:()=>Y(a._id),color:l.includes(a._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[a.name,l.includes(a._id)&&e.jsx(j,{icon:ce,className:"ms-2"})]})},a._id))})]})}),e.jsx(h,{children:e.jsx(k,{children:e.jsx(be,{children:e.jsx(De,{children:e.jsxs(Pe,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(ve,{children:e.jsxs(H,{children:[e.jsx(g,{children:e.jsx(j,{icon:ie})}),e.jsx(g,{children:"Email"}),e.jsx(g,{children:"Phone"}),e.jsx(g,{children:"Tags"}),e.jsx(g,{children:"Action"})]})}),e.jsx(Fe,{children:p.length>0?p.map(a=>e.jsxs(H,{children:[e.jsx(m,{children:e.jsxs("div",{children:[a.lastname,", ",a.firstname]})}),e.jsx(m,{children:e.jsx("div",{children:a.email})}),e.jsx(m,{children:e.jsx("div",{children:a.phone})}),e.jsx(m,{children:e.jsx("div",{className:"d-flex gap-2",children:a.tags.map((t,o)=>e.jsx(G,{color:"primary",children:u.find(n=>n._id===t)&&u.find(n=>n._id===t).name},o))})}),e.jsx(m,{children:e.jsx(w,{placement:"top",content:"Schedule Interview for this applicant",children:e.jsx(q,{onClick:()=>Q(a._id),className:"btn btn-primary",size:"sm",children:e.jsx(j,{icon:de})})})})]},a._id)):e.jsx(H,{children:e.jsx(m,{colSpan:5,children:"No data available"})})})]})})})})}),e.jsx(h,{children:e.jsx(E,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(me,{currentPage:r,totalPages:J,onPageChange:$})})})}),e.jsx(h,{children:e.jsx(E,{children:e.jsx(X,{isVisible:z,onClose:()=>f(!1),isDarkMode:I,applicantData:y})})})]})})};Ae.propTypes={theme:C.string};export{Ae as default};
