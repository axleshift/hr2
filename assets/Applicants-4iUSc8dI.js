import{r as t,R as P,c as se,p as a,_ as oe,a as de,u as ve,T as Ee,o as be,k as e,g as I,l as ne,G as X}from"./index-DN3Hgp2L.js";import{F as L,G as Ce,H as Ie,V as Re,f as Pe,r as Ke}from"./index.es-DqaM7nwW.js";import{A as Ne}from"./AppPagination-B6oKmU5X.js";import{z as je,u as _e,t as Fe}from"./zod-Gg7m2xxn.js";import{C as He}from"./Calendar-VPTvMz7f.js";import{U as fe,f as pe,t as ye,c as W}from"./index-Djw6EB11.js";import{C as Me,a as De,b as Le}from"./CModalHeader-BIemrrei.js";import{C as qe}from"./CModalTitle-DytORmA_.js";import{C as J}from"./CContainer-CDxSXJ6A.js";import{C as R,a as M}from"./CRow-CKPmgian.js";import{a as ae,C as Se,c as $e}from"./CFormInput-Crvkftz_.js";import{g as Be,b as Oe,a as ge}from"./DefaultLayout-C0z569G2.js";import{g as ze,C as B}from"./CTooltip-5MXlvsEs.js";import{C as Q}from"./CInputGroup-DNb1gUpw.js";import{C as ie,a as ce,b as C,c as p,d as le,e as l}from"./CTable-B-laDQ4U.js";import{C as Ve,a as Ue}from"./CCardBody-ZbKqYlGO.js";import"./clsx-B-dksMZM.js";import"./index.esm-B3EpyKWa.js";var me=t.createContext({}),he=t.forwardRef(function(i,w){var x=i.children,c=i.activeItemKey,m=i.className,y=i.onChange,g=t.useId(),j=t.useState(c),o=j[0],u=j[1];return t.useEffect(function(){o&&y&&y(o)},[o]),P.createElement(me.Provider,{value:{_activeItemKey:o,setActiveItemKey:u,id:g}},P.createElement("div",{className:se("tabs",m),ref:w},x))});he.propTypes={activeItemKey:a.oneOfType([a.number,a.string]).isRequired,children:a.node,className:a.string,onChange:a.func};he.displayName="CTabs";var Z=t.forwardRef(function(i,w){var x=i.children,c=i.className,m=i.itemKey,y=oe(i,["children","className","itemKey"]),g=t.useContext(me),j=g._activeItemKey,o=g.setActiveItemKey,u=g.id,N=function(){return m===j};return P.createElement("button",de({className:se("nav-link",{active:N()},c),id:"".concat(u).concat(m,"-tab"),onClick:function(){return o(m)},onFocus:function(){return o(m)},role:"tab",tabIndex:N()?0:-1,type:"button","aria-controls":"".concat(u).concat(m,"-tab-pane"),"aria-selected":N(),ref:w},y),x)});Z.propTypes={children:a.node,className:a.string,itemKey:a.oneOfType([a.number,a.string]).isRequired};Z.displayName="CTab";var ee=t.forwardRef(function(i,w){var x=i.children,c=i.className,m=i.itemKey,y=i.onHide,g=i.onShow,j=i.transition,o=j===void 0?!0:j,u=i.visible,N=oe(i,["children","className","itemKey","onHide","onShow","transition","visible"]),d=t.useContext(me),S=d._activeItemKey,A=d.id,h=t.useRef(),v=ve(w,h),k=t.useState(u||S===m),K=k[0],_=k[1];return t.useEffect(function(){u!==void 0&&_(u)},[u]),t.useEffect(function(){_(S===m)},[S]),P.createElement(Ee,{in:K,nodeRef:h,onEnter:g,onExit:y,timeout:h.current?ze(h.current):0},function(q){return P.createElement("div",de({className:se("tab-pane",{active:K,fade:o,show:q==="entered"},c),id:"".concat(A).concat(m,"-tab-pane"),role:"tabpanel","aria-labelledby":"".concat(A).concat(m,"-tab"),tabIndex:0,ref:v},N),x)})});ee.propTypes={children:a.node,className:a.string,itemKey:a.oneOfType([a.number,a.string]).isRequired,onHide:a.func,onShow:a.func,transition:a.bool,visible:a.bool};ee.displayName="CTabPanel";var xe=t.forwardRef(function(i,w){var x,c=i.children,m=i.className,y=i.layout,g=i.variant,j=oe(i,["children","className","layout","variant"]),o=t.useRef(null),u=ve(w,o),N=function(d){if(o.current!==null&&(d.key==="ArrowDown"||d.key==="ArrowUp"||d.key==="ArrowLeft"||d.key==="ArrowRight"||d.key==="Home"||d.key==="End")){d.preventDefault();var S=d.target,A=Array.from(o.current.querySelectorAll(".nav-link:not(.disabled):not(:disabled)")),h=void 0;d.key==="Home"||d.key==="End"?h=d.key==="End"?A.at(-1):A[0]:h=Be(A,S,d.key==="ArrowDown"||d.key==="ArrowRight",!0),h&&h.focus({preventScroll:!0})}};return P.createElement("div",de({className:se("nav",(x={},x["nav-".concat(y)]=y,x["nav-".concat(g)]=g,x),m),role:"tablist",onKeyDown:N,ref:u},j),c)});xe.propTypes={children:a.node,className:a.string,layout:a.oneOf(["fill","justified"]),variant:a.oneOf(["pills","tabs","underline","underline-border"])};xe.displayName="CTabList";const Te=({isVisible:i,onClose:w,isDarkMode:x,applicantData:c})=>{P.useContext(be);const[m,y]=t.useState({}),[g,j]=t.useState(!1),[o,u]=t.useState(fe(new Date)),[N,d]=t.useState([]);t.useState([]);const[S,A]=t.useState([]),[h,v]=t.useState([]),[k,K]=t.useState(1),[_,q]=t.useState(10),[O,F]=t.useState(1),$=s=>{u(s)},H=s=>s.sort((r,b)=>{const z=new Date(r.date)-new Date(b.date);if(z!==0)return z;const V=r.timeslot.start.split(":").map(Number),U=b.timeslot.start.split(":").map(Number);return V[0]*60+V[1]-(U[0]*60+U[1])}),ue=async s=>{j(!0);try{const r=await X(`/interview/all?date=${s}&page=${k}&limit=${_}`);if(r.status===404){d([]),j(!1);return}const b=H(r.data.data);d(b),A(new Array(r.data.data.length).fill(!1)),K(r.data.currentPage),F(r.data.totalPages),j(!1)}catch(r){console.error(r),j(!1)}},te=async s=>{try{if(h.find(b=>b._id===s._id))return;const r=H([...h,s]);v(r)}catch(r){console.error(r)}},re=async s=>{try{v(r=>r.filter(b=>b._id!==s._id))}catch(r){console.error(r)}},D=s=>{A(r=>({...r,[s]:!r[s]}))};return t.useEffect(()=>{ue(o)},[o,k,_]),t.useEffect(()=>{c&&y(c)},[c]),e.jsxs(Me,{visible:i,onClose:()=>{w(),u(fe(new Date)),v([])},size:"xl",children:[e.jsx(De,{children:e.jsx(qe,{children:e.jsxs("div",{children:["Schedule Interview for"," ",e.jsxs("span",{className:"fw-bold",children:[c==null?void 0:c.lastname,", ",c==null?void 0:c.firstname]})]})})}),e.jsx(Le,{children:e.jsxs(J,{children:[e.jsx(R,{className:"mb-3",children:e.jsx(M,{children:e.jsx("div",{children:e.jsx(He,{onChange:$,defaultValue:o,className:x?"calendar dark-mode":"calendar"})})})}),e.jsx(R,{className:"mb-3",children:e.jsx(M,{children:e.jsx(ae,{type:"text",id:"date",name:"date",placeholder:"Date",value:pe(o),readOnly:!0})})}),e.jsx(R,{className:"mb-3",children:e.jsxs(M,{children:[e.jsx("h2",{children:"Events"}),e.jsxs("small",{children:["Pick an event to schedule an interview for"," ",e.jsxs("span",{className:"text-info",children:[c==null?void 0:c.lastname,", ",c==null?void 0:c.firstname]})]})]})}),e.jsx(R,{className:"mb-3",children:e.jsx(M,{children:e.jsxs(he,{activeItemKey:"events",children:[e.jsxs(xe,{variant:"underline-border",children:[e.jsx(Z,{itemKey:"events",children:"Events"}),e.jsx(Z,{itemKey:"applicant",children:"Applicantâ€˜s Events"})]}),e.jsxs(Oe,{children:[e.jsxs(ee,{itemKey:"events",children:[e.jsx("div",{className:"my-3",children:e.jsx(Se,{children:e.jsxs(Q,{children:[e.jsx(ae,{type:"text",id:"search",name:"search",placeholder:"Search"}),e.jsx(B,{content:"Search for events",placement:"top",children:e.jsx(I,{color:"primary",children:e.jsx(L,{icon:Ce})})})]})})}),e.jsxs(ie,{align:"middle",responsive:!0,children:[e.jsx(ce,{children:e.jsxs(C,{children:[e.jsx(p,{className:"text-center",children:"#"}),e.jsx(p,{className:"text-center",children:"Title"}),e.jsx(p,{className:"text-center",children:"Capacity"}),e.jsx(p,{className:"text-center",children:"Participants"}),e.jsx(p,{className:"text-center",children:"Timeslot"}),e.jsx(p,{className:"text-center",children:"Actions"})]})}),e.jsx(le,{children:g?e.jsx(C,{children:e.jsx(l,{colSpan:"7",className:"text-center",children:e.jsx(ne,{color:"primary",variant:"grow"})})}):N.length===0?e.jsx(C,{children:e.jsx(l,{colSpan:"7",className:"text-center",children:"No data found"})}):N.map((s,r)=>s.participants.includes(c._id)?null:e.jsxs(P.Fragment,{children:[e.jsxs(C,{children:[e.jsx(l,{className:"text-center",children:ye(s._id,3)}),e.jsx(l,{className:"text-center",children:s.title}),e.jsx(l,{className:"text-center",children:s.capacity}),e.jsx(l,{className:"text-center",children:s.participants.length}),e.jsx(l,{className:"text-center",children:e.jsxs("small",{children:[W(s.timeslot.start)," -"," ",W(s.timeslot.end)]})}),e.jsx(l,{className:"text-center",children:e.jsxs(Q,{children:[e.jsx(I,{color:"primary",size:"sm",disabled:s.participants.length>=s.capacity||s.participants.includes(c._id)||!!h.find(b=>b._id===s._id),onClick:()=>te(s),children:s.participants.length>=s.capacity?"Full":s.participants.includes(c._id)||h.find(b=>b._id===s._id)?"Added":"Add"}),e.jsx(I,{color:"info",size:"sm",onClick:()=>D(r),children:S[r]?"Hide":"Show"})]})})]}),S[r]&&e.jsx(C,{children:e.jsxs(l,{colSpan:"7",children:[e.jsx("h6",{children:"Addditional Information"}),e.jsx("p",{children:s.additionalInfo}),e.jsx("h6",{children:"Location"}),e.jsx("p",{children:s.location})]})})]},s._id))})]}),e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(Ne,{currentPage:k,totalPages:O,onPageChange:K})})]}),e.jsxs(ee,{itemKey:"applicant",children:[e.jsxs(ie,{align:"middle",responsive:!0,children:[e.jsx(ce,{children:e.jsxs(C,{children:[e.jsx(p,{className:"text-center",children:"#"}),e.jsx(p,{className:"text-center",children:"Title"}),e.jsx(p,{className:"text-center",children:"Date"}),e.jsx(p,{className:"text-center",children:"Timeslot"}),e.jsx(p,{className:"text-center",children:"Actions"})]})}),e.jsx(le,{children:g?e.jsx(C,{children:e.jsx(l,{colSpan:"7",className:"text-center",children:e.jsx(ne,{color:"primary",variant:"grow"})})}):h.length===0?e.jsx(C,{children:e.jsx(l,{colSpan:"7",className:"text-center",children:"No data found"})}):h.map((s,r)=>s.participants.includes(c._id)?null:e.jsxs(P.Fragment,{children:[e.jsxs(C,{children:[e.jsx(l,{className:"text-center",children:ye(s._id,3)}),e.jsx(l,{className:"text-center",children:s.title}),e.jsx(l,{className:"text-center",children:pe(s.date,"MMMM DD, YYYY")}),e.jsx(l,{className:"text-center",children:e.jsxs("small",{children:[W(s.timeslot.start)," -"," ",W(s.timeslot.end)]})}),e.jsx(l,{className:"text-center",children:e.jsxs(Q,{children:[e.jsx(I,{color:"danger",size:"sm",disabled:s.participants.length>=s.capacity,onClick:()=>re(s),children:"Remove"}),e.jsx(I,{color:"info",size:"sm",onClick:()=>D(r),children:S[r]?"Hide":"Show"})]})})]}),S[r]&&e.jsx(C,{children:e.jsxs(l,{colSpan:"7",children:[e.jsx("h6",{children:"Addditional Information"}),e.jsx("p",{children:s.additionalInfo}),e.jsx("h6",{children:"Location"}),e.jsx("p",{children:s.location})]})})]},s._id))})]}),e.jsxs("div",{children:[e.jsxs("small",{children:[e.jsx("span",{className:"text-danger",children:"Note:"})," Events added here will be scheduled for the applicant once the form is submitted."]}),e.jsx("br",{}),e.jsxs("small",{children:[e.jsx("span",{className:"text-danger",children:"Warning:"})," Once closed, the events will be resetted. Make sure to submit the form before closing."]})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(I,{className:"btn btn-primary",children:"Submit"})})]})]})]})})})]})})]})};Te.propTypes={isVisible:a.bool.isRequired,onClose:a.func.isRequired,isDarkMode:a.bool.isRequired,applicantData:a.object};const Ye=({theme:i})=>{const w=i==="dark",{addToast:x}=t.useContext(be),[c,m]=t.useState(!1),[y,g]=t.useState([]),[j,o]=t.useState(!1),[u,N]=t.useState([]),[d,S]=t.useState({}),[A,h]=t.useState(!1),[v,k]=t.useState([]),[K,_]=t.useState(!1),[q,O]=t.useState(""),[F,$]=t.useState(1),[H,ue]=t.useState(9),[te,re]=t.useState(1),D=async(n,f,E)=>{try{o(!0);let T="";v.length>0&&(T=v.map(ke=>`${ke}`).join(","));const G=K?await X(`/applicant/search?query=${E}&page=${n}&limit=${f}&tags=${T}`):await X("/applicant/all");G.status===200?(console.log(G.data.data),N(G.data.data),re(G.data.totalPages),o(!1)):(x("Error","Failed to fetch data","danger"),o(!1))}catch{x("Error","Failed to fetch data","danger")}},s=async n=>{try{h(!0);const f=u.find(E=>E._id===n);S(f)}catch{x("Error","Failed to fetch data","danger")}},r=async()=>{try{m(!0);const f=await X("/tags/category/applicant");f.status===200?(g(f.data.data),m(!1)):(x("Error","Failed to fetch data","danger"),m(!1))}catch{x("Error","Failed to fetch data","danger")}},b=n=>{if(v.includes(n)){const E=v.filter(T=>T!==n);k(E)}else k([...v,n])},z=je.object({searchTerm:je.string().min(1,"Search term is required")}),{register:V,handleSubmit:U,formState:{errors:Y}}=_e({resolver:async(n,f,E)=>{const T=await Fe(z)(n,f,E);return console.log("Validation result:",T),T}}),we=n=>{const{searchTerm:f}=n;N([]),O(f),_(!0),$(1),D(F,H,f)},Ae=()=>{O(""),_(!1),$(1),D(F,H)};return t.useEffect(()=>{r();const n=setTimeout(()=>{D(F,H,q)},300);return()=>clearTimeout(n)},[F,H,K,q]),e.jsx(e.Fragment,{children:e.jsxs(J,{className:"d-flex flex-column gap-3",children:[e.jsx(R,{children:e.jsxs(M,{children:[e.jsx("h2",{children:"Applicants"}),e.jsx("small",{children:"In this page, you can view and edit the list of applicants which are waiting for the HR to schedule an interview or any event they need to attend."})]})}),e.jsx(R,{children:e.jsxs(J,{className:"d-flex flex-column gap-3",children:[e.jsxs(Se,{onSubmit:U(we),children:[e.jsxs(Q,{children:[e.jsx(ae,{type:"text",placeholder:"Search",...V("searchTerm"),invalid:!!Y.searchTerm}),e.jsx(B,{placement:"top",content:"Search",children:e.jsx(I,{type:"submit",color:"primary",children:e.jsx(L,{icon:Ce})})}),e.jsx(B,{placement:"top",content:"Refresh",children:e.jsx(I,{color:"primary",onClick:()=>Ae(),children:e.jsx(L,{icon:Ie})})})]}),Y.searchTerm&&e.jsx($e,{invalid:!0,children:Y.searchTerm.message})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:y.map(n=>e.jsx(B,{content:v.includes(n._id)?"Remove":"Add",children:e.jsxs(ge,{onClick:()=>b(n._id),color:v.includes(n._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[n.name,v.includes(n._id)&&e.jsx(L,{icon:Re,className:"ms-2"})]})},n._id))})]})}),e.jsx(R,{children:e.jsx(J,{children:e.jsx(Ve,{children:e.jsx(Ue,{children:e.jsxs(ie,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(ce,{children:e.jsxs(C,{children:[e.jsx(p,{children:e.jsx(L,{icon:Pe})}),e.jsx(p,{children:"Email"}),e.jsx(p,{children:"Phone"}),e.jsx(p,{children:"Tags"}),e.jsx(p,{children:"Action"})]})}),e.jsx(le,{children:j?e.jsx(C,{children:e.jsx(l,{colSpan:5,children:e.jsx("div",{className:"pt-3 text-center",children:e.jsx(ne,{color:"primary",variant:"grow"})})})}):u.length>0?u.map(n=>e.jsxs(C,{children:[e.jsx(l,{children:e.jsxs("div",{children:[n.lastname,", ",n.firstname]})}),e.jsx(l,{children:e.jsx("div",{children:n.email})}),e.jsx(l,{children:e.jsx("div",{children:n.phone})}),e.jsx(l,{children:e.jsx("div",{className:"d-flex gap-2",children:n.tags.map((f,E)=>e.jsx(ge,{color:"primary",children:y.find(T=>T._id===f)&&y.find(T=>T._id===f).name},E))})}),e.jsx(l,{children:e.jsx(B,{placement:"top",content:"Schedule Interview for this applicant",children:e.jsx(I,{onClick:()=>s(n._id),className:"btn btn-primary",size:"sm",children:e.jsx(L,{icon:Ke})})})})]},n._id)):e.jsx(C,{children:e.jsx(l,{colSpan:5,children:"No data available"})})})]})})})})}),e.jsx(R,{children:e.jsx(M,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(Ne,{currentPage:F,totalPages:te,onPageChange:$})})})}),e.jsx(R,{children:e.jsx(M,{children:e.jsx(Te,{isVisible:A,onClose:()=>h(!1),isDarkMode:w,applicantData:d})})})]})})};Ye.propTypes={theme:a.string};export{Ye as default};
