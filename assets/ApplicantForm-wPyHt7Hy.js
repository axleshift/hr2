import{C as e}from"./Calendar-CVmgXurr.js";import{m as a,j as t,a as i,g as n,k as l,w as r,p as c}from"./index-C66lSxRl.js";import{R as s,r as d}from"./react-router-dom-BnDDw25P.js";import{U as o,f as m,t as h,c as p}from"./index-BVfmz2P_.js";import{A as u}from"./AppPagination-CPEkAGYU.js";import{F as f,I as N}from"./index.es-DzFLx6Av.js";import{C as x,a as C,b as g}from"./CModalHeader-17a_J2dP.js";import{C as v}from"./CModalTitle-UbKkKgfG.js";import{C as b}from"./CContainer-DnAwT2KJ.js";import{C as y,a as S}from"./CRow-BC2jnXSR.js";import{C as j}from"./CFormInput-7yAhRXCl.js";import{C as w,a as _,b as D,c as A}from"./CTabList-B_ov72Hs.js";import{a as k}from"./DefaultLayout-BlBcqPq3.js";import{C as T}from"./CFormLabel-CnrvBD9C.js";import{C as I}from"./CInputGroup-CRsaNImm.js";import{C as M}from"./CTooltip-C7pMgaBa.js";import{C as F,a as P,b as R,c as E,d as K,e as z}from"./CTable-C_OnMufT.js";const L=({isVisible:c,onClose:L,isDarkMode:Y,applicantData:H})=>{const{addToast:V}=s.useContext(a),[q,O]=d.useState({}),[$,W]=d.useState(!1),[G,Q]=d.useState(o(new Date)),[U,X]=d.useState([]),[B,J]=d.useState([]),[Z,ee]=d.useState([]),[ae,te]=d.useState([]),[ie,ne]=d.useState(1),[le,re]=d.useState(10),[ce,se]=d.useState(1),de=e=>e.sort(((e,a)=>{const t=new Date(e.date)-new Date(a.date);if(0!==t)return t;const i=e.timeslot.start.split(":").map(Number),n=a.timeslot.start.split(":").map(Number);return 60*i[0]+i[1]-(60*n[0]+n[1])})),oe=e=>{ee((a=>({...a,[e]:!a[e]})))};return d.useEffect((()=>{(async e=>{W(!0);try{const a=await r(`/interview/all?date=${e}&page=${ie}&limit=${le}`);if(200===a.status){const e=de(a.data.data);X(e),ee(new Array(a.data.data.length).fill(!1)),ne(a.data.currentPage),se(a.data.totalPages),W(!1)}else W(!1),V("Calendar | Scheduling Form",a.message.message,"danger")}catch(a){W(!1)}})(G)}),[G,ie,le]),d.useEffect((()=>{H&&O(H)}),[H]),t(x,{visible:c,onClose:()=>{L(),Q(o(new Date)),te([])},size:"xl",children:[i(C,{children:i(v,{children:t("div",{children:["Schedule Interview for"," ",t("span",{className:"fw-bold",children:[null==H?void 0:H.lastname,", ",null==H?void 0:H.firstname]})]})})}),i(g,{children:t(b,{children:[i(y,{className:"mb-3",children:i(S,{children:i("div",{children:i(e,{onChange:e=>{Q(e)},defaultValue:G,className:Y?"calendar dark-mode":"calendar"})})})}),i(y,{className:"mb-3",children:i(S,{children:i(j,{type:"text",id:"date",name:"date",placeholder:"Date",value:m(G),readOnly:!0})})}),i(y,{className:"mb-3",children:t(S,{children:[i("h2",{children:"Events"}),t("small",{children:["Pick an event to schedule an interview for"," ",t("span",{className:"text-info",children:[null==H?void 0:H.lastname,", ",null==H?void 0:H.firstname]})]})]})}),i(y,{className:"mb-3",children:i(S,{children:t(w,{activeItemKey:"events",children:[t(_,{variant:"underline-border",children:[i(D,{itemKey:"events",children:"Events"}),i(D,{itemKey:"applicant",children:"Applicantâ€˜s Events"})]}),t(k,{children:[t(A,{itemKey:"events",children:[i("div",{className:"my-3",children:i(T,{children:t(I,{children:[i(j,{type:"text",id:"search",name:"search",placeholder:"Search"}),i(M,{content:"Search for events",placement:"top",children:i(n,{color:"primary",children:i(f,{icon:N})})})]})})}),t(F,{align:"middle",responsive:!0,children:[i(P,{children:t(R,{children:[i(E,{className:"text-center",children:"#"}),i(E,{className:"text-center",children:"Title"}),i(E,{className:"text-center",children:"Capacity"}),i(E,{className:"text-center",children:"Participants"}),i(E,{className:"text-center",children:"Timeslot"}),i(E,{className:"text-center",children:"Actions"})]})}),i(K,{children:$?i(R,{children:i(z,{colSpan:"7",className:"text-center",children:i(l,{color:"primary",variant:"grow"})})}):0===U.length?i(R,{children:i(z,{colSpan:"7",className:"text-center",children:"No data found"})}):U.map(((e,a)=>e.participants.includes(H._id)?null:t(s.Fragment,{children:[t(R,{children:[i(z,{className:"text-center",children:h(e._id,3)}),i(z,{className:"text-center",children:e.title}),i(z,{className:"text-center",children:e.capacity}),i(z,{className:"text-center",children:e.participants.length}),i(z,{className:"text-center",children:t("small",{children:[p(e.timeslot.start)," -"," ",p(e.timeslot.end)]})}),i(z,{className:"text-center",children:t(I,{children:[i(n,{color:"primary",size:"sm",disabled:e.participants.length>=e.capacity||e.participants.includes(H._id)||!!ae.find((a=>a._id===e._id)),onClick:()=>(async e=>{try{if(ae.find((a=>a._id===e._id)))return;const a=de([...ae,e]);te(a)}catch(a){}})(e),children:e.participants.length>=e.capacity?"Full":e.participants.includes(H._id)||ae.find((a=>a._id===e._id))?"Added":"Add"}),i(n,{color:"info",size:"sm",onClick:()=>oe(a),children:Z[a]?"Hide":"Show"})]})})]}),Z[a]&&i(R,{children:t(z,{colSpan:"7",children:[i("h6",{children:"Addditional Information"}),i("p",{children:e.additionalInfo}),i("h6",{children:"Location"}),i("p",{children:e.location})]})})]},e._id)))})]}),i("div",{className:"d-flex align-items-center justify-content-center",children:i(u,{currentPage:ie,totalPages:ce,onPageChange:ne})})]}),t(A,{itemKey:"applicant",children:[t(F,{align:"middle",responsive:!0,children:[i(P,{children:t(R,{children:[i(E,{className:"text-center",children:"#"}),i(E,{className:"text-center",children:"Title"}),i(E,{className:"text-center",children:"Date"}),i(E,{className:"text-center",children:"Timeslot"}),i(E,{className:"text-center",children:"Actions"})]})}),i(K,{children:$?i(R,{children:i(z,{colSpan:"7",className:"text-center",children:i(l,{color:"primary",variant:"grow"})})}):0===ae.length?i(R,{children:i(z,{colSpan:"7",className:"text-center",children:"No data found"})}):ae.map(((e,a)=>e.participants.includes(H._id)?null:t(s.Fragment,{children:[t(R,{children:[i(z,{className:"text-center",children:h(e._id,3)}),i(z,{className:"text-center",children:e.title}),i(z,{className:"text-center",children:m(e.date,"MMMM DD, YYYY")}),i(z,{className:"text-center",children:t("small",{children:[p(e.timeslot.start)," -"," ",p(e.timeslot.end)]})}),i(z,{className:"text-center",children:t(I,{children:[i(n,{color:"danger",size:"sm",disabled:e.participants.length>=e.capacity,onClick:()=>(async e=>{try{te((a=>a.filter((a=>a._id!==e._id))))}catch(a){}})(e),children:"Remove"}),i(n,{color:"info",size:"sm",onClick:()=>oe(a),children:Z[a]?"Hide":"Show"})]})})]}),Z[a]&&i(R,{children:t(z,{colSpan:"7",children:[i("h6",{children:"Addditional Information"}),i("p",{children:e.additionalInfo}),i("h6",{children:"Location"}),i("p",{children:e.location})]})})]},e._id)))})]}),t("div",{children:[t("small",{children:[i("span",{className:"text-danger",children:"Note:"})," Events added here will be scheduled for the applicant once the form is submitted."]}),i("br",{}),t("small",{children:[i("span",{className:"text-danger",children:"Warning:"})," Once closed, the events will be resetted. Make sure to submit the form before closing."]})]}),i("div",{className:"d-flex justify-content-end",children:i(n,{className:"btn btn-primary",children:"Submit"})})]})]})]})})})]})})]})};L.propTypes={isVisible:c.bool.isRequired,onClose:c.func.isRequired,isDarkMode:c.bool.isRequired,applicantData:c.object};export{L as A};
