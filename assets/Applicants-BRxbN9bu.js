import{p as C,r as s,G as N,k as e,o as ne,g as H,l as le}from"./index-8dmFFJ_i.js";import{F as j,o as ce,l as oe,A as ie,j as de,B as me}from"./index.es-BY3aiGxY.js";import{A as he}from"./AppPagination-Dg2q7CGb.js";import{z as G,u as xe,t as ue}from"./zod-w4xg3E0H.js";import{C as pe}from"./TimeForm-DQFnZszR.js";import{a as fe,C as A}from"./index-TUeKpTRY.js";import{C as je,a as ge,b as Ce,c as Se}from"./CModalTitle-DwWTV6Ds.js";import{C as k}from"./CContainer-DYk49lQp.js";import{C as x,a as E}from"./CRow-BNC0kilN.js";import{a as U,C as Te,c as ye}from"./CFormInput-B0ldU7KH.js";import{C as be}from"./CInputGroup-DJqzcEZc.js";import{a as O}from"./DefaultLayout-DS1H8VXZ.js";import{C as De,a as ve}from"./CCardBody-6MR8J0sZ.js";import{C as Pe,a as Fe,b as M,c as g,d as we,e as d}from"./CTable-CQkdaWOv.js";import"./clsx-B-dksMZM.js";import"./CInputGroupText-BD9Wt1Ca.js";import"./index.esm-BtpFi0sf.js";const X=({isVisible:I,onClose:R,isDarkMode:i,applicantData:S})=>{const[T,u]=s.useState({}),[V,m]=s.useState(!1),[o,p]=s.useState(new Date),[_,y]=s.useState(new Date);s.useState([]);const[b,z]=s.useState(1),[f,l]=s.useState(10),[$,D]=s.useState(1),v=h=>{p(h)},P=s.useCallback(async h=>{m(!0);try{const r=await N(`/interview/all?date=${h}&page=${b}&limit=${f}`);if(r.status===404){y([]),m(!1);return}console.log(r.data),y(r.data.data),D(r.data.totalPages),m(!1)}catch(r){console.error(r),m(!1)}});return s.useEffect(()=>{P(o)},[o,b,f]),s.useEffect(()=>{S&&u(S)},[S]),e.jsxs(je,{visible:I,onClose:R,size:"lg",children:[e.jsx(ge,{children:e.jsx(Ce,{children:"Applicant Schedule Create"})}),e.jsx(Se,{children:e.jsxs(k,{children:[e.jsx(x,{children:e.jsx(E,{children:e.jsx("div",{className:"mb-3",children:e.jsx(pe,{onChange:v,defaultValue:o,className:i?"calendar dark-mode":"calendar"})})})}),e.jsx(x,{children:e.jsx(E,{children:e.jsx(U,{type:"text",id:"date",name:"date",placeholder:"Date",value:fe(o),readOnly:!0})})})]})})]})};X.propTypes={isVisible:C.bool.isRequired,onClose:C.func.isRequired,isDarkMode:C.bool.isRequired,applicantData:C.object};const Ae=({theme:I})=>{const R=I==="dark",{addToast:i}=s.useContext(ne),[S,T]=s.useState(!1),[u,V]=s.useState([]),[m,o]=s.useState(!1),[p,_]=s.useState([]),[y,b]=s.useState({}),[z,f]=s.useState(!1),[l,$]=s.useState([]),[D,v]=s.useState(!1),[P,h]=s.useState(""),[r,B]=s.useState(1),[F,Me]=s.useState(9),[J,K]=s.useState(1),L=async(a,t,c)=>{try{o(!0);let n="";l.length>0&&(n=l.map(re=>`${re}`).join(","));const w=D?await N(`/applicant/search?query=${c}&page=${a}&limit=${t}&tags=${n}`):await N("/applicant/all");w.status===200?(console.log(w.data.data),_(w.data.data),K(w.data.totalPages),o(!1)):(i("Error","Failed to fetch data","danger"),o(!1))}catch{i("Error","Failed to fetch data","danger")}},Q=async a=>{try{f(!0);const t=p.find(c=>c._id===a);b(t)}catch{i("Error","Failed to fetch data","danger")}},W=async()=>{try{T(!0);const t=await N("/tags/category/applicant");t.status===200?(V(t.data.data),T(!1)):(i("Error","Failed to fetch data","danger"),T(!1))}catch{i("Error","Failed to fetch data","danger")}},Y=a=>{if(l.includes(a)){const c=l.filter(n=>n!==a);$(c)}else $([...l,a])},Z=G.object({searchTerm:G.string().min(1,"Search term is required")}),{register:ee,handleSubmit:ae,formState:{errors:q}}=xe({resolver:async(a,t,c)=>{const n=await ue(Z)(a,t,c);return console.log("Validation result:",n),n}}),se=a=>{const{searchTerm:t}=a;_([]),h(t),v(!0),B(1),L(r,F,t)},te=()=>{h(""),v(!1),B(1),L(r,F)};return s.useEffect(()=>{W();const a=setTimeout(()=>{L(r,F,P)},300);return()=>clearTimeout(a)},[r,F,D,P]),e.jsx(e.Fragment,{children:e.jsxs(k,{className:"d-flex flex-column gap-3",children:[e.jsx(x,{children:e.jsxs(k,{className:"d-flex flex-column gap-3",children:[e.jsxs(Te,{onSubmit:ae(se),children:[e.jsxs(be,{children:[e.jsx(U,{type:"text",placeholder:"Search",...ee("searchTerm"),invalid:!!q.searchTerm}),e.jsx(A,{placement:"top",content:"Search",children:e.jsx(H,{type:"submit",color:"primary",children:e.jsx(j,{icon:ce})})}),e.jsx(A,{placement:"top",content:"Refresh",children:e.jsx(H,{color:"primary",onClick:()=>te(),children:e.jsx(j,{icon:oe})})})]}),q.searchTerm&&e.jsx(ye,{invalid:!0,children:q.searchTerm.message})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:u.map(a=>e.jsx(A,{content:l.includes(a._id)?"Remove":"Add",children:e.jsxs(O,{onClick:()=>Y(a._id),color:l.includes(a._id)?"success":"danger",className:"d-flex align-items-center justify-content-between",children:[a.name,l.includes(a._id)&&e.jsx(j,{icon:ie,className:"ms-2"})]})},a._id))})]})}),e.jsx(x,{children:e.jsx(k,{children:e.jsx(De,{children:e.jsx(ve,{children:e.jsxs(Pe,{align:"middle",hover:!0,responsive:!0,striped:!0,children:[e.jsx(Fe,{children:e.jsxs(M,{children:[e.jsx(g,{children:e.jsx(j,{icon:de})}),e.jsx(g,{children:"Email"}),e.jsx(g,{children:"Phone"}),e.jsx(g,{children:"Tags"}),e.jsx(g,{children:"Action"})]})}),e.jsx(we,{children:m?e.jsx(M,{children:e.jsx(d,{colSpan:5,children:e.jsx("div",{className:"pt-3 text-center",children:e.jsx(le,{color:"primary",variant:"grow"})})})}):p.length>0?p.map(a=>e.jsxs(M,{children:[e.jsx(d,{children:e.jsxs("div",{children:[a.lastname,", ",a.firstname]})}),e.jsx(d,{children:e.jsx("div",{children:a.email})}),e.jsx(d,{children:e.jsx("div",{children:a.phone})}),e.jsx(d,{children:e.jsx("div",{className:"d-flex gap-2",children:a.tags.map((t,c)=>e.jsx(O,{color:"primary",children:u.find(n=>n._id===t)&&u.find(n=>n._id===t).name},c))})}),e.jsx(d,{children:e.jsx(A,{placement:"top",content:"Schedule Interview for this applicant",children:e.jsx(H,{onClick:()=>Q(a._id),className:"btn btn-primary",size:"sm",children:e.jsx(j,{icon:me})})})})]},a._id)):e.jsx(M,{children:e.jsx(d,{colSpan:5,children:"No data available"})})})]})})})})}),e.jsx(x,{children:e.jsx(E,{children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx(he,{currentPage:r,totalPages:J,onPageChange:B})})})}),e.jsx(x,{children:e.jsx(E,{children:e.jsx(X,{isVisible:z,onClose:()=>f(!1),isDarkMode:R,applicantData:y})})})]})})};Ae.propTypes={theme:C.string};export{Ae as default};
